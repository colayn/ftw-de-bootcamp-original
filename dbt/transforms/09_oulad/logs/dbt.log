[0m08:12:25.675608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16213f0310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f161e051af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f161e0519a0>]}


============================== 08:12:25.685682 | e061b0be-5b36-4441-8234-6cda140ba967 ==============================
[0m08:12:25.685682 [info ] [MainThread]: Running with dbt=1.8.9
[0m08:12:25.686740 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'empty': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'introspect': 'True', 'debug': 'False', 'log_path': '/workdir/transforms/02_chinook/logs', 'invocation_command': 'dbt build --profiles-dir . --target local', 'use_experimental_parser': 'False', 'warn_error': 'None', 'use_colors': 'True', 'quiet': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '.', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'version_check': 'True', 'printer_width': '80', 'log_format': 'default'}
[0m08:12:26.225884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e061b0be-5b36-4441-8234-6cda140ba967', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1620997fd0>]}
[0m08:12:26.414257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e061b0be-5b36-4441-8234-6cda140ba967', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f161e01abe0>]}
[0m08:12:26.416010 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m08:12:26.886038 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m08:12:26.887403 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m08:12:26.888099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e061b0be-5b36-4441-8234-6cda140ba967', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f161dcf31c0>]}
[0m08:12:31.808527 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ex_01_mpg.stg_chinook__album.sql' (models/clean/stg_chinook__album.sql.sql) depends on a source named 'chinook.albums' which was not found
[0m08:12:31.810992 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 6.3323393, "process_in_blocks": "2816", "process_kernel_time": 0.545969, "process_mem_max_rss": "100432", "process_out_blocks": "6616", "process_user_time": 5.998663}
[0m08:12:31.811740 [debug] [MainThread]: Command `dbt build` failed at 08:12:31.811528 after 6.33 seconds
[0m08:12:31.812370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16213f0310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f161df36580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f161df369a0>]}
[0m08:12:31.812979 [debug] [MainThread]: Flushing usage events
[0m08:15:44.751396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c09ff80310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c09cbdea90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c09cbde940>]}


============================== 08:15:44.760627 | 9a85211f-b6ad-4538-81e1-ca33b1791f09 ==============================
[0m08:15:44.760627 [info ] [MainThread]: Running with dbt=1.8.9
[0m08:15:44.761801 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_cache_events': 'False', 'empty': 'False', 'static_parser': 'True', 'warn_error': 'None', 'profiles_dir': '.', 'partial_parse': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'write_json': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'introspect': 'True', 'no_print': 'None', 'log_format': 'default', 'target_path': 'None', 'debug': 'False', 'log_path': '/workdir/transforms/02_chinook/logs', 'fail_fast': 'False', 'quiet': 'False', 'use_colors': 'True', 'cache_selected_only': 'False', 'invocation_command': 'dbt build --profiles-dir . --target local', 'send_anonymous_usage_stats': 'True'}
[0m08:15:45.373139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a85211f-b6ad-4538-81e1-ca33b1791f09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c09cae1a30>]}
[0m08:15:45.566646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a85211f-b6ad-4538-81e1-ca33b1791f09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c09d02f250>]}
[0m08:15:45.567889 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m08:15:46.026707 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m08:15:46.028122 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m08:15:46.028830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9a85211f-b6ad-4538-81e1-ca33b1791f09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c09c8807c0>]}
[0m08:15:50.341294 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ex_02_chinook.dim_album' (models/mart/dim_album.sql) depends on a node named 'stg_chinook__album' which was not found
[0m08:15:50.342913 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 5.7825723, "process_in_blocks": "26968", "process_kernel_time": 0.616956, "process_mem_max_rss": "100444", "process_out_blocks": "6624", "process_user_time": 5.770411}
[0m08:15:50.343652 [debug] [MainThread]: Command `dbt build` failed at 08:15:50.343432 after 5.78 seconds
[0m08:15:50.344297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c09ff80310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c09bf64220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c09c5d3880>]}
[0m08:15:50.344888 [debug] [MainThread]: Flushing usage events
[0m08:16:16.719791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7090a69ab310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7090a360ba90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7090a360b940>]}


============================== 08:16:16.729086 | 44b6ec08-02b4-422e-b9e6-aaeb9fd15429 ==============================
[0m08:16:16.729086 [info ] [MainThread]: Running with dbt=1.8.9
[0m08:16:16.730200 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'indirect_selection': 'eager', 'version_check': 'True', 'log_format': 'default', 'write_json': 'True', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'target_path': 'None', 'warn_error': 'None', 'empty': 'False', 'use_colors': 'True', 'log_path': '/workdir/transforms/02_chinook/logs', 'no_print': 'None', 'printer_width': '80', 'introspect': 'True', 'fail_fast': 'False', 'quiet': 'False', 'profiles_dir': '.', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'invocation_command': 'dbt build --profiles-dir . --target local', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:16:17.317044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '44b6ec08-02b4-422e-b9e6-aaeb9fd15429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7090a5f53fd0>]}
[0m08:16:17.508771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '44b6ec08-02b4-422e-b9e6-aaeb9fd15429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7090a40f1430>]}
[0m08:16:17.510035 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m08:16:17.931558 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m08:16:17.933094 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m08:16:17.933798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '44b6ec08-02b4-422e-b9e6-aaeb9fd15429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7090a32a0ee0>]}
[0m08:16:22.613563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '44b6ec08-02b4-422e-b9e6-aaeb9fd15429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7090a32a0100>]}
[0m08:16:23.020605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '44b6ec08-02b4-422e-b9e6-aaeb9fd15429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7090a28df430>]}
[0m08:16:23.021460 [info ] [MainThread]: Found 4 models, 2 sources, 471 macros
[0m08:16:23.024414 [info ] [MainThread]: 
[0m08:16:23.025440 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m08:16:23.038138 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m08:16:23.045093 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m08:16:23.201277 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:16:23.202900 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:16:23.768465 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m08:16:23.796168 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m08:16:23.799628 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m08:16:23.807309 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:16:23.905579 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now create__staging)
[0m08:16:23.907226 [debug] [ThreadPool]: Creating schema "schema: "staging"
"
[0m08:16:23.922357 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create__staging, now list__mart)
[0m08:16:23.923981 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__staging)
[0m08:16:23.940565 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__mart"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'mart'
      

  ...
[0m08:16:24.002063 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__staging: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__staging"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'staging'
      

  ...
[0m08:16:24.013872 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:16:24.016045 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:16:24.024554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44b6ec08-02b4-422e-b9e6-aaeb9fd15429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7090a5dc8940>]}
[0m08:16:24.026317 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m08:16:24.027394 [info ] [MainThread]: 
[0m08:16:24.099001 [debug] [Thread-1  ]: Began running node model.ex_02_chinook.stg_chinook__album
[0m08:16:24.100323 [info ] [Thread-1  ]: 1 of 4 START sql view model `staging`.`stg_chinook__album` ..................... [RUN]
[0m08:16:24.101329 [debug] [Thread-2  ]: Began running node model.ex_02_chinook.stg_chinook__artist
[0m08:16:24.102199 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__mart, now model.ex_02_chinook.stg_chinook__album)
[0m08:16:24.103314 [info ] [Thread-2  ]: 2 of 4 START sql view model `staging`.`stg_chinook__artist` .................... [RUN]
[0m08:16:24.104282 [debug] [Thread-1  ]: Began compiling node model.ex_02_chinook.stg_chinook__album
[0m08:16:24.105385 [debug] [Thread-2  ]: Acquiring new clickhouse connection 'model.ex_02_chinook.stg_chinook__artist'
[0m08:16:24.125324 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_02_chinook.stg_chinook__album"
[0m08:16:24.126224 [debug] [Thread-2  ]: Began compiling node model.ex_02_chinook.stg_chinook__artist
[0m08:16:24.132324 [debug] [Thread-2  ]: Writing injected SQL for node "model.ex_02_chinook.stg_chinook__artist"
[0m08:16:24.133370 [debug] [Thread-1  ]: Began executing node model.ex_02_chinook.stg_chinook__album
[0m08:16:24.199793 [debug] [Thread-2  ]: Began executing node model.ex_02_chinook.stg_chinook__artist
[0m08:16:24.308784 [debug] [Thread-1  ]: Creating new relation stg_chinook__album
[0m08:16:24.422360 [debug] [Thread-2  ]: Creating new relation stg_chinook__artist
[0m08:16:24.512026 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_02_chinook.stg_chinook__album"
[0m08:16:24.514001 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m08:16:24.517250 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_02_chinook.stg_chinook__album: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.stg_chinook__album"} */


  create view `staging`.`stg_chinook__album` 
  
    
    
  as (
    

-- Keep album grain; standardize names/types.
select
  cast(album_id  as Nullable(Int64))      as album_id,
  cast(title     as Nullable(String))     as album_title,
  cast(artist_id as Nullable(Int64))      as artist_id
from `raw`.`albums`
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m08:16:24.522964 [debug] [Thread-1  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.stg_chinook__album"} */


  create view `staging`.`stg_chinook__album` 
  
    
    
  as (
    

-- Keep album grain; standardize names/types.
select
  cast(album_id  as Nullable(Int64))      as album_id,
  cast(title     as Nullable(String))     as album_title,
  cast(artist_id as Nullable(Int64))      as artist_id
from `raw`.`albums`
    
  )
      
      
                    -- end_of_sql
                    
                    
[0m08:16:24.604943 [debug] [Thread-1  ]: Database Error in model stg_chinook__album (models/clean/stg_chinook__album.sql)
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 497
   Code: 497. DB::Exception: ftw_user: Not enough privileges. To execute this query, it's necessary to have the grant CREATE VIEW ON staging.stg_chinook__album. (ACCESS_DENIED) (version 23.12.6.19 (official build))
  compiled code at target/run/ex_02_chinook/models/clean/stg_chinook__album.sql
[0m08:16:24.610776 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44b6ec08-02b4-422e-b9e6-aaeb9fd15429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7090a24903d0>]}
[0m08:16:24.613244 [error] [Thread-1  ]: 1 of 4 ERROR creating sql view model `staging`.`stg_chinook__album` ............ [[31mERROR[0m in 0.50s]
[0m08:16:24.616098 [debug] [Thread-1  ]: Finished running node model.ex_02_chinook.stg_chinook__album
[0m08:16:24.646038 [debug] [Thread-2  ]: Writing runtime sql for node "model.ex_02_chinook.stg_chinook__artist"
[0m08:16:24.648376 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_02_chinook.stg_chinook__artist: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.stg_chinook__artist"} */


  create view `staging`.`stg_chinook__artist` 
  
    
    
  as (
    

-- Standardize column names/types per table; no business logic.
select
  cast(artist_id as Nullable(Int64))      as artist_id,
  cast(name      as Nullable(String))     as artist_name
from `raw`.`artists`
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m08:16:24.654667 [debug] [Thread-2  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.stg_chinook__artist"} */


  create view `staging`.`stg_chinook__artist` 
  
    
    
  as (
    

-- Standardize column names/types per table; no business logic.
select
  cast(artist_id as Nullable(Int64))      as artist_id,
  cast(name      as Nullable(String))     as artist_name
from `raw`.`artists`
    
  )
      
      
                    -- end_of_sql
                    
                    
[0m08:16:24.658343 [debug] [Thread-2  ]: Database Error in model stg_chinook__artist (models/clean/stg_chinook__artist.sql)
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 497
   Code: 497. DB::Exception: ftw_user: Not enough privileges. To execute this query, it's necessary to have the grant CREATE VIEW ON staging.stg_chinook__artist. (ACCESS_DENIED) (version 23.12.6.19 (official build))
  compiled code at target/run/ex_02_chinook/models/clean/stg_chinook__artist.sql
[0m08:16:24.659818 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44b6ec08-02b4-422e-b9e6-aaeb9fd15429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7090a263a940>]}
[0m08:16:24.695519 [error] [Thread-2  ]: 2 of 4 ERROR creating sql view model `staging`.`stg_chinook__artist` ........... [[31mERROR[0m in 0.55s]
[0m08:16:24.697804 [debug] [Thread-2  ]: Finished running node model.ex_02_chinook.stg_chinook__artist
[0m08:16:24.699813 [debug] [Thread-4  ]: Began running node model.ex_02_chinook.dim_album
[0m08:16:24.700799 [debug] [Thread-3  ]: Began running node model.ex_02_chinook.dim_artist
[0m08:16:24.701963 [info ] [Thread-4  ]: 3 of 4 SKIP relation mart.dim_album ............................................ [[33mSKIP[0m]
[0m08:16:24.703164 [info ] [Thread-3  ]: 4 of 4 SKIP relation mart.dim_artist ........................................... [[33mSKIP[0m]
[0m08:16:24.704378 [debug] [Thread-4  ]: Finished running node model.ex_02_chinook.dim_album
[0m08:16:24.705496 [debug] [Thread-3  ]: Finished running node model.ex_02_chinook.dim_artist
[0m08:16:24.708055 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:16:24.708740 [debug] [MainThread]: Connection 'model.ex_02_chinook.stg_chinook__album' was left open.
[0m08:16:24.709328 [debug] [MainThread]: On model.ex_02_chinook.stg_chinook__album: Close
[0m08:16:24.709903 [debug] [MainThread]: Connection 'list__staging' was left open.
[0m08:16:24.710452 [debug] [MainThread]: On list__staging: Close
[0m08:16:24.711003 [debug] [MainThread]: Connection 'model.ex_02_chinook.stg_chinook__artist' was left open.
[0m08:16:24.711564 [debug] [MainThread]: On model.ex_02_chinook.stg_chinook__artist: Close
[0m08:16:24.712589 [info ] [MainThread]: 
[0m08:16:24.713298 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 1.69 seconds (1.69s).
[0m08:16:24.715524 [debug] [MainThread]: Command end result
[0m08:16:24.819373 [info ] [MainThread]: 
[0m08:16:24.820694 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m08:16:24.821676 [info ] [MainThread]: 
[0m08:16:24.823115 [error] [MainThread]:   Database Error in model stg_chinook__album (models/clean/stg_chinook__album.sql)
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 497
   Code: 497. DB::Exception: ftw_user: Not enough privileges. To execute this query, it's necessary to have the grant CREATE VIEW ON staging.stg_chinook__album. (ACCESS_DENIED) (version 23.12.6.19 (official build))
  compiled code at target/run/ex_02_chinook/models/clean/stg_chinook__album.sql
[0m08:16:24.823874 [info ] [MainThread]: 
[0m08:16:24.824828 [error] [MainThread]:   Database Error in model stg_chinook__artist (models/clean/stg_chinook__artist.sql)
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 497
   Code: 497. DB::Exception: ftw_user: Not enough privileges. To execute this query, it's necessary to have the grant CREATE VIEW ON staging.stg_chinook__artist. (ACCESS_DENIED) (version 23.12.6.19 (official build))
  compiled code at target/run/ex_02_chinook/models/clean/stg_chinook__artist.sql
[0m08:16:24.825654 [info ] [MainThread]: 
[0m08:16:24.826506 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=2 TOTAL=4
[0m08:16:24.828071 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 8.303202, "process_in_blocks": "6024", "process_kernel_time": 0.663966, "process_mem_max_rss": "114932", "process_out_blocks": "10536", "process_user_time": 6.875945}
[0m08:16:24.829117 [debug] [MainThread]: Command `dbt build` failed at 08:16:24.828903 after 8.30 seconds
[0m08:16:24.829810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7090a69ab310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7090a2834100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7090a5f53fd0>]}
[0m08:16:24.830395 [debug] [MainThread]: Flushing usage events
[0m08:19:17.613903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7def4f428310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7def4c087b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7def4c087a00>]}


============================== 08:19:17.673658 | 8c4bdebb-67b8-46b6-8115-8773f345dd57 ==============================
[0m08:19:17.673658 [info ] [MainThread]: Running with dbt=1.8.9
[0m08:19:17.674815 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'write_json': 'True', 'profiles_dir': '.', 'version_check': 'True', 'partial_parse': 'True', 'log_path': '/workdir/transforms/02_chinook/logs', 'log_format': 'default', 'static_parser': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt build --profiles-dir . --target local', 'no_print': 'None', 'warn_error': 'None', 'quiet': 'False', 'introspect': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'use_colors': 'True'}
[0m08:19:18.204478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c4bdebb-67b8-46b6-8115-8773f345dd57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7def4f62a160>]}
[0m08:19:18.397593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c4bdebb-67b8-46b6-8115-8773f345dd57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7def4c0788e0>]}
[0m08:19:18.398815 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m08:19:18.877796 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m08:19:19.294009 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m08:19:19.294981 [debug] [MainThread]: Partial parsing: updated file: ex_02_chinook://models/clean/stg_chinook__artist.sql
[0m08:19:19.295653 [debug] [MainThread]: Partial parsing: updated file: ex_02_chinook://models/clean/stg_chinook__album.sql
[0m08:19:20.170846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c4bdebb-67b8-46b6-8115-8773f345dd57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7def4b458130>]}
[0m08:19:20.526413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c4bdebb-67b8-46b6-8115-8773f345dd57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7def4b27d0a0>]}
[0m08:19:20.527278 [info ] [MainThread]: Found 4 models, 2 sources, 471 macros
[0m08:19:20.530252 [info ] [MainThread]: 
[0m08:19:20.531431 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m08:19:20.578367 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m08:19:20.590124 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m08:19:20.682830 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:19:20.681822 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:19:21.357610 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m08:19:21.375724 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m08:19:21.379754 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:19:21.384022 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:19:21.618177 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__mart)
[0m08:19:21.624581 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__clean)
[0m08:19:21.683940 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__mart"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'mart'
      

  ...
[0m08:19:21.689562 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__clean"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'clean'
      

  ...
[0m08:19:21.698422 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:19:21.703874 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:19:21.709753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c4bdebb-67b8-46b6-8115-8773f345dd57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7def4e842970>]}
[0m08:19:21.711492 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m08:19:21.712890 [info ] [MainThread]: 
[0m08:19:21.787891 [debug] [Thread-1  ]: Began running node model.ex_02_chinook.stg_chinook__album
[0m08:19:21.788764 [debug] [Thread-2  ]: Began running node model.ex_02_chinook.stg_chinook__artist
[0m08:19:21.789846 [info ] [Thread-1  ]: 1 of 4 START sql view model `clean`.`stg_chinook__album` ....................... [RUN]
[0m08:19:21.790964 [info ] [Thread-2  ]: 2 of 4 START sql view model `clean`.`stg_chinook__artist` ...................... [RUN]
[0m08:19:21.792128 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.ex_02_chinook.stg_chinook__album'
[0m08:19:21.793096 [debug] [Thread-2  ]: Acquiring new clickhouse connection 'model.ex_02_chinook.stg_chinook__artist'
[0m08:19:21.793885 [debug] [Thread-1  ]: Began compiling node model.ex_02_chinook.stg_chinook__album
[0m08:19:21.794648 [debug] [Thread-2  ]: Began compiling node model.ex_02_chinook.stg_chinook__artist
[0m08:19:21.812780 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_02_chinook.stg_chinook__album"
[0m08:19:21.872382 [debug] [Thread-2  ]: Writing injected SQL for node "model.ex_02_chinook.stg_chinook__artist"
[0m08:19:21.874762 [debug] [Thread-1  ]: Began executing node model.ex_02_chinook.stg_chinook__album
[0m08:19:21.876600 [debug] [Thread-2  ]: Began executing node model.ex_02_chinook.stg_chinook__artist
[0m08:19:22.203849 [debug] [Thread-2  ]: Creating new relation stg_chinook__artist
[0m08:19:22.206353 [debug] [Thread-1  ]: Creating new relation stg_chinook__album
[0m08:19:22.374089 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m08:19:22.379606 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m08:19:22.547804 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_02_chinook.stg_chinook__album"
[0m08:19:22.571480 [debug] [Thread-2  ]: Writing runtime sql for node "model.ex_02_chinook.stg_chinook__artist"
[0m08:19:22.573197 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_02_chinook.stg_chinook__album: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.stg_chinook__album"} */


  create view `clean`.`stg_chinook__album` 
  
    
    
  as (
    

-- Keep album grain; standardize names/types.
select
  cast(album_id  as Nullable(Int64))      as album_id,
  cast(title     as Nullable(String))     as album_title,
  cast(artist_id as Nullable(Int64))      as artist_id
from `raw`.`albums`
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m08:19:22.577101 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_02_chinook.stg_chinook__artist: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.stg_chinook__artist"} */


  create view `clean`.`stg_chinook__artist` 
  
    
    
  as (
    

-- Standardize column names/types per table; no business logic.
select
  cast(artist_id as Nullable(Int64))      as artist_id,
  cast(name      as Nullable(String))     as artist_name
from `raw`.`artists`
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m08:19:22.581635 [debug] [Thread-1  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.stg_chinook__album"} */


  create view `clean`.`stg_chinook__album` 
  
    
    
  as (
    

-- Keep album grain; standardize names/types.
select
  cast(album_id  as Nullable(Int64))      as album_id,
  cast(title     as Nullable(String))     as album_title,
  cast(artist_id as Nullable(Int64))      as artist_id
from `raw`.`albums`
    
  )
      
      
                    -- end_of_sql
                    
                    
[0m08:19:22.585706 [debug] [Thread-2  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.stg_chinook__artist"} */


  create view `clean`.`stg_chinook__artist` 
  
    
    
  as (
    

-- Standardize column names/types per table; no business logic.
select
  cast(artist_id as Nullable(Int64))      as artist_id,
  cast(name      as Nullable(String))     as artist_name
from `raw`.`artists`
    
  )
      
      
                    -- end_of_sql
                    
                    
[0m08:19:22.595861 [debug] [Thread-2  ]: Database Error in model stg_chinook__artist (models/clean/stg_chinook__artist.sql)
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 60
   Code: 60. DB::Exception: Table raw.artists does not exist. (UNKNOWN_TABLE) (version 23.12.6.19 (official build))
  compiled code at target/run/ex_02_chinook/models/clean/stg_chinook__artist.sql
[0m08:19:22.597171 [debug] [Thread-1  ]: Database Error in model stg_chinook__album (models/clean/stg_chinook__album.sql)
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 60
   Code: 60. DB::Exception: Table raw.albums does not exist. (UNKNOWN_TABLE) (version 23.12.6.19 (official build))
  compiled code at target/run/ex_02_chinook/models/clean/stg_chinook__album.sql
[0m08:19:22.600523 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c4bdebb-67b8-46b6-8115-8773f345dd57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7def4c140550>]}
[0m08:19:22.601424 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c4bdebb-67b8-46b6-8115-8773f345dd57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7def4b82ae20>]}
[0m08:19:22.602824 [error] [Thread-2  ]: 2 of 4 ERROR creating sql view model `clean`.`stg_chinook__artist` ............. [[31mERROR[0m in 0.81s]
[0m08:19:22.604166 [error] [Thread-1  ]: 1 of 4 ERROR creating sql view model `clean`.`stg_chinook__album` .............. [[31mERROR[0m in 0.81s]
[0m08:19:22.605662 [debug] [Thread-2  ]: Finished running node model.ex_02_chinook.stg_chinook__artist
[0m08:19:22.607050 [debug] [Thread-1  ]: Finished running node model.ex_02_chinook.stg_chinook__album
[0m08:19:22.608443 [debug] [Thread-4  ]: Began running node model.ex_02_chinook.dim_artist
[0m08:19:22.609445 [debug] [Thread-2  ]: Began running node model.ex_02_chinook.dim_album
[0m08:19:22.610411 [info ] [Thread-4  ]: 3 of 4 SKIP relation mart.dim_artist ........................................... [[33mSKIP[0m]
[0m08:19:22.611459 [info ] [Thread-2  ]: 4 of 4 SKIP relation mart.dim_album ............................................ [[33mSKIP[0m]
[0m08:19:22.612578 [debug] [Thread-4  ]: Finished running node model.ex_02_chinook.dim_artist
[0m08:19:22.613736 [debug] [Thread-2  ]: Finished running node model.ex_02_chinook.dim_album
[0m08:19:22.616107 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:19:22.670286 [debug] [MainThread]: Connection 'list__mart' was left open.
[0m08:19:22.671608 [debug] [MainThread]: On list__mart: Close
[0m08:19:22.672673 [debug] [MainThread]: Connection 'list__clean' was left open.
[0m08:19:22.673820 [debug] [MainThread]: On list__clean: Close
[0m08:19:22.674868 [debug] [MainThread]: Connection 'model.ex_02_chinook.stg_chinook__album' was left open.
[0m08:19:22.675944 [debug] [MainThread]: On model.ex_02_chinook.stg_chinook__album: Close
[0m08:19:22.676987 [debug] [MainThread]: Connection 'model.ex_02_chinook.stg_chinook__artist' was left open.
[0m08:19:22.678103 [debug] [MainThread]: On model.ex_02_chinook.stg_chinook__artist: Close
[0m08:19:22.680196 [info ] [MainThread]: 
[0m08:19:22.681584 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 2.15 seconds (2.15s).
[0m08:19:22.685633 [debug] [MainThread]: Command end result
[0m08:19:22.890051 [info ] [MainThread]: 
[0m08:19:22.890909 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m08:19:22.891488 [info ] [MainThread]: 
[0m08:19:22.892299 [error] [MainThread]:   Database Error in model stg_chinook__artist (models/clean/stg_chinook__artist.sql)
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 60
   Code: 60. DB::Exception: Table raw.artists does not exist. (UNKNOWN_TABLE) (version 23.12.6.19 (official build))
  compiled code at target/run/ex_02_chinook/models/clean/stg_chinook__artist.sql
[0m08:19:22.892913 [info ] [MainThread]: 
[0m08:19:22.893672 [error] [MainThread]:   Database Error in model stg_chinook__album (models/clean/stg_chinook__album.sql)
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 60
   Code: 60. DB::Exception: Table raw.albums does not exist. (UNKNOWN_TABLE) (version 23.12.6.19 (official build))
  compiled code at target/run/ex_02_chinook/models/clean/stg_chinook__album.sql
[0m08:19:22.894285 [info ] [MainThread]: 
[0m08:19:22.894915 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=2 TOTAL=4
[0m08:19:22.896186 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 5.477993, "process_in_blocks": "0", "process_kernel_time": 0.673751, "process_mem_max_rss": "113764", "process_out_blocks": "10528", "process_user_time": 5.503464}
[0m08:19:22.896924 [debug] [MainThread]: Command `dbt build` failed at 08:19:22.896735 after 5.48 seconds
[0m08:19:22.897572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7def4f428310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7def4a5edb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7def4a5ed070>]}
[0m08:19:22.898169 [debug] [MainThread]: Flushing usage events
[0m08:20:40.300161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c00e2f4310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c00af54a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c00af54940>]}


============================== 08:20:40.309940 | ca3928e3-8b26-4980-8ffd-f2756d224eb2 ==============================
[0m08:20:40.309940 [info ] [MainThread]: Running with dbt=1.8.9
[0m08:20:40.311269 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'warn_error': 'None', 'profiles_dir': '.', 'use_experimental_parser': 'False', 'use_colors': 'True', 'write_json': 'True', 'log_format': 'default', 'version_check': 'True', 'indirect_selection': 'eager', 'empty': 'False', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_cache_events': 'False', 'quiet': 'False', 'debug': 'False', 'invocation_command': 'dbt build --profiles-dir . --target local', 'partial_parse': 'True', 'target_path': 'None', 'log_path': '/workdir/transforms/02_chinook/logs', 'no_print': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'static_parser': 'True'}
[0m08:20:40.891663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca3928e3-8b26-4980-8ffd-f2756d224eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c00af311f0>]}
[0m08:20:41.085867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca3928e3-8b26-4980-8ffd-f2756d224eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c00b052d00>]}
[0m08:20:41.087119 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m08:20:41.502856 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m08:20:41.972868 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m08:20:41.974362 [debug] [MainThread]: Partial parsing: updated file: ex_02_chinook://models/sources.yml
[0m08:20:41.974964 [debug] [MainThread]: Partial parsing: updated file: ex_02_chinook://models/clean/stg_chinook__artist.sql
[0m08:20:41.975523 [debug] [MainThread]: Partial parsing: updated file: ex_02_chinook://models/clean/stg_chinook__album.sql
[0m08:20:43.096278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca3928e3-8b26-4980-8ffd-f2756d224eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c00a01cee0>]}
[0m08:20:43.491702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca3928e3-8b26-4980-8ffd-f2756d224eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c009f18220>]}
[0m08:20:43.492543 [info ] [MainThread]: Found 4 models, 2 sources, 471 macros
[0m08:20:43.495455 [info ] [MainThread]: 
[0m08:20:43.496522 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m08:20:43.509564 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m08:20:43.510757 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m08:20:43.586583 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:20:43.588045 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:20:44.239470 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m08:20:44.244323 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m08:20:44.245862 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:20:44.249381 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:44.288974 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__clean)
[0m08:20:44.290020 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__mart)
[0m08:20:44.301653 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__clean"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'clean'
      

  ...
[0m08:20:44.306180 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__mart"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'mart'
      

  ...
[0m08:20:44.312351 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:20:44.315750 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:20:44.320164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca3928e3-8b26-4980-8ffd-f2756d224eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c009b1f130>]}
[0m08:20:44.371669 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m08:20:44.373138 [info ] [MainThread]: 
[0m08:20:44.400074 [debug] [Thread-1  ]: Began running node model.ex_02_chinook.stg_chinook__album
[0m08:20:44.400982 [debug] [Thread-2  ]: Began running node model.ex_02_chinook.stg_chinook__artist
[0m08:20:44.402006 [info ] [Thread-1  ]: 1 of 4 START sql view model `clean`.`stg_chinook__album` ....................... [RUN]
[0m08:20:44.403070 [info ] [Thread-2  ]: 2 of 4 START sql view model `clean`.`stg_chinook__artist` ...................... [RUN]
[0m08:20:44.404009 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__clean, now model.ex_02_chinook.stg_chinook__album)
[0m08:20:44.405038 [debug] [Thread-2  ]: Acquiring new clickhouse connection 'model.ex_02_chinook.stg_chinook__artist'
[0m08:20:44.405809 [debug] [Thread-1  ]: Began compiling node model.ex_02_chinook.stg_chinook__album
[0m08:20:44.406684 [debug] [Thread-2  ]: Began compiling node model.ex_02_chinook.stg_chinook__artist
[0m08:20:44.474089 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_02_chinook.stg_chinook__album"
[0m08:20:44.486579 [debug] [Thread-2  ]: Writing injected SQL for node "model.ex_02_chinook.stg_chinook__artist"
[0m08:20:44.488377 [debug] [Thread-1  ]: Began executing node model.ex_02_chinook.stg_chinook__album
[0m08:20:44.510160 [debug] [Thread-2  ]: Began executing node model.ex_02_chinook.stg_chinook__artist
[0m08:20:44.609845 [debug] [Thread-1  ]: Creating new relation stg_chinook__album
[0m08:20:44.619888 [debug] [Thread-2  ]: Creating new relation stg_chinook__artist
[0m08:20:44.776702 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m08:20:44.775373 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_02_chinook.stg_chinook__album"
[0m08:20:44.781578 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_02_chinook.stg_chinook__album: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.stg_chinook__album"} */


  create view `clean`.`stg_chinook__album` 
  
    
    
  as (
    

-- Keep album grain; standardize names/types.
select
  cast(album_id  as Nullable(Int64))      as album_id,
  cast(title     as Nullable(String))     as album_title,
  cast(artist_id as Nullable(Int64))      as artist_id
from `raw`.`chinook___albums`
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m08:20:44.806984 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m08:20:44.988754 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca3928e3-8b26-4980-8ffd-f2756d224eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c00d8a1520>]}
[0m08:20:44.993420 [info ] [Thread-1  ]: 1 of 4 OK created sql view model `clean`.`stg_chinook__album` .................. [[32mOK[0m in 0.58s]
[0m08:20:44.995895 [debug] [Thread-1  ]: Finished running node model.ex_02_chinook.stg_chinook__album
[0m08:20:45.031615 [debug] [Thread-2  ]: Writing runtime sql for node "model.ex_02_chinook.stg_chinook__artist"
[0m08:20:45.033472 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_02_chinook.stg_chinook__artist: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.stg_chinook__artist"} */


  create view `clean`.`stg_chinook__artist` 
  
    
    
  as (
    

-- Standardize column names/types per table; no business logic.
select
  cast(artist_id as Nullable(Int64))      as artist_id,
  cast(name      as Nullable(String))     as artist_name
from `raw`.`chinook___artists`
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m08:20:45.044272 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:20:45.048808 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca3928e3-8b26-4980-8ffd-f2756d224eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c009ba17c0>]}
[0m08:20:45.050842 [info ] [Thread-2  ]: 2 of 4 OK created sql view model `clean`.`stg_chinook__artist` ................. [[32mOK[0m in 0.64s]
[0m08:20:45.052970 [debug] [Thread-2  ]: Finished running node model.ex_02_chinook.stg_chinook__artist
[0m08:20:45.073006 [debug] [Thread-4  ]: Began running node model.ex_02_chinook.dim_album
[0m08:20:45.075013 [debug] [Thread-3  ]: Began running node model.ex_02_chinook.dim_artist
[0m08:20:45.077652 [info ] [Thread-4  ]: 3 of 4 START sql table model `mart`.`dim_album` ................................ [RUN]
[0m08:20:45.080652 [info ] [Thread-3  ]: 4 of 4 START sql table model `mart`.`dim_artist` ............................... [RUN]
[0m08:20:45.083585 [debug] [Thread-4  ]: Acquiring new clickhouse connection 'model.ex_02_chinook.dim_album'
[0m08:20:45.086025 [debug] [Thread-3  ]: Acquiring new clickhouse connection 'model.ex_02_chinook.dim_artist'
[0m08:20:45.087841 [debug] [Thread-4  ]: Began compiling node model.ex_02_chinook.dim_album
[0m08:20:45.089661 [debug] [Thread-3  ]: Began compiling node model.ex_02_chinook.dim_artist
[0m08:20:45.109191 [debug] [Thread-4  ]: Writing injected SQL for node "model.ex_02_chinook.dim_album"
[0m08:20:45.116625 [debug] [Thread-3  ]: Writing injected SQL for node "model.ex_02_chinook.dim_artist"
[0m08:20:45.119019 [debug] [Thread-3  ]: Began executing node model.ex_02_chinook.dim_artist
[0m08:20:45.171312 [debug] [Thread-4  ]: Began executing node model.ex_02_chinook.dim_album
[0m08:20:45.312238 [debug] [Thread-3  ]: Creating new relation dim_artist
[0m08:20:45.390231 [debug] [Thread-4  ]: Creating new relation dim_album
[0m08:20:45.781614 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m08:20:45.783578 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m08:20:45.971749 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_02_chinook.dim_album: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.dim_album"} */

            

    
        create table `mart`.`dim_album`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Album dimension, denormalized with artist_name (common convenience).
with album as (
  select * from `clean`.`stg_chinook__album`
),
artist as (
  select * from `clean`.`stg_chinook__artist`
)
select
  a.album_id,
  a.album_title,
  a.artist_id,
  ar.artist_name
from album a
left join artist ar
  on ar.artist_id = a.artist_id
          )
        
        ...
[0m08:20:45.980550 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_02_chinook.dim_artist: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.dim_artist"} */

            

    
        create table `mart`.`dim_artist`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Simple conformed dimension for artists.
select
  artist_id,
  artist_name
from `clean`.`stg_chinook__artist`
          )
        
        ...
[0m08:20:46.002438 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m08:20:46.016636 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m08:20:46.026945 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_02_chinook.dim_album: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.dim_album"} */

    select name, type from system.columns where table = 'dim_album'
    
      and database = 'mart'
    
    order by position
  ...
[0m08:20:46.030458 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_02_chinook.dim_artist: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.dim_artist"} */

    select name, type from system.columns where table = 'dim_artist'
    
      and database = 'mart'
    
    order by position
  ...
[0m08:20:46.037405 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:20:46.073191 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m08:20:46.085919 [debug] [Thread-4  ]: Writing runtime sql for node "model.ex_02_chinook.dim_album"
[0m08:20:46.091066 [debug] [Thread-3  ]: Writing runtime sql for node "model.ex_02_chinook.dim_artist"
[0m08:20:46.094010 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_02_chinook.dim_album: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.dim_album"} */

  
    
    
    
        
         


        insert into `mart`.`dim_album`
        ("album_id", "album_title", "artist_id", "artist_name")

-- Album dimension, denormalized with artist_name (common convenience).
with album as (
  select * from `clean`.`stg_chinook__album`
),
artist as (
  select * from `clean`.`stg_chinook__artist`
)
select
  a.album_id,
  a.album_title,
  a.artist_id,
  ar.artist_name
from album a
left join artist ar
  on ar.artist_id = a.artist_id
  ...
[0m08:20:46.096223 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_02_chinook.dim_artist: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.dim_artist"} */

  
    
    
    
        
         


        insert into `mart`.`dim_artist`
        ("artist_id", "artist_name")

-- Simple conformed dimension for artists.
select
  artist_id,
  artist_name
from `clean`.`stg_chinook__artist`
  ...
[0m08:20:46.107633 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:20:46.115448 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca3928e3-8b26-4980-8ffd-f2756d224eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c00ac3bd90>]}
[0m08:20:46.117992 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m08:20:46.120417 [info ] [Thread-3  ]: 4 of 4 OK created sql table model `mart`.`dim_artist` .......................... [[32mOK[0m in 1.03s]
[0m08:20:46.174041 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca3928e3-8b26-4980-8ffd-f2756d224eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c009ba66a0>]}
[0m08:20:46.176895 [debug] [Thread-3  ]: Finished running node model.ex_02_chinook.dim_artist
[0m08:20:46.179987 [info ] [Thread-4  ]: 3 of 4 OK created sql table model `mart`.`dim_album` ........................... [[32mOK[0m in 1.09s]
[0m08:20:46.183405 [debug] [Thread-4  ]: Finished running node model.ex_02_chinook.dim_album
[0m08:20:46.187441 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:20:46.188674 [debug] [MainThread]: Connection 'model.ex_02_chinook.stg_chinook__album' was left open.
[0m08:20:46.190007 [debug] [MainThread]: On model.ex_02_chinook.stg_chinook__album: Close
[0m08:20:46.191091 [debug] [MainThread]: Connection 'list__mart' was left open.
[0m08:20:46.192166 [debug] [MainThread]: On list__mart: Close
[0m08:20:46.193209 [debug] [MainThread]: Connection 'model.ex_02_chinook.stg_chinook__artist' was left open.
[0m08:20:46.194288 [debug] [MainThread]: On model.ex_02_chinook.stg_chinook__artist: Close
[0m08:20:46.195328 [debug] [MainThread]: Connection 'model.ex_02_chinook.dim_album' was left open.
[0m08:20:46.196486 [debug] [MainThread]: On model.ex_02_chinook.dim_album: Close
[0m08:20:46.197686 [debug] [MainThread]: Connection 'model.ex_02_chinook.dim_artist' was left open.
[0m08:20:46.198776 [debug] [MainThread]: On model.ex_02_chinook.dim_artist: Close
[0m08:20:46.200978 [info ] [MainThread]: 
[0m08:20:46.202340 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 2.70 seconds (2.70s).
[0m08:20:46.208280 [debug] [MainThread]: Command end result
[0m08:20:46.420286 [info ] [MainThread]: 
[0m08:20:46.472005 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:20:46.473300 [info ] [MainThread]: 
[0m08:20:46.474755 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m08:20:46.477595 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 6.3897505, "process_in_blocks": "0", "process_kernel_time": 0.586422, "process_mem_max_rss": "115652", "process_out_blocks": "10568", "process_user_time": 5.894728}
[0m08:20:46.479436 [debug] [MainThread]: Command `dbt build` succeeded at 08:20:46.478977 after 6.39 seconds
[0m08:20:46.480768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c00e2f4310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c009f18220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c00b880670>]}
[0m08:20:46.482013 [debug] [MainThread]: Flushing usage events
[0m08:29:04.884448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7080a617ef40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7080a2e21a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7080a2e21940>]}


============================== 08:29:04.893949 | 4384ba45-b63c-4062-8002-7b173b60ec7c ==============================
[0m08:29:04.893949 [info ] [MainThread]: Running with dbt=1.8.9
[0m08:29:04.895002 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'profiles_dir': '.', 'version_check': 'True', 'empty': 'False', 'target_path': 'None', 'fail_fast': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --profiles-dir . --target local', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'introspect': 'True', 'quiet': 'False', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'log_format': 'default', 'warn_error': 'None', 'no_print': 'None', 'log_path': '/workdir/transforms/02_chinook/logs'}
[0m08:29:05.474738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4384ba45-b63c-4062-8002-7b173b60ec7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7080a56d9fd0>]}
[0m08:29:05.667716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4384ba45-b63c-4062-8002-7b173b60ec7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7080a63db400>]}
[0m08:29:05.669033 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m08:29:06.088998 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m08:29:06.554063 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m08:29:06.554967 [debug] [MainThread]: Partial parsing: added file: ex_02_chinook://models/mart/vw_artist_album_counts.sql
[0m08:29:07.371371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4384ba45-b63c-4062-8002-7b173b60ec7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7080a21cf130>]}
[0m08:29:07.764539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4384ba45-b63c-4062-8002-7b173b60ec7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7080a205d6a0>]}
[0m08:29:07.765382 [info ] [MainThread]: Found 5 models, 2 sources, 471 macros
[0m08:29:07.768386 [info ] [MainThread]: 
[0m08:29:07.769624 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m08:29:07.783911 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m08:29:07.796159 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m08:29:07.870164 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:29:07.882215 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:29:08.511403 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m08:29:08.521000 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:29:08.552199 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m08:29:08.564515 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:29:08.766254 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__mart)
[0m08:29:08.767306 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__clean)
[0m08:29:08.778619 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__mart"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'mart'
      

  ...
[0m08:29:08.782568 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__clean"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'clean'
      

  ...
[0m08:29:08.788466 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:29:08.791711 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:29:08.796711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4384ba45-b63c-4062-8002-7b173b60ec7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7080a1e31430>]}
[0m08:29:08.797632 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m08:29:08.798260 [info ] [MainThread]: 
[0m08:29:08.860547 [debug] [Thread-1  ]: Began running node model.ex_02_chinook.stg_chinook__album
[0m08:29:08.861499 [debug] [Thread-2  ]: Began running node model.ex_02_chinook.stg_chinook__artist
[0m08:29:08.862464 [info ] [Thread-1  ]: 1 of 5 START sql view model `clean`.`stg_chinook__album` ....................... [RUN]
[0m08:29:08.863681 [info ] [Thread-2  ]: 2 of 5 START sql view model `clean`.`stg_chinook__artist` ...................... [RUN]
[0m08:29:08.865198 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.ex_02_chinook.stg_chinook__album'
[0m08:29:08.866478 [debug] [Thread-2  ]: Acquiring new clickhouse connection 'model.ex_02_chinook.stg_chinook__artist'
[0m08:29:08.867530 [debug] [Thread-1  ]: Began compiling node model.ex_02_chinook.stg_chinook__album
[0m08:29:08.868590 [debug] [Thread-2  ]: Began compiling node model.ex_02_chinook.stg_chinook__artist
[0m08:29:08.950326 [debug] [Thread-2  ]: Writing injected SQL for node "model.ex_02_chinook.stg_chinook__artist"
[0m08:29:08.897265 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_02_chinook.stg_chinook__album"
[0m08:29:08.953417 [debug] [Thread-2  ]: Began executing node model.ex_02_chinook.stg_chinook__artist
[0m08:29:08.954780 [debug] [Thread-1  ]: Began executing node model.ex_02_chinook.stg_chinook__album
[0m08:29:09.368932 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m08:29:09.375131 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m08:29:09.516324 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_02_chinook.stg_chinook__album"
[0m08:29:09.521274 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_02_chinook.stg_chinook__album: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.stg_chinook__album"} */


  create view `clean`.`stg_chinook__album__dbt_tmp` 
  
    
    
  as (
    

-- Keep album grain; standardize names/types.
select
  cast(album_id  as Nullable(Int64))      as album_id,
  cast(title     as Nullable(String))     as album_title,
  cast(artist_id as Nullable(Int64))      as artist_id
from `raw`.`chinook___albums`
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m08:29:09.525436 [debug] [Thread-2  ]: Writing runtime sql for node "model.ex_02_chinook.stg_chinook__artist"
[0m08:29:09.528871 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_02_chinook.stg_chinook__artist: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.stg_chinook__artist"} */


  create view `clean`.`stg_chinook__artist__dbt_tmp` 
  
    
    
  as (
    

-- Standardize column names/types per table; no business logic.
select
  cast(artist_id as Nullable(Int64))      as artist_id,
  cast(name      as Nullable(String))     as artist_name
from `raw`.`chinook___artists`
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m08:29:09.549228 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m08:29:09.575867 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m08:29:09.581631 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_02_chinook.stg_chinook__album: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.stg_chinook__album"} */

    drop table if exists `clean`.`stg_chinook__album__dbt_backup` 
  
  ...
[0m08:29:09.596067 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_02_chinook.stg_chinook__artist: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.stg_chinook__artist"} */

    drop table if exists `clean`.`stg_chinook__artist__dbt_backup` 
  
  ...
[0m08:29:09.652306 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m08:29:09.656807 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_02_chinook.stg_chinook__album: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.stg_chinook__album"} */

    rename table `clean`.`stg_chinook__album` to `clean`.`stg_chinook__album__dbt_backup` 
  
  ...
[0m08:29:09.661130 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:29:09.665373 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_02_chinook.stg_chinook__artist: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.stg_chinook__artist"} */

    rename table `clean`.`stg_chinook__artist` to `clean`.`stg_chinook__artist__dbt_backup` 
  
  ...
[0m08:29:09.670050 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:29:09.673004 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:29:09.687710 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_02_chinook.stg_chinook__album: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.stg_chinook__album"} */

    drop table if exists `clean`.`stg_chinook__album` 
  
  ...
[0m08:29:09.753242 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_02_chinook.stg_chinook__artist: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.stg_chinook__artist"} */

    drop table if exists `clean`.`stg_chinook__artist` 
  
  ...
[0m08:29:09.759510 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:29:09.763687 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_02_chinook.stg_chinook__album: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.stg_chinook__album"} */

    rename table `clean`.`stg_chinook__album__dbt_tmp` to `clean`.`stg_chinook__album` 
  
  ...
[0m08:29:09.768317 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:29:09.773381 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_02_chinook.stg_chinook__artist: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.stg_chinook__artist"} */

    rename table `clean`.`stg_chinook__artist__dbt_tmp` to `clean`.`stg_chinook__artist` 
  
  ...
[0m08:29:09.776030 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:29:09.793783 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m08:29:10.191901 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_02_chinook.stg_chinook__artist: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.stg_chinook__artist"} */

    drop table if exists `clean`.`stg_chinook__artist__dbt_backup` 
  ...
[0m08:29:10.194981 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_02_chinook.stg_chinook__album: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.stg_chinook__album"} */

    drop table if exists `clean`.`stg_chinook__album__dbt_backup` 
  ...
[0m08:29:10.252372 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m08:29:10.265487 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m08:29:10.269481 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4384ba45-b63c-4062-8002-7b173b60ec7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7080a1d18fa0>]}
[0m08:29:10.274239 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4384ba45-b63c-4062-8002-7b173b60ec7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7080a1d18880>]}
[0m08:29:10.276858 [info ] [Thread-2  ]: 2 of 5 OK created sql view model `clean`.`stg_chinook__artist` ................. [[32mOK[0m in 1.40s]
[0m08:29:10.279697 [info ] [Thread-1  ]: 1 of 5 OK created sql view model `clean`.`stg_chinook__album` .................. [[32mOK[0m in 1.41s]
[0m08:29:10.282717 [debug] [Thread-2  ]: Finished running node model.ex_02_chinook.stg_chinook__artist
[0m08:29:10.286087 [debug] [Thread-1  ]: Finished running node model.ex_02_chinook.stg_chinook__album
[0m08:29:10.289381 [debug] [Thread-4  ]: Began running node model.ex_02_chinook.dim_artist
[0m08:29:10.292889 [debug] [Thread-2  ]: Began running node model.ex_02_chinook.dim_album
[0m08:29:10.291621 [info ] [Thread-4  ]: 3 of 5 START sql table model `mart`.`dim_artist` ............................... [RUN]
[0m08:29:10.294748 [debug] [Thread-1  ]: Began running node model.ex_02_chinook.vw_artist_album_counts
[0m08:29:10.296845 [info ] [Thread-2  ]: 4 of 5 START sql table model `mart`.`dim_album` ................................ [RUN]
[0m08:29:10.349723 [debug] [Thread-4  ]: Acquiring new clickhouse connection 'model.ex_02_chinook.dim_artist'
[0m08:29:10.352126 [info ] [Thread-1  ]: 5 of 5 START sql view model `mart`.`vw_artist_album_counts` .................... [RUN]
[0m08:29:10.353973 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ex_02_chinook.stg_chinook__artist, now model.ex_02_chinook.dim_album)
[0m08:29:10.355660 [debug] [Thread-4  ]: Began compiling node model.ex_02_chinook.dim_artist
[0m08:29:10.357363 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ex_02_chinook.stg_chinook__album, now model.ex_02_chinook.vw_artist_album_counts)
[0m08:29:10.359107 [debug] [Thread-2  ]: Began compiling node model.ex_02_chinook.dim_album
[0m08:29:10.372208 [debug] [Thread-4  ]: Writing injected SQL for node "model.ex_02_chinook.dim_artist"
[0m08:29:10.374072 [debug] [Thread-1  ]: Began compiling node model.ex_02_chinook.vw_artist_album_counts
[0m08:29:10.387749 [debug] [Thread-2  ]: Writing injected SQL for node "model.ex_02_chinook.dim_album"
[0m08:29:10.454093 [debug] [Thread-4  ]: Began executing node model.ex_02_chinook.dim_artist
[0m08:29:10.458263 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_02_chinook.vw_artist_album_counts"
[0m08:29:10.476086 [debug] [Thread-1  ]: Began executing node model.ex_02_chinook.vw_artist_album_counts
[0m08:29:10.486111 [debug] [Thread-2  ]: Began executing node model.ex_02_chinook.dim_album
[0m08:29:10.551239 [debug] [Thread-1  ]: Creating new relation vw_artist_album_counts
[0m08:29:10.585560 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_02_chinook.vw_artist_album_counts"
[0m08:29:10.748916 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_02_chinook.vw_artist_album_counts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.vw_artist_album_counts"} */


  create view `mart`.`vw_artist_album_counts` 
  
    
    
  as (
    

with album as (
  select album_id, artist_id
  from `clean`.`stg_chinook__album`
),
artist as (
  select artist_id, artist_name
  from `clean`.`stg_chinook__artist`
)

select
  ar.artist_id,
  ar.artist_name,
  substring(ar.artist_name, 1, 1)             as artist_initial,
  count(a.album_id)                            as album_count,
  case when count(a.album_id) >= 3 then 1 else 0 end as is_prolific -- handy filter in dashboards
from artist ar
left join album a
  on a.artist_id = ar.artist_id
group by
  ar.artist_id,
  ar.artist_name
order by album_count desc, ar.artist_name asc
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m08:29:10.854604 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.09 seconds
[0m08:29:10.879815 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4384ba45-b63c-4062-8002-7b173b60ec7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7080a1c356d0>]}
[0m08:29:10.892821 [info ] [Thread-1  ]: 5 of 5 OK created sql view model `mart`.`vw_artist_album_counts` ............... [[32mOK[0m in 0.52s]
[0m08:29:10.959919 [debug] [Thread-1  ]: Finished running node model.ex_02_chinook.vw_artist_album_counts
[0m08:29:11.161858 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m08:29:11.163053 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_02_chinook.dim_album: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.dim_album"} */

            

    
        create table `mart`.`dim_album__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Album dimension, denormalized with artist_name (common convenience).
with album as (
  select * from `clean`.`stg_chinook__album`
),
artist as (
  select * from `clean`.`stg_chinook__artist`
)
select
  a.album_id,
  a.album_title,
  a.artist_id,
  ar.artist_name
from album a
left join artist ar
  on ar.artist_id = a.artist_id
          )
        
        ...
[0m08:29:11.182232 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m08:29:11.254546 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_02_chinook.dim_album: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.dim_album"} */

    select name, type from system.columns where table = 'dim_album__dbt_backup'
    
      and database = 'mart'
    
    order by position
  ...
[0m08:29:11.266164 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:29:11.277826 [debug] [Thread-2  ]: Writing runtime sql for node "model.ex_02_chinook.dim_album"
[0m08:29:11.279901 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_02_chinook.dim_album: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.dim_album"} */

  
    
    
    
        
         


        insert into `mart`.`dim_album__dbt_backup`
        ("album_id", "album_title", "artist_id", "artist_name")

-- Album dimension, denormalized with artist_name (common convenience).
with album as (
  select * from `clean`.`stg_chinook__album`
),
artist as (
  select * from `clean`.`stg_chinook__artist`
)
select
  a.album_id,
  a.album_title,
  a.artist_id,
  ar.artist_name
from album a
left join artist ar
  on ar.artist_id = a.artist_id
  ...
[0m08:29:11.296476 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m08:29:11.353461 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_02_chinook.dim_album: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.dim_album"} */
EXCHANGE TABLES `mart`.`dim_album__dbt_backup` AND `mart`.`dim_album` 
  
  ...
[0m08:29:11.359249 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:29:11.370403 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_02_chinook.dim_album: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.dim_album"} */

    drop table if exists `mart`.`dim_album__dbt_backup` 
  ...
[0m08:29:11.377652 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_02_chinook.dim_artist: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.dim_artist"} */

            

    
        create table `mart`.`dim_artist__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Simple conformed dimension for artists.
select
  artist_id,
  artist_name
from `clean`.`stg_chinook__artist`
          )
        
        ...
[0m08:29:11.384022 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:29:11.388177 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4384ba45-b63c-4062-8002-7b173b60ec7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7080a1d13f10>]}
[0m08:29:11.390091 [info ] [Thread-2  ]: 4 of 5 OK created sql table model `mart`.`dim_album` ........................... [[32mOK[0m in 1.03s]
[0m08:29:11.392394 [debug] [Thread-2  ]: Finished running node model.ex_02_chinook.dim_album
[0m08:29:11.396771 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m08:29:11.456339 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_02_chinook.dim_artist: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.dim_artist"} */

    select name, type from system.columns where table = 'dim_artist__dbt_backup'
    
      and database = 'mart'
    
    order by position
  ...
[0m08:29:11.465204 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:29:11.470372 [debug] [Thread-4  ]: Writing runtime sql for node "model.ex_02_chinook.dim_artist"
[0m08:29:11.472610 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_02_chinook.dim_artist: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.dim_artist"} */

  
    
    
    
        
         


        insert into `mart`.`dim_artist__dbt_backup`
        ("artist_id", "artist_name")

-- Simple conformed dimension for artists.
select
  artist_id,
  artist_name
from `clean`.`stg_chinook__artist`
  ...
[0m08:29:11.481914 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:29:11.486200 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_02_chinook.dim_artist: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.dim_artist"} */
EXCHANGE TABLES `mart`.`dim_artist__dbt_backup` AND `mart`.`dim_artist` 
  
  ...
[0m08:29:11.491731 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:29:11.505390 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_02_chinook.dim_artist: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.dim_artist"} */

    drop table if exists `mart`.`dim_artist__dbt_backup` 
  ...
[0m08:29:11.551816 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m08:29:11.556363 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4384ba45-b63c-4062-8002-7b173b60ec7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7080a1d1e3d0>]}
[0m08:29:11.558389 [info ] [Thread-4  ]: 3 of 5 OK created sql table model `mart`.`dim_artist` .......................... [[32mOK[0m in 1.21s]
[0m08:29:11.560828 [debug] [Thread-4  ]: Finished running node model.ex_02_chinook.dim_artist
[0m08:29:11.564671 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:29:11.565761 [debug] [MainThread]: Connection 'list__mart' was left open.
[0m08:29:11.566928 [debug] [MainThread]: On list__mart: Close
[0m08:29:11.567997 [debug] [MainThread]: Connection 'list__clean' was left open.
[0m08:29:11.569092 [debug] [MainThread]: On list__clean: Close
[0m08:29:11.570168 [debug] [MainThread]: Connection 'model.ex_02_chinook.vw_artist_album_counts' was left open.
[0m08:29:11.571280 [debug] [MainThread]: On model.ex_02_chinook.vw_artist_album_counts: Close
[0m08:29:11.572339 [debug] [MainThread]: Connection 'model.ex_02_chinook.dim_album' was left open.
[0m08:29:11.573438 [debug] [MainThread]: On model.ex_02_chinook.dim_album: Close
[0m08:29:11.574477 [debug] [MainThread]: Connection 'model.ex_02_chinook.dim_artist' was left open.
[0m08:29:11.575597 [debug] [MainThread]: On model.ex_02_chinook.dim_artist: Close
[0m08:29:11.577708 [info ] [MainThread]: 
[0m08:29:11.579081 [info ] [MainThread]: Finished running 3 view models, 2 table models in 0 hours 0 minutes and 3.81 seconds (3.81s).
[0m08:29:11.585423 [debug] [MainThread]: Command end result
[0m08:29:11.865823 [info ] [MainThread]: 
[0m08:29:11.867586 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:29:11.869096 [info ] [MainThread]: 
[0m08:29:11.870767 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m08:29:11.873679 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 7.1826053, "process_in_blocks": "0", "process_kernel_time": 0.659697, "process_mem_max_rss": "114800", "process_out_blocks": "10624", "process_user_time": 6.298559}
[0m08:29:11.875446 [debug] [MainThread]: Command `dbt build` succeeded at 08:29:11.874943 after 7.18 seconds
[0m08:29:11.876819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7080a617ef40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7080a1ceb7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7080a40e3580>]}
[0m08:29:11.877962 [debug] [MainThread]: Flushing usage events
[0m07:53:20.136007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73fdf96c9310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73fdf631cac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73fdf631c970>]}


============================== 07:53:20.187395 | 2744a170-25ec-42f5-8b46-892d58a3b907 ==============================
[0m07:53:20.187395 [info ] [MainThread]: Running with dbt=1.8.9
[0m07:53:20.192139 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'warn_error': 'None', 'fail_fast': 'False', 'log_cache_events': 'False', 'no_print': 'None', 'log_format': 'default', 'profiles_dir': '.', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'invocation_command': 'dbt build --profiles-dir . --target remote', 'log_path': '/workdir/transforms/09_oulad/logs', 'empty': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'quiet': 'False', 'version_check': 'True', 'static_parser': 'True', 'write_json': 'True', 'cache_selected_only': 'False'}
[0m07:53:20.985080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2744a170-25ec-42f5-8b46-892d58a3b907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73fdf8c6bb50>]}
[0m07:53:21.169354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2744a170-25ec-42f5-8b46-892d58a3b907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73fdf9adea00>]}
[0m07:53:21.172631 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m07:53:21.681846 [debug] [MainThread]: checksum: 265ce5244aff672775eaff93c261d21692ed3f5650f4d9e918c76acdb0e9479a, vars: {}, profile: , target: remote, version: 1.8.9
[0m07:53:20.727013 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m07:53:20.730365 [debug] [MainThread]: previous checksum: 265ce5244aff672775eaff93c261d21692ed3f5650f4d9e918c76acdb0e9479a, current checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979
[0m07:53:20.732086 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m07:53:20.734709 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m07:53:20.736540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2744a170-25ec-42f5-8b46-892d58a3b907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73fdf7651c10>]}
[0m07:53:22.639702 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ex_09_oulad.grp5_stg_oulad_student_assessment' (models/clean/grp5_stg_oulad_student_assessment.sql) depends on a source named 'raw.grp5___student_assessment' which was not found
[0m07:53:22.644702 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 5.8357706, "process_in_blocks": "71192", "process_kernel_time": 6.584676, "process_mem_max_rss": "100500", "process_out_blocks": "6616", "process_user_time": 10.544718}
[0m07:53:22.646029 [debug] [MainThread]: Command `dbt build` failed at 07:53:22.645725 after 5.84 seconds
[0m07:53:22.647217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73fdf96c9310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73fdf60f6cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73fdf4807880>]}
[0m07:53:22.648277 [debug] [MainThread]: Flushing usage events
[0m07:55:04.287968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d25ada4310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d257a17be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d257a17a90>]}


============================== 07:55:04.307500 | 7c15adaa-afcd-4741-88c3-bba7d2f31d65 ==============================
[0m07:55:04.307500 [info ] [MainThread]: Running with dbt=1.8.9
[0m07:55:04.310169 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'profiles_dir': '.', 'indirect_selection': 'eager', 'static_parser': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'no_print': 'None', 'log_format': 'default', 'fail_fast': 'False', 'introspect': 'True', 'target_path': 'None', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': '/workdir/transforms/09_oulad/logs', 'partial_parse': 'True', 'use_colors': 'True', 'printer_width': '80', 'debug': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --profiles-dir . --target remote', 'cache_selected_only': 'False', 'quiet': 'False'}
[0m07:55:05.857805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c15adaa-afcd-4741-88c3-bba7d2f31d65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d25a333b80>]}
[0m07:55:06.184303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c15adaa-afcd-4741-88c3-bba7d2f31d65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d2594eb220>]}
[0m07:55:06.188575 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m07:55:06.768372 [debug] [MainThread]: checksum: 265ce5244aff672775eaff93c261d21692ed3f5650f4d9e918c76acdb0e9479a, vars: {}, profile: , target: remote, version: 1.8.9
[0m07:55:07.282839 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m07:55:07.287430 [debug] [MainThread]: previous checksum: 265ce5244aff672775eaff93c261d21692ed3f5650f4d9e918c76acdb0e9479a, current checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979
[0m07:55:07.289209 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m07:55:07.290757 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m07:55:07.292381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7c15adaa-afcd-4741-88c3-bba7d2f31d65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d258cbb310>]}
[0m07:55:12.565539 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ex_09_oulad.grp5_stg_oulad_student_assessment' (models/clean/grp5_stg_oulad_student_assessment.sql) depends on a source named 'raw.grp5_oulad___student_assessment' which was not found
[0m07:55:12.569942 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 8.666306, "process_in_blocks": "0", "process_kernel_time": 2.462386, "process_mem_max_rss": "100740", "process_out_blocks": "6624", "process_user_time": 12.817635}
[0m07:55:12.572045 [debug] [MainThread]: Command `dbt build` failed at 07:55:12.571362 after 8.67 seconds
[0m07:55:12.574213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d25ada4310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d25a0793d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d25735bd30>]}
[0m07:55:12.576133 [debug] [MainThread]: Flushing usage events
[0m07:56:17.709227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fd6077f310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fd5d3cfb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fd5d3cf9d0>]}


============================== 07:56:17.726424 | e86547b0-b190-4bfc-98d6-7461b7f1987c ==============================
[0m07:56:17.726424 [info ] [MainThread]: Running with dbt=1.8.9
[0m07:56:17.728498 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'log_path': '/workdir/transforms/09_oulad/logs', 'invocation_command': 'dbt build --profiles-dir . --target remote', 'no_print': 'None', 'write_json': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'introspect': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'empty': 'False', 'printer_width': '80', 'log_format': 'default', 'static_parser': 'True', 'debug': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'profiles_dir': '.'}
[0m07:56:18.281530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e86547b0-b190-4bfc-98d6-7461b7f1987c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fd5d3104c0>]}
[0m07:56:18.547509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e86547b0-b190-4bfc-98d6-7461b7f1987c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fd5d29f4c0>]}
[0m07:56:18.551307 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m07:56:18.935369 [debug] [MainThread]: checksum: 265ce5244aff672775eaff93c261d21692ed3f5650f4d9e918c76acdb0e9479a, vars: {}, profile: , target: remote, version: 1.8.9
[0m07:56:19.390253 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m07:56:19.392090 [debug] [MainThread]: previous checksum: 265ce5244aff672775eaff93c261d21692ed3f5650f4d9e918c76acdb0e9479a, current checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979
[0m07:56:19.394036 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m07:56:19.395427 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m07:56:19.398412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e86547b0-b190-4bfc-98d6-7461b7f1987c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fd5e705160>]}
[0m07:56:23.869197 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ex_09_oulad.mart
[0m07:56:23.919600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e86547b0-b190-4bfc-98d6-7461b7f1987c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fd5d1a1b50>]}
[0m07:56:24.400652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e86547b0-b190-4bfc-98d6-7461b7f1987c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fd5b7eb1c0>]}
[0m07:56:24.402528 [info ] [MainThread]: Found 1 model, 1 source, 471 macros
[0m07:56:24.408922 [info ] [MainThread]: 
[0m07:56:24.410923 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m07:56:24.417194 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m07:56:24.497599 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:56:40.678335 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m07:56:41.120097 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.43 seconds
[0m07:56:41.327007 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__clean)
[0m07:56:41.348123 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list__clean"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'clean'
      

  ...
[0m07:56:41.980938 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.63 seconds
[0m07:56:42.116829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e86547b0-b190-4bfc-98d6-7461b7f1987c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fd5b424340>]}
[0m07:56:42.119410 [info ] [MainThread]: Concurrency: 4 threads (target='remote')
[0m07:56:42.121944 [info ] [MainThread]: 
[0m07:56:42.171855 [debug] [Thread-1  ]: Began running node model.ex_09_oulad.grp5_stg_oulad_student_assessment
[0m07:56:42.174043 [info ] [Thread-1  ]: 1 of 1 START sql table model `clean`.`grp5_stg_oulad_student_assessment` ....... [RUN]
[0m07:56:42.176189 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__clean, now model.ex_09_oulad.grp5_stg_oulad_student_assessment)
[0m07:56:42.178770 [debug] [Thread-1  ]: Began compiling node model.ex_09_oulad.grp5_stg_oulad_student_assessment
[0m07:56:42.217828 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_09_oulad.grp5_stg_oulad_student_assessment"
[0m07:56:42.223870 [debug] [Thread-1  ]: Began executing node model.ex_09_oulad.grp5_stg_oulad_student_assessment
[0m07:56:42.307235 [debug] [Thread-1  ]: Creating new relation grp5_stg_oulad_student_assessment
[0m07:56:42.388342 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_assessment"} */

            

    
        create table `clean`.`grp5_stg_oulad_student_assessment`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
             

-- Standardize names and types for student assessment
select
  cast(id_assessment  as Nullable(Int64)) as assessment_id,
  cast(id_student     as Nullable(Int64)) as student_id,
  cast(date_submitted as Nullable(Int64)) as date_submitted,
  cast(is_banked      as Nullable(Int64)) as is_banked,
  cast(score          as Nullable(Int64)) as score
from `raw`.`grp5_oulad___student_assessment`
          )
        
        ...
[0m07:56:42.869569 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.48 seconds
[0m07:56:42.897680 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_assessment"} */

    select name, type from system.columns where table = 'grp5_stg_oulad_student_assessment'
    
      and database = 'clean'
    
    order by position
  ...
[0m07:56:43.326291 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.43 seconds
[0m07:56:43.335627 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_09_oulad.grp5_stg_oulad_student_assessment"
[0m07:56:43.341036 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_assessment"} */

  
    
    
    
        
         


        insert into `clean`.`grp5_stg_oulad_student_assessment`
        ("assessment_id", "student_id", "date_submitted", "is_banked", "score") 

-- Standardize names and types for student assessment
select
  cast(id_assessment  as Nullable(Int64)) as assessment_id,
  cast(id_student     as Nullable(Int64)) as student_id,
  cast(date_submitted as Nullable(Int64)) as date_submitted,
  cast(is_banked      as Nullable(Int64)) as is_banked,
  cast(score          as Nullable(Int64)) as score
from `raw`.`grp5_oulad___student_assessment`
  ...
[0m07:56:43.787014 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.44 seconds
[0m07:56:43.856722 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e86547b0-b190-4bfc-98d6-7461b7f1987c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fd5b685a90>]}
[0m07:56:43.860493 [info ] [Thread-1  ]: 1 of 1 OK created sql table model `clean`.`grp5_stg_oulad_student_assessment` .. [[32mOK[0m in 1.68s]
[0m07:56:43.864534 [debug] [Thread-1  ]: Finished running node model.ex_09_oulad.grp5_stg_oulad_student_assessment
[0m07:56:43.872522 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:56:43.874836 [debug] [MainThread]: Connection 'model.ex_09_oulad.grp5_stg_oulad_student_assessment' was left open.
[0m07:56:43.877438 [debug] [MainThread]: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: Close
[0m07:56:43.879748 [info ] [MainThread]: 
[0m07:56:43.883180 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 19.47 seconds (19.47s).
[0m07:56:43.893475 [debug] [MainThread]: Command end result
[0m07:56:44.047976 [info ] [MainThread]: 
[0m07:56:44.050886 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:56:44.053078 [info ] [MainThread]: 
[0m07:56:44.055115 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:56:44.064080 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 28.231514, "process_in_blocks": "7688", "process_kernel_time": 2.935211, "process_mem_max_rss": "114604", "process_out_blocks": "10464", "process_user_time": 13.080583}
[0m07:56:44.067079 [debug] [MainThread]: Command `dbt build` succeeded at 07:56:44.066290 after 28.23 seconds
[0m07:56:44.069951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fd6077f310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fd5e695c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76fd5b7690d0>]}
[0m07:56:44.075051 [debug] [MainThread]: Flushing usage events
[0m15:55:32.014081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddfbf59a310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddfbc1f8b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddfbc1f89d0>]}


============================== 15:55:32.036925 | 13858bfa-3a86-4ad3-a356-2e4082deefe2 ==============================
[0m15:55:32.036925 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:55:32.040040 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'partial_parse': 'True', 'profiles_dir': '.', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt build --profiles-dir . --target remote', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'empty': 'False', 'log_format': 'default', 'debug': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'write_json': 'True', 'cache_selected_only': 'False', 'log_path': '/workdir/transforms/09_oulad/logs', 'use_colors': 'True', 'introspect': 'True', 'fail_fast': 'False', 'static_parser': 'True', 'warn_error': 'None', 'no_print': 'None', 'indirect_selection': 'eager', 'target_path': 'None'}
[0m15:55:29.788100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13858bfa-3a86-4ad3-a356-2e4082deefe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddfbeb3e3a0>]}
[0m15:55:29.982768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '13858bfa-3a86-4ad3-a356-2e4082deefe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddfbc2e57f0>]}
[0m15:55:29.986655 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m15:55:30.269700 [debug] [MainThread]: checksum: 265ce5244aff672775eaff93c261d21692ed3f5650f4d9e918c76acdb0e9479a, vars: {}, profile: , target: remote, version: 1.8.9
[0m15:55:30.796721 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m15:55:30.798207 [debug] [MainThread]: Partial parsing: added file: ex_09_oulad://models/mart/grp5_oulad_dim_student.sql
[0m15:55:30.799566 [debug] [MainThread]: Partial parsing: added file: ex_09_oulad://models/mart/grp5_oulad_dim_module_presentation.sql
[0m15:55:30.801516 [debug] [MainThread]: Partial parsing: updated file: ex_09_oulad://models/sources.yml
[0m15:55:31.718809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '13858bfa-3a86-4ad3-a356-2e4082deefe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddfba5409d0>]}
[0m15:55:32.024467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '13858bfa-3a86-4ad3-a356-2e4082deefe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddfba430bb0>]}
[0m15:55:32.025797 [info ] [MainThread]: Found 3 models, 3 sources, 471 macros
[0m15:55:32.030597 [info ] [MainThread]: 
[0m15:55:32.032719 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m15:55:32.051357 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m15:55:32.054538 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m15:55:32.099725 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:55:32.114267 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:55:37.726275 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m15:55:37.791401 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m15:55:38.111539 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.32 seconds
[0m15:55:38.114537 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.39 seconds
[0m15:55:38.170077 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__sandbox)
[0m15:55:38.171975 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__clean)
[0m15:55:38.187678 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__sandbox: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list__sandbox"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'sandbox'
      

  ...
[0m15:55:38.194841 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list__clean"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'clean'
      

  ...
[0m15:55:38.526913 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.33 seconds
[0m15:55:38.970116 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.77 seconds
[0m15:55:39.154314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13858bfa-3a86-4ad3-a356-2e4082deefe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddfbbb1b040>]}
[0m15:55:39.157128 [info ] [MainThread]: Concurrency: 4 threads (target='remote')
[0m15:55:39.158673 [info ] [MainThread]: 
[0m15:55:39.191872 [debug] [Thread-1  ]: Began running node model.ex_09_oulad.grp5_oulad_dim_module_presentation
[0m15:55:39.194022 [debug] [Thread-2  ]: Began running node model.ex_09_oulad.grp5_oulad_dim_student
[0m15:55:39.199085 [debug] [Thread-3  ]: Began running node model.ex_09_oulad.grp5_stg_oulad_student_assessment
[0m15:55:39.196012 [info ] [Thread-1  ]: 1 of 3 START sql table model `sandbox`.`grp5_oulad_dim_module_presentation` .... [RUN]
[0m15:55:39.203971 [info ] [Thread-2  ]: 2 of 3 START sql table model `sandbox`.`grp5_oulad_dim_student` ................ [RUN]
[0m15:55:39.206835 [info ] [Thread-3  ]: 3 of 3 START sql table model `clean`.`grp5_stg_oulad_student_assessment` ....... [RUN]
[0m15:55:39.210302 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.ex_09_oulad.grp5_oulad_dim_module_presentation'
[0m15:55:39.212900 [debug] [Thread-2  ]: Acquiring new clickhouse connection 'model.ex_09_oulad.grp5_oulad_dim_student'
[0m15:55:39.216126 [debug] [Thread-3  ]: Acquiring new clickhouse connection 'model.ex_09_oulad.grp5_stg_oulad_student_assessment'
[0m15:55:39.219180 [debug] [Thread-1  ]: Began compiling node model.ex_09_oulad.grp5_oulad_dim_module_presentation
[0m15:55:39.221185 [debug] [Thread-2  ]: Began compiling node model.ex_09_oulad.grp5_oulad_dim_student
[0m15:55:39.222713 [debug] [Thread-3  ]: Began compiling node model.ex_09_oulad.grp5_stg_oulad_student_assessment
[0m15:55:39.263322 [debug] [Thread-2  ]: Writing injected SQL for node "model.ex_09_oulad.grp5_oulad_dim_student"
[0m15:55:39.265768 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_09_oulad.grp5_oulad_dim_module_presentation"
[0m15:55:39.279987 [debug] [Thread-3  ]: Writing injected SQL for node "model.ex_09_oulad.grp5_stg_oulad_student_assessment"
[0m15:55:39.284226 [debug] [Thread-3  ]: Began executing node model.ex_09_oulad.grp5_stg_oulad_student_assessment
[0m15:55:39.292551 [debug] [Thread-2  ]: Began executing node model.ex_09_oulad.grp5_oulad_dim_student
[0m15:55:39.294619 [debug] [Thread-1  ]: Began executing node model.ex_09_oulad.grp5_oulad_dim_module_presentation
[0m15:55:39.442632 [debug] [Thread-2  ]: Creating new relation grp5_oulad_dim_student
[0m15:55:39.482341 [debug] [Thread-1  ]: Creating new relation grp5_oulad_dim_module_presentation
[0m15:55:39.691952 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m15:55:39.696848 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m15:55:39.688383 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m15:55:43.901186 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_assessment"} */

            

    
        create table `clean`.`grp5_stg_oulad_student_assessment__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
             

-- Standardize names and types for student assessment
select
  cast(id_assessment  as Nullable(Int64)) as assessment_id,
  cast(id_student     as Nullable(Int64)) as student_id,
  cast(date_submitted as Nullable(Int64)) as date_submitted,
  cast(is_banked      as Nullable(Int64)) as is_banked,
  cast(score          as Nullable(Int64)) as score
from `raw`.`grp5_oulad___student_assessment`
          )
        
        ...
[0m15:55:44.254076 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.35 seconds
[0m15:55:44.274745 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_assessment"} */

    select name, type from system.columns where table = 'grp5_stg_oulad_student_assessment__dbt_backup'
    
      and database = 'clean'
    
    order by position
  ...
[0m15:55:44.525740 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_student: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_student"} */

            

    
        create table `sandbox`.`grp5_oulad_dim_student`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Dimension table for students (no surrogate key)
select
    cast(id_student as Int64)               as id_student,
    cast(gender as Nullable(String))        as gender,
    cast(age_band as Nullable(String))      as age_band,
    cast(region as Nullable(String))        as region,
    cast(highest_education as Nullable(String)) as highest_education,
    cast(imd_band as Nullable(String))      as imd_band,
    cast(disability as Nullable(String))    as disability
from `clean`.`grp5_stg_oulad_student_info`
          )
        
        ...
[0m15:55:44.529736 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_module_presentation: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_module_presentation"} */

            

    
        create table `sandbox`.`grp5_oulad_dim_module_presentation`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Dimension table for module + presentation (simple, with Nullable types)
select
    cast(code_module as Nullable(String))       as code_module,
    cast(code_presentation as Nullable(String)) as code_presentation,
    cast(length as Nullable(Int32))             as length_days
from `clean`.`grp5_stg_oulad_courses`
          )
        
        ...
[0m15:55:44.617792 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.34 seconds
[0m15:55:44.626789 [debug] [Thread-3  ]: Writing runtime sql for node "model.ex_09_oulad.grp5_stg_oulad_student_assessment"
[0m15:55:44.629782 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_assessment"} */

  
    
    
    
        
         


        insert into `clean`.`grp5_stg_oulad_student_assessment__dbt_backup`
        ("assessment_id", "student_id", "date_submitted", "is_banked", "score") 

-- Standardize names and types for student assessment
select
  cast(id_assessment  as Nullable(Int64)) as assessment_id,
  cast(id_student     as Nullable(Int64)) as student_id,
  cast(date_submitted as Nullable(Int64)) as date_submitted,
  cast(is_banked      as Nullable(Int64)) as is_banked,
  cast(score          as Nullable(Int64)) as score
from `raw`.`grp5_oulad___student_assessment`
  ...
[0m15:55:44.883985 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.35 seconds
[0m15:55:44.886405 [debug] [Thread-1  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_module_presentation"} */

            

    
        create table `sandbox`.`grp5_oulad_dim_module_presentation`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Dimension table for module + presentation (simple, with Nullable types)
select
    cast(code_module as Nullable(String))       as code_module,
    cast(code_presentation as Nullable(String)) as code_presentation,
    cast(length as Nullable(Int32))             as length_days
from `clean`.`grp5_stg_oulad_courses`
          )
        
        
[0m15:55:44.895982 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_student: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_student"} */

    select name, type from system.columns where table = 'grp5_oulad_dim_student'
    
      and database = 'sandbox'
    
    order by position
  ...
[0m15:55:44.913539 [debug] [Thread-1  ]: Database Error in model grp5_oulad_dim_module_presentation (models/mart/grp5_oulad_dim_module_presentation.sql)
  HTTPDriver for http://54.87.106.52:8123 received ClickHouse error code 47
   Code: 47. DB::Exception: Missing columns: 'length' while processing query: 'SELECT CAST(code_module, 'Nullable(String)') AS code_module, CAST(code_presentation, 'Nullable(String)') AS code_presentation, CAST(length, 'Nullable(Int32)') AS length_days FROM clean.grp5_stg_oulad_courses', required columns: 'code_module' 'length' 'code_presentation', maybe you meant: 'code_module' or 'code_presentation'. (UNKNOWN_IDENTIFIER) (version 23.12.6.19 (official build))
[0m15:55:44.917504 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13858bfa-3a86-4ad3-a356-2e4082deefe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddfba03b9a0>]}
[0m15:55:44.919863 [error] [Thread-1  ]: 1 of 3 ERROR creating sql table model `sandbox`.`grp5_oulad_dim_module_presentation`  [[31mERROR[0m in 5.71s]
[0m15:55:44.922601 [debug] [Thread-1  ]: Finished running node model.ex_09_oulad.grp5_oulad_dim_module_presentation
[0m15:55:45.039114 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.41 seconds
[0m15:55:45.051688 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_assessment"} */
EXCHANGE TABLES `clean`.`grp5_stg_oulad_student_assessment__dbt_backup` AND `clean`.`grp5_stg_oulad_student_assessment` 
  
  ...
[0m15:55:45.251393 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.35 seconds
[0m15:55:45.256069 [debug] [Thread-2  ]: Writing runtime sql for node "model.ex_09_oulad.grp5_oulad_dim_student"
[0m15:55:45.260606 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_student: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_student"} */

  
    
    
    
        
         


        insert into `sandbox`.`grp5_oulad_dim_student`
        ("id_student", "gender", "age_band", "region", "highest_education", "imd_band", "disability")

-- Dimension table for students (no surrogate key)
select
    cast(id_student as Int64)               as id_student,
    cast(gender as Nullable(String))        as gender,
    cast(age_band as Nullable(String))      as age_band,
    cast(region as Nullable(String))        as region,
    cast(highest_education as Nullable(String)) as highest_education,
    cast(imd_band as Nullable(String))      as imd_band,
    cast(disability as Nullable(String))    as disability
from `clean`.`grp5_stg_oulad_student_info`
  ...
[0m15:55:45.378554 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.32 seconds
[0m15:55:45.568778 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_assessment"} */

    drop table if exists `clean`.`grp5_stg_oulad_student_assessment__dbt_backup` 
  ...
[0m15:55:45.629504 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.37 seconds
[0m15:55:45.645495 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13858bfa-3a86-4ad3-a356-2e4082deefe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddfbeb367f0>]}
[0m15:55:45.649181 [info ] [Thread-2  ]: 2 of 3 OK created sql table model `sandbox`.`grp5_oulad_dim_student` ........... [[32mOK[0m in 6.43s]
[0m15:55:45.653788 [debug] [Thread-2  ]: Finished running node model.ex_09_oulad.grp5_oulad_dim_student
[0m15:55:45.918300 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.35 seconds
[0m15:55:45.929055 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13858bfa-3a86-4ad3-a356-2e4082deefe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddfb904d9d0>]}
[0m15:55:45.932732 [info ] [Thread-3  ]: 3 of 3 OK created sql table model `clean`.`grp5_stg_oulad_student_assessment` .. [[32mOK[0m in 6.71s]
[0m15:55:45.935864 [debug] [Thread-3  ]: Finished running node model.ex_09_oulad.grp5_stg_oulad_student_assessment
[0m15:55:45.941091 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:55:45.942292 [debug] [MainThread]: Connection 'list__sandbox' was left open.
[0m15:55:45.944661 [debug] [MainThread]: On list__sandbox: Close
[0m15:55:45.945933 [debug] [MainThread]: Connection 'list__clean' was left open.
[0m15:55:45.947080 [debug] [MainThread]: On list__clean: Close
[0m15:55:45.948645 [debug] [MainThread]: Connection 'model.ex_09_oulad.grp5_oulad_dim_module_presentation' was left open.
[0m15:55:45.949742 [debug] [MainThread]: On model.ex_09_oulad.grp5_oulad_dim_module_presentation: Close
[0m15:55:45.950614 [debug] [MainThread]: Connection 'model.ex_09_oulad.grp5_oulad_dim_student' was left open.
[0m15:55:45.951577 [debug] [MainThread]: On model.ex_09_oulad.grp5_oulad_dim_student: Close
[0m15:55:45.952345 [debug] [MainThread]: Connection 'model.ex_09_oulad.grp5_stg_oulad_student_assessment' was left open.
[0m15:55:45.953044 [debug] [MainThread]: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: Close
[0m15:55:45.955702 [info ] [MainThread]: 
[0m15:55:45.957473 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 13.92 seconds (13.92s).
[0m15:55:45.961620 [debug] [MainThread]: Command end result
[0m15:55:46.054422 [info ] [MainThread]: 
[0m15:55:46.056113 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:55:46.057798 [info ] [MainThread]: 
[0m15:55:46.060340 [error] [MainThread]:   Database Error in model grp5_oulad_dim_module_presentation (models/mart/grp5_oulad_dim_module_presentation.sql)
  HTTPDriver for http://54.87.106.52:8123 received ClickHouse error code 47
   Code: 47. DB::Exception: Missing columns: 'length' while processing query: 'SELECT CAST(code_module, 'Nullable(String)') AS code_module, CAST(code_presentation, 'Nullable(String)') AS code_presentation, CAST(length, 'Nullable(Int32)') AS length_days FROM clean.grp5_stg_oulad_courses', required columns: 'code_module' 'length' 'code_presentation', maybe you meant: 'code_module' or 'code_presentation'. (UNKNOWN_IDENTIFIER) (version 23.12.6.19 (official build))
[0m15:55:46.062206 [info ] [MainThread]: 
[0m15:55:46.066620 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m15:55:46.072263 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 17.02775, "process_in_blocks": "80544", "process_kernel_time": 2.455783, "process_mem_max_rss": "115712", "process_out_blocks": "10544", "process_user_time": 8.851285}
[0m15:55:46.074635 [debug] [MainThread]: Command `dbt build` failed at 15:55:46.073872 after 17.03 seconds
[0m15:55:46.077292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddfbf59a310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddfbd4c4400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddfba3bbf70>]}
[0m15:55:46.080085 [debug] [MainThread]: Flushing usage events
[0m16:02:22.652474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c149688310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c1462ecaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c1462ec9a0>]}


============================== 16:02:22.670083 | ab9271c6-35b3-4f66-b602-53f55735916d ==============================
[0m16:02:22.670083 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:02:22.672609 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'debug': 'False', 'cache_selected_only': 'False', 'empty': 'False', 'static_parser': 'True', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'version_check': 'True', 'log_path': '/workdir/transforms/09_oulad/logs', 'use_colors': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt build --profiles-dir . --target remote', 'write_json': 'True', 'introspect': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'no_print': 'None', 'printer_width': '80'}
[0m16:02:23.073637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ab9271c6-35b3-4f66-b602-53f55735916d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c14be52880>]}
[0m16:02:23.186893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ab9271c6-35b3-4f66-b602-53f55735916d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c146153af0>]}
[0m16:02:23.189755 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m16:02:23.421805 [debug] [MainThread]: checksum: 265ce5244aff672775eaff93c261d21692ed3f5650f4d9e918c76acdb0e9479a, vars: {}, profile: , target: remote, version: 1.8.9
[0m16:02:19.876807 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:02:19.878209 [debug] [MainThread]: Partial parsing: updated file: ex_09_oulad://models/mart/grp5_oulad_dim_module_presentation.sql
[0m16:02:20.650903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ab9271c6-35b3-4f66-b602-53f55735916d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c1447ce130>]}
[0m16:02:21.020282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ab9271c6-35b3-4f66-b602-53f55735916d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c1460ea1c0>]}
[0m16:02:21.022555 [info ] [MainThread]: Found 3 models, 3 sources, 471 macros
[0m16:02:21.029281 [info ] [MainThread]: 
[0m16:02:21.032375 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m16:02:21.057290 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m16:02:21.070640 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m16:02:21.117873 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:02:21.119360 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:02:25.848008 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m16:02:26.169439 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.32 seconds
[0m16:02:26.388721 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m16:02:27.077665 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.69 seconds
[0m16:02:27.085683 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__clean)
[0m16:02:27.099029 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__sandbox)
[0m16:02:27.122791 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list__clean"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'clean'
      

  ...
[0m16:02:27.128714 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__sandbox: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list__sandbox"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'sandbox'
      

  ...
[0m16:02:27.433983 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.30 seconds
[0m16:02:27.920684 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.79 seconds
[0m16:02:28.045125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab9271c6-35b3-4f66-b602-53f55735916d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c14751f580>]}
[0m16:02:28.048488 [info ] [MainThread]: Concurrency: 4 threads (target='remote')
[0m16:02:28.050510 [info ] [MainThread]: 
[0m16:02:28.084983 [debug] [Thread-1  ]: Began running node model.ex_09_oulad.grp5_oulad_dim_module_presentation
[0m16:02:28.087415 [debug] [Thread-2  ]: Began running node model.ex_09_oulad.grp5_oulad_dim_student
[0m16:02:28.091853 [debug] [Thread-3  ]: Began running node model.ex_09_oulad.grp5_stg_oulad_student_assessment
[0m16:02:28.089970 [info ] [Thread-1  ]: 1 of 3 START sql table model `sandbox`.`grp5_oulad_dim_module_presentation` .... [RUN]
[0m16:02:28.094909 [info ] [Thread-2  ]: 2 of 3 START sql table model `sandbox`.`grp5_oulad_dim_student` ................ [RUN]
[0m16:02:28.098069 [info ] [Thread-3  ]: 3 of 3 START sql table model `clean`.`grp5_stg_oulad_student_assessment` ....... [RUN]
[0m16:02:28.101621 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.ex_09_oulad.grp5_oulad_dim_module_presentation'
[0m16:02:28.105153 [debug] [Thread-2  ]: Acquiring new clickhouse connection 'model.ex_09_oulad.grp5_oulad_dim_student'
[0m16:02:28.107470 [debug] [Thread-3  ]: Acquiring new clickhouse connection 'model.ex_09_oulad.grp5_stg_oulad_student_assessment'
[0m16:02:28.109375 [debug] [Thread-1  ]: Began compiling node model.ex_09_oulad.grp5_oulad_dim_module_presentation
[0m16:02:28.112199 [debug] [Thread-2  ]: Began compiling node model.ex_09_oulad.grp5_oulad_dim_student
[0m16:02:28.115403 [debug] [Thread-3  ]: Began compiling node model.ex_09_oulad.grp5_stg_oulad_student_assessment
[0m16:02:28.164764 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_09_oulad.grp5_oulad_dim_module_presentation"
[0m16:02:28.171645 [debug] [Thread-2  ]: Writing injected SQL for node "model.ex_09_oulad.grp5_oulad_dim_student"
[0m16:02:28.187585 [debug] [Thread-3  ]: Writing injected SQL for node "model.ex_09_oulad.grp5_stg_oulad_student_assessment"
[0m16:02:28.191254 [debug] [Thread-1  ]: Began executing node model.ex_09_oulad.grp5_oulad_dim_module_presentation
[0m16:02:28.193064 [debug] [Thread-2  ]: Began executing node model.ex_09_oulad.grp5_oulad_dim_student
[0m16:02:28.194763 [debug] [Thread-3  ]: Began executing node model.ex_09_oulad.grp5_stg_oulad_student_assessment
[0m16:02:28.363526 [debug] [Thread-1  ]: Creating new relation grp5_oulad_dim_module_presentation
[0m16:02:28.617988 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m16:02:28.623039 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m16:02:28.616274 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:02:32.946110 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_module_presentation: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_module_presentation"} */

            

    
        create table `sandbox`.`grp5_oulad_dim_module_presentation`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Dimension table for module + presentation (simple, with Nullable types)
select
    cast(code_module as Nullable(String))                           as code_module,
    cast(code_presentation as Nullable(String))                     as code_presentation,
    cast(module_presentation_length as Nullable(Int32))             as length_days
from `clean`.`grp5_stg_oulad_courses`
          )
        
        ...
[0m16:02:33.294041 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.34 seconds
[0m16:02:33.347078 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_module_presentation: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_module_presentation"} */

    select name, type from system.columns where table = 'grp5_oulad_dim_module_presentation'
    
      and database = 'sandbox'
    
    order by position
  ...
[0m16:02:33.698630 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.35 seconds
[0m16:02:33.707660 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_09_oulad.grp5_oulad_dim_module_presentation"
[0m16:02:33.709951 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_module_presentation: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_module_presentation"} */

  
    
    
    
        
         


        insert into `sandbox`.`grp5_oulad_dim_module_presentation`
        ("code_module", "code_presentation", "length_days")

-- Dimension table for module + presentation (simple, with Nullable types)
select
    cast(code_module as Nullable(String))                           as code_module,
    cast(code_presentation as Nullable(String))                     as code_presentation,
    cast(module_presentation_length as Nullable(Int32))             as length_days
from `clean`.`grp5_stg_oulad_courses`
  ...
[0m16:02:33.784735 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_assessment"} */

            

    
        create table `clean`.`grp5_stg_oulad_student_assessment__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
             

-- Standardize names and types for student assessment
select
  cast(id_assessment  as Nullable(Int64)) as assessment_id,
  cast(id_student     as Nullable(Int64)) as student_id,
  cast(date_submitted as Nullable(Int64)) as date_submitted,
  cast(is_banked      as Nullable(Int64)) as is_banked,
  cast(score          as Nullable(Int64)) as score
from `raw`.`grp5_oulad___student_assessment`
          )
        
        ...
[0m16:02:34.022189 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.31 seconds
[0m16:02:34.072941 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab9271c6-35b3-4f66-b602-53f55735916d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c144474370>]}
[0m16:02:34.074984 [info ] [Thread-1  ]: 1 of 3 OK created sql table model `sandbox`.`grp5_oulad_dim_module_presentation`  [[32mOK[0m in 5.97s]
[0m16:02:34.077325 [debug] [Thread-1  ]: Finished running node model.ex_09_oulad.grp5_oulad_dim_module_presentation
[0m16:02:34.119907 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.33 seconds
[0m16:02:34.124050 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_student: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_student"} */

            

    
        create table `sandbox`.`grp5_oulad_dim_student__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Dimension table for students (no surrogate key)
select
    cast(id_student as Int64)               as id_student,
    cast(gender as Nullable(String))        as gender,
    cast(age_band as Nullable(String))      as age_band,
    cast(region as Nullable(String))        as region,
    cast(highest_education as Nullable(String)) as highest_education,
    cast(imd_band as Nullable(String))      as imd_band,
    cast(disability as Nullable(String))    as disability
from `clean`.`grp5_stg_oulad_student_info`
          )
        
        ...
[0m16:02:36.795470 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_assessment"} */

    select name, type from system.columns where table = 'grp5_stg_oulad_student_assessment__dbt_backup'
    
      and database = 'clean'
    
    order by position
  ...
[0m16:02:34.311436 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in -2.49 seconds
[0m16:02:34.313575 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in -2.49 seconds
[0m16:02:34.325010 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_student: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_student"} */

    select name, type from system.columns where table = 'grp5_oulad_dim_student__dbt_backup'
    
      and database = 'sandbox'
    
    order by position
  ...
[0m16:02:34.329803 [debug] [Thread-3  ]: Writing runtime sql for node "model.ex_09_oulad.grp5_stg_oulad_student_assessment"
[0m16:02:34.335157 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_assessment"} */

  
    
    
    
        
         


        insert into `clean`.`grp5_stg_oulad_student_assessment__dbt_backup`
        ("assessment_id", "student_id", "date_submitted", "is_banked", "score") 

-- Standardize names and types for student assessment
select
  cast(id_assessment  as Nullable(Int64)) as assessment_id,
  cast(id_student     as Nullable(Int64)) as student_id,
  cast(date_submitted as Nullable(Int64)) as date_submitted,
  cast(is_banked      as Nullable(Int64)) as is_banked,
  cast(score          as Nullable(Int64)) as score
from `raw`.`grp5_oulad___student_assessment`
  ...
[0m16:02:34.629564 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.30 seconds
[0m16:02:34.633584 [debug] [Thread-2  ]: Writing runtime sql for node "model.ex_09_oulad.grp5_oulad_dim_student"
[0m16:02:34.636301 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_student: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_student"} */

  
    
    
    
        
         


        insert into `sandbox`.`grp5_oulad_dim_student__dbt_backup`
        ("id_student", "gender", "age_band", "region", "highest_education", "imd_band", "disability")

-- Dimension table for students (no surrogate key)
select
    cast(id_student as Int64)               as id_student,
    cast(gender as Nullable(String))        as gender,
    cast(age_band as Nullable(String))      as age_band,
    cast(region as Nullable(String))        as region,
    cast(highest_education as Nullable(String)) as highest_education,
    cast(imd_band as Nullable(String))      as imd_band,
    cast(disability as Nullable(String))    as disability
from `clean`.`grp5_stg_oulad_student_info`
  ...
[0m16:02:34.698528 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.36 seconds
[0m16:02:34.711565 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_assessment"} */
EXCHANGE TABLES `clean`.`grp5_stg_oulad_student_assessment__dbt_backup` AND `clean`.`grp5_stg_oulad_student_assessment` 
  
  ...
[0m16:02:34.957728 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.32 seconds
[0m16:02:34.961775 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_student: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_student"} */
EXCHANGE TABLES `sandbox`.`grp5_oulad_dim_student__dbt_backup` AND `sandbox`.`grp5_oulad_dim_student` 
  
  ...
[0m16:02:35.028699 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.31 seconds
[0m16:02:35.066273 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_assessment"} */

    drop table if exists `clean`.`grp5_stg_oulad_student_assessment__dbt_backup` 
  ...
[0m16:02:35.264475 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.30 seconds
[0m16:02:35.275083 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_student: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_student"} */

    drop table if exists `sandbox`.`grp5_oulad_dim_student__dbt_backup` 
  ...
[0m16:02:35.389627 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.32 seconds
[0m16:02:35.394217 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab9271c6-35b3-4f66-b602-53f55735916d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c145fd4460>]}
[0m16:02:35.396076 [info ] [Thread-3  ]: 3 of 3 OK created sql table model `clean`.`grp5_stg_oulad_student_assessment` .. [[32mOK[0m in 7.29s]
[0m16:02:35.400037 [debug] [Thread-3  ]: Finished running node model.ex_09_oulad.grp5_stg_oulad_student_assessment
[0m16:02:35.581242 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.30 seconds
[0m16:02:35.586174 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab9271c6-35b3-4f66-b602-53f55735916d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c143a20a30>]}
[0m16:02:35.588016 [info ] [Thread-2  ]: 2 of 3 OK created sql table model `sandbox`.`grp5_oulad_dim_student` ........... [[32mOK[0m in 7.48s]
[0m16:02:35.590361 [debug] [Thread-2  ]: Finished running node model.ex_09_oulad.grp5_oulad_dim_student
[0m16:02:35.594962 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:02:35.596105 [debug] [MainThread]: Connection 'list__clean' was left open.
[0m16:02:35.597302 [debug] [MainThread]: On list__clean: Close
[0m16:02:35.598355 [debug] [MainThread]: Connection 'list__sandbox' was left open.
[0m16:02:35.599989 [debug] [MainThread]: On list__sandbox: Close
[0m16:02:35.601458 [debug] [MainThread]: Connection 'model.ex_09_oulad.grp5_oulad_dim_module_presentation' was left open.
[0m16:02:35.602820 [debug] [MainThread]: On model.ex_09_oulad.grp5_oulad_dim_module_presentation: Close
[0m16:02:35.604077 [debug] [MainThread]: Connection 'model.ex_09_oulad.grp5_oulad_dim_student' was left open.
[0m16:02:35.605490 [debug] [MainThread]: On model.ex_09_oulad.grp5_oulad_dim_student: Close
[0m16:02:35.606788 [debug] [MainThread]: Connection 'model.ex_09_oulad.grp5_stg_oulad_student_assessment' was left open.
[0m16:02:35.608013 [debug] [MainThread]: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: Close
[0m16:02:35.610419 [info ] [MainThread]: 
[0m16:02:35.612193 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 14.58 seconds (14.58s).
[0m16:02:35.616370 [debug] [MainThread]: Command end result
[0m16:02:35.705582 [info ] [MainThread]: 
[0m16:02:35.707512 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:02:35.709477 [info ] [MainThread]: 
[0m16:02:35.711520 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:02:35.716425 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 17.239603, "process_in_blocks": "0", "process_kernel_time": 2.697066, "process_mem_max_rss": "115256", "process_out_blocks": "10568", "process_user_time": 8.228922}
[0m16:02:35.718338 [debug] [MainThread]: Command `dbt build` succeeded at 16:02:35.717834 after 17.24 seconds
[0m16:02:35.719610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c149688310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c147e3b1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c14751f640>]}
[0m16:02:35.721012 [debug] [MainThread]: Flushing usage events
[0m14:40:17.292980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7038d88b5310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7038d550e4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7038d550e640>]}


============================== 14:40:17.316269 | 26bc8ba5-fcf0-4104-bc97-31a22c881723 ==============================
[0m14:40:17.316269 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:40:17.320663 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt build --profiles-dir . --target remote', 'debug': 'False', 'write_json': 'True', 'quiet': 'False', 'log_path': '/workdir/transforms/09_oulad/logs', 'static_parser': 'True', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'printer_width': '80', 'cache_selected_only': 'False', 'log_format': 'default', 'target_path': 'None', 'empty': 'False', 'version_check': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'use_colors': 'True', 'partial_parse': 'True', 'profiles_dir': '.', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'warn_error': 'None', 'use_experimental_parser': 'False'}
[0m14:40:17.804928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '26bc8ba5-fcf0-4104-bc97-31a22c881723', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7038d7e4ab80>]}
[0m14:40:17.951632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '26bc8ba5-fcf0-4104-bc97-31a22c881723', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7038d8b1a2e0>]}
[0m14:40:17.954470 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m14:40:18.206539 [debug] [MainThread]: checksum: 265ce5244aff672775eaff93c261d21692ed3f5650f4d9e918c76acdb0e9479a, vars: {}, profile: , target: remote, version: 1.8.9
[0m14:40:19.939198 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:40:19.941261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '26bc8ba5-fcf0-4104-bc97-31a22c881723', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7038d67cb640>]}
[0m14:40:19.994981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '26bc8ba5-fcf0-4104-bc97-31a22c881723', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7038d51ae9a0>]}
[0m14:40:20.304941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '26bc8ba5-fcf0-4104-bc97-31a22c881723', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7038d38598e0>]}
[0m14:40:20.306295 [info ] [MainThread]: Found 4 models, 3 sources, 471 macros
[0m14:40:20.311285 [info ] [MainThread]: 
[0m14:40:20.313305 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m14:40:20.336310 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m14:40:20.338787 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m14:40:20.352866 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m14:40:20.383863 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:40:20.401368 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:40:20.402879 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:40:28.363127 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m14:40:28.693454 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m14:40:28.892735 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.53 seconds
[0m14:40:29.406547 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m14:40:29.408890 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.71 seconds
[0m14:40:30.005864 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.60 seconds
[0m14:40:30.014030 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__mart)
[0m14:40:30.016051 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__clean)
[0m14:40:30.018255 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__sandbox)
[0m14:40:30.036845 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list__mart"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'mart'
      

  ...
[0m14:40:30.045383 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list__clean"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'clean'
      

  ...
[0m14:40:30.051744 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__sandbox: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list__sandbox"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'sandbox'
      

  ...
[0m14:40:30.607793 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.55 seconds
[0m14:40:30.634869 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.58 seconds
[0m14:40:30.657403 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.60 seconds
[0m14:40:31.016182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26bc8ba5-fcf0-4104-bc97-31a22c881723', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7038d335cb50>]}
[0m14:40:31.017856 [info ] [MainThread]: Concurrency: 4 threads (target='remote')
[0m14:40:31.019049 [info ] [MainThread]: 
[0m14:40:31.051215 [debug] [Thread-1  ]: Began running node model.ex_09_oulad.grp5_oulad_dim_courses
[0m14:40:31.053339 [debug] [Thread-2  ]: Began running node model.ex_09_oulad.grp5_oulad_dim_module_presentation
[0m14:40:31.056983 [debug] [Thread-3  ]: Began running node model.ex_09_oulad.grp5_oulad_dim_student
[0m14:40:31.059086 [debug] [Thread-4  ]: Began running node model.ex_09_oulad.grp5_stg_oulad_student_assessment
[0m14:40:31.055419 [info ] [Thread-1  ]: 1 of 4 START sql table model `mart`.`grp5_oulad_dim_courses` ................... [RUN]
[0m14:40:31.061463 [info ] [Thread-2  ]: 2 of 4 START sql table model `sandbox`.`grp5_oulad_dim_module_presentation` .... [RUN]
[0m14:40:31.064399 [info ] [Thread-3  ]: 3 of 4 START sql table model `sandbox`.`grp5_oulad_dim_student` ................ [RUN]
[0m14:40:31.067400 [info ] [Thread-4  ]: 4 of 4 START sql table model `clean`.`grp5_stg_oulad_student_assessment` ....... [RUN]
[0m14:40:31.071013 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.ex_09_oulad.grp5_oulad_dim_courses'
[0m14:40:31.074071 [debug] [Thread-2  ]: Acquiring new clickhouse connection 'model.ex_09_oulad.grp5_oulad_dim_module_presentation'
[0m14:40:31.076619 [debug] [Thread-3  ]: Acquiring new clickhouse connection 'model.ex_09_oulad.grp5_oulad_dim_student'
[0m14:40:31.079948 [debug] [Thread-4  ]: Acquiring new clickhouse connection 'model.ex_09_oulad.grp5_stg_oulad_student_assessment'
[0m14:40:31.082588 [debug] [Thread-1  ]: Began compiling node model.ex_09_oulad.grp5_oulad_dim_courses
[0m14:40:31.084616 [debug] [Thread-2  ]: Began compiling node model.ex_09_oulad.grp5_oulad_dim_module_presentation
[0m14:40:31.087224 [debug] [Thread-3  ]: Began compiling node model.ex_09_oulad.grp5_oulad_dim_student
[0m14:40:31.089391 [debug] [Thread-4  ]: Began compiling node model.ex_09_oulad.grp5_stg_oulad_student_assessment
[0m14:40:31.134387 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_09_oulad.grp5_oulad_dim_courses"
[0m14:40:31.130386 [debug] [Thread-2  ]: Writing injected SQL for node "model.ex_09_oulad.grp5_oulad_dim_module_presentation"
[0m14:40:31.145372 [debug] [Thread-3  ]: Writing injected SQL for node "model.ex_09_oulad.grp5_oulad_dim_student"
[0m14:40:31.156321 [debug] [Thread-4  ]: Writing injected SQL for node "model.ex_09_oulad.grp5_stg_oulad_student_assessment"
[0m14:40:31.160362 [debug] [Thread-1  ]: Began executing node model.ex_09_oulad.grp5_oulad_dim_courses
[0m14:40:31.162045 [debug] [Thread-2  ]: Began executing node model.ex_09_oulad.grp5_oulad_dim_module_presentation
[0m14:40:31.164245 [debug] [Thread-3  ]: Began executing node model.ex_09_oulad.grp5_oulad_dim_student
[0m14:40:31.177663 [debug] [Thread-4  ]: Began executing node model.ex_09_oulad.grp5_stg_oulad_student_assessment
[0m14:40:31.389941 [debug] [Thread-3  ]: Creating new relation grp5_oulad_dim_student
[0m14:40:31.920570 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m14:40:31.939855 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m14:40:31.943552 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m14:40:31.946225 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m14:40:37.953435 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_assessment"} */

            

    
        create table `clean`.`grp5_stg_oulad_student_assessment__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
             

-- Standardize names and types for student assessment
select
  cast(id_assessment  as Nullable(Int64)) as assessment_id,
  cast(id_student     as Nullable(Int64)) as student_id,
  cast(date_submitted as Nullable(Int64)) as date_submitted,
  cast(is_banked      as Nullable(Int64)) as is_banked,
  cast(score          as Nullable(Int64)) as score
from `raw`.`grp5_oulad___student_assessment`
          )
        
        ...
[0m14:40:38.055483 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_courses: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_courses"} */

            

    
        create table `mart`.`grp5_oulad_dim_courses__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

select
    concat(cast(code_module as Nullable(String)), '_', cast(code_presentation as Nullable(String))) 
        as id_course,
    cast(code_module as Nullable(String))                           as code_module,
    cast(code_presentation as Nullable(String))                     as code_presentation,
    cast(module_presentation_length as Nullable(Int32))             as module_presentation_length
from `clean`.`grp5_stg_oulad_courses`
          )
        
        ...
[0m14:40:38.421856 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.47 seconds
[0m14:40:38.445274 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_assessment"} */

    select name, type from system.columns where table = 'grp5_stg_oulad_student_assessment__dbt_backup'
    
      and database = 'clean'
    
    order by position
  ...
[0m14:40:38.508025 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.45 seconds
[0m14:40:38.519893 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_courses: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_courses"} */

    select name, type from system.columns where table = 'grp5_oulad_dim_courses__dbt_backup'
    
      and database = 'mart'
    
    order by position
  ...
[0m14:40:39.165406 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.72 seconds
[0m14:40:39.174776 [debug] [Thread-4  ]: Writing runtime sql for node "model.ex_09_oulad.grp5_stg_oulad_student_assessment"
[0m14:40:39.176917 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_assessment"} */

  
    
    
    
        
         


        insert into `clean`.`grp5_stg_oulad_student_assessment__dbt_backup`
        ("assessment_id", "student_id", "date_submitted", "is_banked", "score") 

-- Standardize names and types for student assessment
select
  cast(id_assessment  as Nullable(Int64)) as assessment_id,
  cast(id_student     as Nullable(Int64)) as student_id,
  cast(date_submitted as Nullable(Int64)) as date_submitted,
  cast(is_banked      as Nullable(Int64)) as is_banked,
  cast(score          as Nullable(Int64)) as score
from `raw`.`grp5_oulad___student_assessment`
  ...
[0m14:40:39.185062 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.66 seconds
[0m14:40:39.191380 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_09_oulad.grp5_oulad_dim_courses"
[0m14:40:39.193951 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_courses: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_courses"} */

  
    
    
    
        
         


        insert into `mart`.`grp5_oulad_dim_courses__dbt_backup`
        ("id_course", "code_module", "code_presentation", "module_presentation_length")

select
    concat(cast(code_module as Nullable(String)), '_', cast(code_presentation as Nullable(String))) 
        as id_course,
    cast(code_module as Nullable(String))                           as code_module,
    cast(code_presentation as Nullable(String))                     as code_presentation,
    cast(module_presentation_length as Nullable(Int32))             as module_presentation_length
from `clean`.`grp5_stg_oulad_courses`
  ...
[0m14:40:39.199497 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_student: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_student"} */

            

    
        create table `sandbox`.`grp5_oulad_dim_student`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Dimension table for students (no surrogate key)
select
    cast(id_student as Int64)               as id_student,
    cast(gender as Nullable(String))        as gender,
    cast(age_band as Nullable(String))      as age_band,
    cast(region as Nullable(String))        as region,
    cast(highest_education as Nullable(String)) as highest_education,
    cast(imd_band as Nullable(String))      as imd_band,
    cast(disability as Nullable(String))    as disability
from `clean`.`grp5_stg_oulad_student_info`
          )
        
        ...
[0m14:40:39.701256 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.50 seconds
[0m14:40:39.711141 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_student: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_student"} */

    select name, type from system.columns where table = 'grp5_oulad_dim_student'
    
      and database = 'sandbox'
    
    order by position
  ...
[0m14:40:39.772659 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.59 seconds
[0m14:40:39.785507 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_assessment"} */
EXCHANGE TABLES `clean`.`grp5_stg_oulad_student_assessment__dbt_backup` AND `clean`.`grp5_stg_oulad_student_assessment` 
  
  ...
[0m14:40:40.199022 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.49 seconds
[0m14:40:40.203189 [debug] [Thread-3  ]: Writing runtime sql for node "model.ex_09_oulad.grp5_oulad_dim_student"
[0m14:40:40.205337 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_student: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_student"} */

  
    
    
    
        
         


        insert into `sandbox`.`grp5_oulad_dim_student`
        ("id_student", "gender", "age_band", "region", "highest_education", "imd_band", "disability")

-- Dimension table for students (no surrogate key)
select
    cast(id_student as Int64)               as id_student,
    cast(gender as Nullable(String))        as gender,
    cast(age_band as Nullable(String))      as age_band,
    cast(region as Nullable(String))        as region,
    cast(highest_education as Nullable(String)) as highest_education,
    cast(imd_band as Nullable(String))      as imd_band,
    cast(disability as Nullable(String))    as disability
from `clean`.`grp5_stg_oulad_student_info`
  ...
[0m14:40:40.277796 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.49 seconds
[0m14:40:40.370030 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_assessment"} */

    drop table if exists `clean`.`grp5_stg_oulad_student_assessment__dbt_backup` 
  ...
[0m14:40:40.712274 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.51 seconds
[0m14:40:40.723762 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26bc8ba5-fcf0-4104-bc97-31a22c881723', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7038d294eb80>]}
[0m14:40:40.726385 [info ] [Thread-3  ]: 3 of 4 OK created sql table model `sandbox`.`grp5_oulad_dim_student` ........... [[32mOK[0m in 9.65s]
[0m14:40:40.729470 [debug] [Thread-3  ]: Finished running node model.ex_09_oulad.grp5_oulad_dim_student
[0m14:40:40.823637 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.45 seconds
[0m14:40:40.831327 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26bc8ba5-fcf0-4104-bc97-31a22c881723', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7038d292beb0>]}
[0m14:40:40.834868 [info ] [Thread-4  ]: 4 of 4 OK created sql table model `clean`.`grp5_stg_oulad_student_assessment` .. [[32mOK[0m in 9.75s]
[0m14:40:40.837879 [debug] [Thread-4  ]: Finished running node model.ex_09_oulad.grp5_stg_oulad_student_assessment
[0m14:40:41.185933 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 1.98 seconds
[0m14:40:41.189956 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_courses: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_courses"} */
EXCHANGE TABLES `mart`.`grp5_oulad_dim_courses__dbt_backup` AND `mart`.`grp5_oulad_dim_courses` 
  
  ...
[0m14:40:41.612978 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_module_presentation: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_module_presentation"} */

            

    
        create table `sandbox`.`grp5_oulad_dim_module_presentation__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Dimension table for module + presentation (simple, with Nullable types)
select
    cast(code_module as Nullable(String))                           as code_module,
    cast(code_presentation as Nullable(String))                     as code_presentation,
    cast(module_presentation_length as Nullable(Int32))             as length_days
from `clean`.`grp5_stg_oulad_courses`
          )
        
        ...
[0m14:40:41.691460 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.50 seconds
[0m14:40:41.704846 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_courses: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_courses"} */

    drop table if exists `mart`.`grp5_oulad_dim_courses__dbt_backup` 
  ...
[0m14:40:42.100827 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.49 seconds
[0m14:40:42.108288 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_module_presentation: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_module_presentation"} */

    select name, type from system.columns where table = 'grp5_oulad_dim_module_presentation__dbt_backup'
    
      and database = 'sandbox'
    
    order by position
  ...
[0m14:40:42.547639 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.44 seconds
[0m14:40:42.555578 [debug] [Thread-2  ]: Writing runtime sql for node "model.ex_09_oulad.grp5_oulad_dim_module_presentation"
[0m14:40:42.558697 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_module_presentation: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_module_presentation"} */

  
    
    
    
        
         


        insert into `sandbox`.`grp5_oulad_dim_module_presentation__dbt_backup`
        ("code_module", "code_presentation", "length_days")

-- Dimension table for module + presentation (simple, with Nullable types)
select
    cast(code_module as Nullable(String))                           as code_module,
    cast(code_presentation as Nullable(String))                     as code_presentation,
    cast(module_presentation_length as Nullable(Int32))             as length_days
from `clean`.`grp5_stg_oulad_courses`
  ...
[0m14:40:42.912898 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 1.21 seconds
[0m14:40:42.925222 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26bc8ba5-fcf0-4104-bc97-31a22c881723', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7038d3531640>]}
[0m14:40:42.931220 [info ] [Thread-1  ]: 1 of 4 OK created sql table model `mart`.`grp5_oulad_dim_courses` .............. [[32mOK[0m in 11.85s]
[0m14:40:42.936643 [debug] [Thread-1  ]: Finished running node model.ex_09_oulad.grp5_oulad_dim_courses
[0m14:40:42.984150 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.42 seconds
[0m14:40:42.995083 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_module_presentation: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_module_presentation"} */
EXCHANGE TABLES `sandbox`.`grp5_oulad_dim_module_presentation__dbt_backup` AND `sandbox`.`grp5_oulad_dim_module_presentation` 
  
  ...
[0m14:40:43.439975 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.44 seconds
[0m14:40:43.452381 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_module_presentation: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_module_presentation"} */

    drop table if exists `sandbox`.`grp5_oulad_dim_module_presentation__dbt_backup` 
  ...
[0m14:40:44.031684 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.58 seconds
[0m14:40:44.036314 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26bc8ba5-fcf0-4104-bc97-31a22c881723', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7038d354b100>]}
[0m14:40:44.039395 [info ] [Thread-2  ]: 2 of 4 OK created sql table model `sandbox`.`grp5_oulad_dim_module_presentation`  [[32mOK[0m in 12.96s]
[0m14:40:44.043291 [debug] [Thread-2  ]: Finished running node model.ex_09_oulad.grp5_oulad_dim_module_presentation
[0m14:40:44.049791 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:40:44.051080 [debug] [MainThread]: Connection 'list__mart' was left open.
[0m14:40:44.052312 [debug] [MainThread]: On list__mart: Close
[0m14:40:44.053326 [debug] [MainThread]: Connection 'list__clean' was left open.
[0m14:40:44.054254 [debug] [MainThread]: On list__clean: Close
[0m14:40:44.055112 [debug] [MainThread]: Connection 'list__sandbox' was left open.
[0m14:40:44.055926 [debug] [MainThread]: On list__sandbox: Close
[0m14:40:44.056819 [debug] [MainThread]: Connection 'model.ex_09_oulad.grp5_oulad_dim_courses' was left open.
[0m14:40:44.058170 [debug] [MainThread]: On model.ex_09_oulad.grp5_oulad_dim_courses: Close
[0m14:40:44.059487 [debug] [MainThread]: Connection 'model.ex_09_oulad.grp5_oulad_dim_module_presentation' was left open.
[0m14:40:44.060486 [debug] [MainThread]: On model.ex_09_oulad.grp5_oulad_dim_module_presentation: Close
[0m14:40:44.061423 [debug] [MainThread]: Connection 'model.ex_09_oulad.grp5_oulad_dim_student' was left open.
[0m14:40:44.062246 [debug] [MainThread]: On model.ex_09_oulad.grp5_oulad_dim_student: Close
[0m14:40:44.063592 [debug] [MainThread]: Connection 'model.ex_09_oulad.grp5_stg_oulad_student_assessment' was left open.
[0m14:40:44.066369 [debug] [MainThread]: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: Close
[0m14:40:44.069699 [info ] [MainThread]: 
[0m14:40:44.072143 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 23.76 seconds (23.76s).
[0m14:40:44.077303 [debug] [MainThread]: Command end result
[0m14:40:44.168699 [info ] [MainThread]: 
[0m14:40:44.170270 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:40:44.172367 [info ] [MainThread]: 
[0m14:40:44.174729 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m14:40:44.181917 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 29.193853, "process_in_blocks": "80568", "process_kernel_time": 2.706727, "process_mem_max_rss": "117364", "process_out_blocks": "10504", "process_user_time": 11.665245}
[0m14:40:44.185079 [debug] [MainThread]: Command `dbt build` succeeded at 14:40:44.183896 after 29.20 seconds
[0m14:40:44.188638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7038d88b5310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7038d35497c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7038d3549a00>]}
[0m14:40:44.191934 [debug] [MainThread]: Flushing usage events
[0m15:50:49.645881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63768b0dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6373516490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63735165e0>]}


============================== 15:50:49.664435 | 7dbd90b1-967d-438c-ab81-77589c022e89 ==============================
[0m15:50:49.664435 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:50:49.667365 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'debug': 'False', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'write_json': 'True', 'warn_error': 'None', 'partial_parse': 'True', 'target_path': 'None', 'no_print': 'None', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'fail_fast': 'False', 'log_format': 'default', 'log_path': '/workdir/transforms/09_oulad/logs', 'empty': 'False', 'use_colors': 'True', 'invocation_command': 'dbt build --profiles-dir . --target remote', 'log_cache_events': 'False', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'quiet': 'False'}
[0m15:50:50.069721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7dbd90b1-967d-438c-ab81-77589c022e89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63733f6af0>]}
[0m15:50:50.185962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7dbd90b1-967d-438c-ab81-77589c022e89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f637396fc10>]}
[0m15:50:50.188885 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m15:50:50.417984 [debug] [MainThread]: checksum: 265ce5244aff672775eaff93c261d21692ed3f5650f4d9e918c76acdb0e9479a, vars: {}, profile: , target: remote, version: 1.8.9
[0m15:50:50.782465 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:50:50.783843 [debug] [MainThread]: Partial parsing: updated file: ex_09_oulad://models/mart/grp5_oulad_dim_courses.sql
[0m15:50:51.323168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7dbd90b1-967d-438c-ab81-77589c022e89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6371a0eee0>]}
[0m15:50:51.612347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7dbd90b1-967d-438c-ab81-77589c022e89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63718d53a0>]}
[0m15:50:51.613630 [info ] [MainThread]: Found 4 models, 3 sources, 471 macros
[0m15:50:51.619429 [info ] [MainThread]: 
[0m15:50:51.621791 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m15:50:51.640743 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m15:50:51.642906 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m15:50:51.650941 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m15:50:51.689798 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:51.702573 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:51.704752 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:57.653188 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m15:50:57.656355 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m15:50:57.660710 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m15:50:55.743737 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in -1.91 seconds
[0m15:50:55.747070 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in -1.92 seconds
[0m15:50:55.749518 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in -1.92 seconds
[0m15:50:55.914331 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__mart)
[0m15:50:55.916467 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__clean)
[0m15:50:55.925161 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__sandbox)
[0m15:50:55.938701 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list__mart"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'mart'
      

  ...
[0m15:50:55.946112 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list__clean"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'clean'
      

  ...
[0m15:50:55.953775 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__sandbox: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list__sandbox"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'sandbox'
      

  ...
[0m15:50:56.387823 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.43 seconds
[0m15:50:56.405539 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.45 seconds
[0m15:50:56.427562 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.47 seconds
[0m15:50:56.804298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7dbd90b1-967d-438c-ab81-77589c022e89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63713a5d30>]}
[0m15:50:56.806090 [info ] [MainThread]: Concurrency: 4 threads (target='remote')
[0m15:50:56.807304 [info ] [MainThread]: 
[0m15:50:56.836947 [debug] [Thread-1  ]: Began running node model.ex_09_oulad.grp5_oulad_dim_courses
[0m15:50:56.839948 [debug] [Thread-2  ]: Began running node model.ex_09_oulad.grp5_oulad_dim_module_presentation
[0m15:50:56.842385 [debug] [Thread-3  ]: Began running node model.ex_09_oulad.grp5_oulad_dim_student
[0m15:50:56.844753 [debug] [Thread-4  ]: Began running node model.ex_09_oulad.grp5_stg_oulad_student_assessment
[0m15:50:56.847096 [info ] [Thread-1  ]: 1 of 4 START sql table model `mart`.`grp5_oulad_dim_courses` ................... [RUN]
[0m15:50:56.849904 [info ] [Thread-2  ]: 2 of 4 START sql table model `sandbox`.`grp5_oulad_dim_module_presentation` .... [RUN]
[0m15:50:56.853102 [info ] [Thread-3  ]: 3 of 4 START sql table model `sandbox`.`grp5_oulad_dim_student` ................ [RUN]
[0m15:50:56.857048 [info ] [Thread-4  ]: 4 of 4 START sql table model `clean`.`grp5_stg_oulad_student_assessment` ....... [RUN]
[0m15:50:56.861125 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.ex_09_oulad.grp5_oulad_dim_courses'
[0m15:50:56.863834 [debug] [Thread-2  ]: Acquiring new clickhouse connection 'model.ex_09_oulad.grp5_oulad_dim_module_presentation'
[0m15:50:56.867078 [debug] [Thread-3  ]: Acquiring new clickhouse connection 'model.ex_09_oulad.grp5_oulad_dim_student'
[0m15:50:56.871784 [debug] [Thread-4  ]: Acquiring new clickhouse connection 'model.ex_09_oulad.grp5_stg_oulad_student_assessment'
[0m15:50:56.875172 [debug] [Thread-1  ]: Began compiling node model.ex_09_oulad.grp5_oulad_dim_courses
[0m15:50:56.877777 [debug] [Thread-2  ]: Began compiling node model.ex_09_oulad.grp5_oulad_dim_module_presentation
[0m15:50:56.880455 [debug] [Thread-3  ]: Began compiling node model.ex_09_oulad.grp5_oulad_dim_student
[0m15:50:56.882488 [debug] [Thread-4  ]: Began compiling node model.ex_09_oulad.grp5_stg_oulad_student_assessment
[0m15:50:56.930535 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_09_oulad.grp5_oulad_dim_courses"
[0m15:50:56.933237 [debug] [Thread-2  ]: Writing injected SQL for node "model.ex_09_oulad.grp5_oulad_dim_module_presentation"
[0m15:50:56.946862 [debug] [Thread-3  ]: Writing injected SQL for node "model.ex_09_oulad.grp5_oulad_dim_student"
[0m15:50:56.958554 [debug] [Thread-4  ]: Writing injected SQL for node "model.ex_09_oulad.grp5_stg_oulad_student_assessment"
[0m15:50:56.962714 [debug] [Thread-1  ]: Began executing node model.ex_09_oulad.grp5_oulad_dim_courses
[0m15:50:56.965380 [debug] [Thread-2  ]: Began executing node model.ex_09_oulad.grp5_oulad_dim_module_presentation
[0m15:50:56.966933 [debug] [Thread-3  ]: Began executing node model.ex_09_oulad.grp5_oulad_dim_student
[0m15:50:56.981251 [debug] [Thread-4  ]: Began executing node model.ex_09_oulad.grp5_stg_oulad_student_assessment
[0m15:50:57.501427 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m15:50:57.503606 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m15:50:57.505568 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m15:50:57.496995 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m15:51:02.501568 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_student: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_student"} */

            

    
        create table `sandbox`.`grp5_oulad_dim_student__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Dimension table for students (no surrogate key)
select
    cast(id_student as Int64)               as id_student,
    cast(gender as Nullable(String))        as gender,
    cast(age_band as Nullable(String))      as age_band,
    cast(region as Nullable(String))        as region,
    cast(highest_education as Nullable(String)) as highest_education,
    cast(imd_band as Nullable(String))      as imd_band,
    cast(disability as Nullable(String))    as disability
from `clean`.`grp5_stg_oulad_student_info`
          )
        
        ...
[0m15:51:02.744901 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_assessment"} */

            

    
        create table `clean`.`grp5_stg_oulad_student_assessment__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
             

-- Standardize names and types for student assessment
select
  cast(id_assessment  as Nullable(Int64)) as assessment_id,
  cast(id_student     as Nullable(Int64)) as student_id,
  cast(date_submitted as Nullable(Int64)) as date_submitted,
  cast(is_banked      as Nullable(Int64)) as is_banked,
  cast(score          as Nullable(Int64)) as score
from `raw`.`grp5_oulad___student_assessment`
          )
        
        ...
[0m15:51:02.750866 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_module_presentation: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_module_presentation"} */

            

    
        create table `sandbox`.`grp5_oulad_dim_module_presentation__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Dimension table for module + presentation (simple, with Nullable types)
select
    cast(code_module as Nullable(String))                           as code_module,
    cast(code_presentation as Nullable(String))                     as code_presentation,
    cast(module_presentation_length as Nullable(Int32))             as length_days
from `clean`.`grp5_stg_oulad_courses`
          )
        
        ...
[0m15:51:02.952488 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.45 seconds
[0m15:51:02.985278 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_student: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_student"} */

    select name, type from system.columns where table = 'grp5_oulad_dim_student__dbt_backup'
    
      and database = 'sandbox'
    
    order by position
  ...
[0m15:51:03.182238 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_courses: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_courses"} */

            

    
        create table `mart`.`grp5_oulad_dim_courses__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

select
    concat(cast(code_module as Nullable(String)), cast(code_presentation as Nullable(String))) 
        as id_course,
    cast(code_module as Nullable(String))                           as code_module,
    cast(code_presentation as Nullable(String))                     as code_presentation,
    cast(module_presentation_length as Nullable(Int32))             as module_presentation_length
from `clean`.`grp5_stg_oulad_courses`
          )
        
        ...
[0m15:51:03.214393 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.45 seconds
[0m15:51:03.223278 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.47 seconds
[0m15:51:03.249700 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_assessment"} */

    select name, type from system.columns where table = 'grp5_stg_oulad_student_assessment__dbt_backup'
    
      and database = 'clean'
    
    order by position
  ...
[0m15:51:03.252091 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_module_presentation: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_module_presentation"} */

    select name, type from system.columns where table = 'grp5_oulad_dim_module_presentation__dbt_backup'
    
      and database = 'sandbox'
    
    order by position
  ...
[0m15:51:03.394525 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.41 seconds
[0m15:51:03.421581 [debug] [Thread-3  ]: Writing runtime sql for node "model.ex_09_oulad.grp5_oulad_dim_student"
[0m15:51:03.427335 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_student: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_student"} */

  
    
    
    
        
         


        insert into `sandbox`.`grp5_oulad_dim_student__dbt_backup`
        ("id_student", "gender", "age_band", "region", "highest_education", "imd_band", "disability")

-- Dimension table for students (no surrogate key)
select
    cast(id_student as Int64)               as id_student,
    cast(gender as Nullable(String))        as gender,
    cast(age_band as Nullable(String))      as age_band,
    cast(region as Nullable(String))        as region,
    cast(highest_education as Nullable(String)) as highest_education,
    cast(imd_band as Nullable(String))      as imd_band,
    cast(disability as Nullable(String))    as disability
from `clean`.`grp5_stg_oulad_student_info`
  ...
[0m15:51:03.608869 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.42 seconds
[0m15:51:03.616645 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_courses: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_courses"} */

    select name, type from system.columns where table = 'grp5_oulad_dim_courses__dbt_backup'
    
      and database = 'mart'
    
    order by position
  ...
[0m15:51:03.684711 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.43 seconds
[0m15:51:03.687596 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.43 seconds
[0m15:51:03.692944 [debug] [Thread-2  ]: Writing runtime sql for node "model.ex_09_oulad.grp5_oulad_dim_module_presentation"
[0m15:51:03.697757 [debug] [Thread-4  ]: Writing runtime sql for node "model.ex_09_oulad.grp5_stg_oulad_student_assessment"
[0m15:51:03.700442 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_assessment"} */

  
    
    
    
        
         


        insert into `clean`.`grp5_stg_oulad_student_assessment__dbt_backup`
        ("assessment_id", "student_id", "date_submitted", "is_banked", "score") 

-- Standardize names and types for student assessment
select
  cast(id_assessment  as Nullable(Int64)) as assessment_id,
  cast(id_student     as Nullable(Int64)) as student_id,
  cast(date_submitted as Nullable(Int64)) as date_submitted,
  cast(is_banked      as Nullable(Int64)) as is_banked,
  cast(score          as Nullable(Int64)) as score
from `raw`.`grp5_oulad___student_assessment`
  ...
[0m15:51:03.702088 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_module_presentation: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_module_presentation"} */

  
    
    
    
        
         


        insert into `sandbox`.`grp5_oulad_dim_module_presentation__dbt_backup`
        ("code_module", "code_presentation", "length_days")

-- Dimension table for module + presentation (simple, with Nullable types)
select
    cast(code_module as Nullable(String))                           as code_module,
    cast(code_presentation as Nullable(String))                     as code_presentation,
    cast(module_presentation_length as Nullable(Int32))             as length_days
from `clean`.`grp5_stg_oulad_courses`
  ...
[0m15:51:03.935629 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.50 seconds
[0m15:51:03.952474 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_student: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_student"} */
EXCHANGE TABLES `sandbox`.`grp5_oulad_dim_student__dbt_backup` AND `sandbox`.`grp5_oulad_dim_student` 
  
  ...
[0m15:51:04.053247 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.44 seconds
[0m15:51:04.057604 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_09_oulad.grp5_oulad_dim_courses"
[0m15:51:04.059310 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_courses: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_courses"} */

  
    
    
    
        
         


        insert into `mart`.`grp5_oulad_dim_courses__dbt_backup`
        ("id_course", "code_module", "code_presentation", "module_presentation_length")

select
    concat(cast(code_module as Nullable(String)), cast(code_presentation as Nullable(String))) 
        as id_course,
    cast(code_module as Nullable(String))                           as code_module,
    cast(code_presentation as Nullable(String))                     as code_presentation,
    cast(module_presentation_length as Nullable(Int32))             as module_presentation_length
from `clean`.`grp5_stg_oulad_courses`
  ...
[0m15:51:04.171975 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.47 seconds
[0m15:51:04.175458 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_module_presentation: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_module_presentation"} */
EXCHANGE TABLES `sandbox`.`grp5_oulad_dim_module_presentation__dbt_backup` AND `sandbox`.`grp5_oulad_dim_module_presentation` 
  
  ...
[0m15:51:04.264400 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.56 seconds
[0m15:51:04.268172 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_assessment"} */
EXCHANGE TABLES `clean`.`grp5_stg_oulad_student_assessment__dbt_backup` AND `clean`.`grp5_stg_oulad_student_assessment` 
  
  ...
[0m15:51:04.373435 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.42 seconds
[0m15:51:04.434776 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_student: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_student"} */

    drop table if exists `sandbox`.`grp5_oulad_dim_student__dbt_backup` 
  ...
[0m15:51:04.486683 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.43 seconds
[0m15:51:04.490763 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_courses: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_courses"} */
EXCHANGE TABLES `mart`.`grp5_oulad_dim_courses__dbt_backup` AND `mart`.`grp5_oulad_dim_courses` 
  
  ...
[0m15:51:04.610789 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.43 seconds
[0m15:51:04.620862 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_module_presentation: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_module_presentation"} */

    drop table if exists `sandbox`.`grp5_oulad_dim_module_presentation__dbt_backup` 
  ...
[0m15:51:04.702671 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.43 seconds
[0m15:51:04.712160 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_assessment"} */

    drop table if exists `clean`.`grp5_stg_oulad_student_assessment__dbt_backup` 
  ...
[0m15:51:04.881158 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.44 seconds
[0m15:51:04.889968 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dbd90b1-967d-438c-ab81-77589c022e89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6372fb2100>]}
[0m15:51:04.891669 [info ] [Thread-3  ]: 3 of 4 OK created sql table model `sandbox`.`grp5_oulad_dim_student` ........... [[32mOK[0m in 8.02s]
[0m15:51:04.893790 [debug] [Thread-3  ]: Finished running node model.ex_09_oulad.grp5_oulad_dim_student
[0m15:51:04.921116 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.43 seconds
[0m15:51:04.931831 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_courses: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_courses"} */

    drop table if exists `mart`.`grp5_oulad_dim_courses__dbt_backup` 
  ...
[0m15:51:05.049431 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.43 seconds
[0m15:51:05.053613 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dbd90b1-967d-438c-ab81-77589c022e89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6370aa0970>]}
[0m15:51:05.055368 [info ] [Thread-2  ]: 2 of 4 OK created sql table model `sandbox`.`grp5_oulad_dim_module_presentation`  [[32mOK[0m in 8.19s]
[0m15:51:05.057595 [debug] [Thread-2  ]: Finished running node model.ex_09_oulad.grp5_oulad_dim_module_presentation
[0m15:51:05.131167 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.42 seconds
[0m15:51:05.135334 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dbd90b1-967d-438c-ab81-77589c022e89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6372d4a760>]}
[0m15:51:05.137003 [info ] [Thread-4  ]: 4 of 4 OK created sql table model `clean`.`grp5_stg_oulad_student_assessment` .. [[32mOK[0m in 8.26s]
[0m15:51:05.139028 [debug] [Thread-4  ]: Finished running node model.ex_09_oulad.grp5_stg_oulad_student_assessment
[0m15:51:05.331829 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.40 seconds
[0m15:51:05.336437 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dbd90b1-967d-438c-ab81-77589c022e89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63715a20a0>]}
[0m15:51:05.338214 [info ] [Thread-1  ]: 1 of 4 OK created sql table model `mart`.`grp5_oulad_dim_courses` .............. [[32mOK[0m in 8.48s]
[0m15:51:05.340799 [debug] [Thread-1  ]: Finished running node model.ex_09_oulad.grp5_oulad_dim_courses
[0m15:51:05.346786 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:51:05.348538 [debug] [MainThread]: Connection 'list__mart' was left open.
[0m15:51:05.350442 [debug] [MainThread]: On list__mart: Close
[0m15:51:05.351776 [debug] [MainThread]: Connection 'list__clean' was left open.
[0m15:51:05.353480 [debug] [MainThread]: On list__clean: Close
[0m15:51:05.354560 [debug] [MainThread]: Connection 'list__sandbox' was left open.
[0m15:51:05.355692 [debug] [MainThread]: On list__sandbox: Close
[0m15:51:05.357005 [debug] [MainThread]: Connection 'model.ex_09_oulad.grp5_oulad_dim_courses' was left open.
[0m15:51:05.358228 [debug] [MainThread]: On model.ex_09_oulad.grp5_oulad_dim_courses: Close
[0m15:51:05.359349 [debug] [MainThread]: Connection 'model.ex_09_oulad.grp5_oulad_dim_module_presentation' was left open.
[0m15:51:05.360757 [debug] [MainThread]: On model.ex_09_oulad.grp5_oulad_dim_module_presentation: Close
[0m15:51:05.362299 [debug] [MainThread]: Connection 'model.ex_09_oulad.grp5_oulad_dim_student' was left open.
[0m15:51:05.363550 [debug] [MainThread]: On model.ex_09_oulad.grp5_oulad_dim_student: Close
[0m15:51:05.364987 [debug] [MainThread]: Connection 'model.ex_09_oulad.grp5_stg_oulad_student_assessment' was left open.
[0m15:51:05.365930 [debug] [MainThread]: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: Close
[0m15:51:05.367752 [info ] [MainThread]: 
[0m15:51:05.370674 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 13.75 seconds (13.75s).
[0m15:51:05.378689 [debug] [MainThread]: Command end result
[0m15:51:05.473356 [info ] [MainThread]: 
[0m15:51:05.475060 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:51:05.476797 [info ] [MainThread]: 
[0m15:51:05.478439 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m15:51:05.482623 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 18.287523, "process_in_blocks": "75240", "process_kernel_time": 2.163894, "process_mem_max_rss": "116840", "process_out_blocks": "10504", "process_user_time": 7.385546}
[0m15:51:05.485376 [debug] [MainThread]: Command `dbt build` succeeded at 15:51:05.484531 after 18.29 seconds
[0m15:51:05.487499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63768b0dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f637134e160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6373e11220>]}
[0m15:51:05.489395 [debug] [MainThread]: Flushing usage events
[0m07:42:51.095579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7187bd04fe20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7187b9cc22b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7187b9cc2400>]}


============================== 07:42:51.113770 | 6865bbdd-99a7-4b31-9de2-3e3a7409cac9 ==============================
[0m07:42:51.113770 [info ] [MainThread]: Running with dbt=1.8.9
[0m07:42:51.115922 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'fail_fast': 'False', 'quiet': 'False', 'printer_width': '80', 'profiles_dir': '.', 'static_parser': 'True', 'invocation_command': 'dbt test --profiles-dir . --target remote', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'version_check': 'True', 'no_print': 'None', 'use_colors': 'True', 'log_cache_events': 'False', 'introspect': 'True', 'empty': 'None', 'warn_error': 'None', 'write_json': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/workdir/transforms/09_oulad/logs', 'debug': 'False', 'target_path': 'None'}
[0m07:42:51.645761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6865bbdd-99a7-4b31-9de2-3e3a7409cac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7187b9ba5eb0>]}
[0m07:42:51.798274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6865bbdd-99a7-4b31-9de2-3e3a7409cac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7187b9b508b0>]}
[0m07:42:51.801253 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m07:42:52.072894 [debug] [MainThread]: checksum: 265ce5244aff672775eaff93c261d21692ed3f5650f4d9e918c76acdb0e9479a, vars: {}, profile: , target: remote, version: 1.8.9
[0m07:42:52.533014 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m07:42:52.534340 [debug] [MainThread]: Partial parsing: added file: ex_09_oulad://models/clean/schema.yml
[0m07:42:52.535285 [debug] [MainThread]: Partial parsing: added file: ex_09_oulad://models/clean/grp5_stg_oulad_student_info.sql
[0m07:42:52.536423 [debug] [MainThread]: Partial parsing: updated file: ex_09_oulad://models/sources.yml
[0m07:42:53.480223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6865bbdd-99a7-4b31-9de2-3e3a7409cac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7187b7f65130>]}
[0m07:42:53.849289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6865bbdd-99a7-4b31-9de2-3e3a7409cac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7187b7d1d040>]}
[0m07:42:53.851138 [info ] [MainThread]: Found 5 models, 4 sources, 471 macros
[0m07:42:53.852575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6865bbdd-99a7-4b31-9de2-3e3a7409cac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7187b7ff3610>]}
[0m07:42:53.866463 [info ] [MainThread]: 
[0m07:42:53.870245 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:42:53.876310 [debug] [MainThread]: Command end result
[0m07:42:54.005649 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.0719037, "process_in_blocks": "75056", "process_kernel_time": 2.694235, "process_mem_max_rss": "106144", "process_out_blocks": "9568", "process_user_time": 7.965894}
[0m07:42:54.007262 [debug] [MainThread]: Command `dbt test` succeeded at 07:42:54.006913 after 3.07 seconds
[0m07:42:54.008261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7187bd04fe20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7187baeda100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7187b7cfd730>]}
[0m07:42:54.009503 [debug] [MainThread]: Flushing usage events
[0m07:45:38.858784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b7181c4310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b714e33310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b714e33460>]}


============================== 07:45:38.874924 | dba7aaad-00e7-4e4f-8dfb-a0a6dea86daf ==============================
[0m07:45:38.874924 [info ] [MainThread]: Running with dbt=1.8.9
[0m07:45:38.876916 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'fail_fast': 'False', 'empty': 'None', 'introspect': 'True', 'log_cache_events': 'False', 'write_json': 'True', 'warn_error': 'None', 'version_check': 'True', 'log_path': '/workdir/transforms/09_oulad/logs', 'quiet': 'False', 'indirect_selection': 'eager', 'log_format': 'default', 'partial_parse': 'True', 'profiles_dir': '.', 'use_colors': 'True', 'invocation_command': 'dbt test --profiles-dir . --target remote', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'cache_selected_only': 'False', 'no_print': 'None', 'use_experimental_parser': 'False'}
[0m07:45:39.292154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dba7aaad-00e7-4e4f-8dfb-a0a6dea86daf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b714d20910>]}
[0m07:45:39.419011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dba7aaad-00e7-4e4f-8dfb-a0a6dea86daf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b71615c250>]}
[0m07:45:39.420775 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m07:45:39.671944 [debug] [MainThread]: checksum: 265ce5244aff672775eaff93c261d21692ed3f5650f4d9e918c76acdb0e9479a, vars: {}, profile: , target: remote, version: 1.8.9
[0m07:45:39.973747 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:45:39.975105 [debug] [MainThread]: Partial parsing: updated file: ex_09_oulad://models/clean/schema.yml
[0m07:45:40.112445 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m07:45:40.114147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'dba7aaad-00e7-4e4f-8dfb-a0a6dea86daf', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b714584610>]}
[0m07:45:40.715190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dba7aaad-00e7-4e4f-8dfb-a0a6dea86daf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b71435b130>]}
[0m07:45:41.153764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dba7aaad-00e7-4e4f-8dfb-a0a6dea86daf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b713fe85b0>]}
[0m07:45:41.155289 [info ] [MainThread]: Found 5 models, 3 data tests, 4 sources, 471 macros
[0m07:45:41.156757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dba7aaad-00e7-4e4f-8dfb-a0a6dea86daf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b714237970>]}
[0m07:45:41.161771 [info ] [MainThread]: 
[0m07:45:41.164279 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m07:45:41.189761 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list__clean'
[0m07:45:41.205141 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list__mart'
[0m07:45:41.209456 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list__sandbox'
[0m07:45:41.280501 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:45:41.293883 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:45:41.299606 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:45:45.330766 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__sandbox: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list__sandbox"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'sandbox'
      

  ...
[0m07:45:45.612551 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.28 seconds
[0m07:45:46.601792 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list__mart"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'mart'
      

  ...
[0m07:45:46.846634 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list__clean"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'clean'
      

  ...
[0m07:45:47.224225 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.38 seconds
[0m07:45:47.489602 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.89 seconds
[0m07:45:47.655859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dba7aaad-00e7-4e4f-8dfb-a0a6dea86daf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b715954df0>]}
[0m07:45:47.657703 [info ] [MainThread]: Concurrency: 4 threads (target='remote')
[0m07:45:47.658731 [info ] [MainThread]: 
[0m07:45:47.686289 [debug] [Thread-1  ]: Began running node test.ex_09_oulad.accepted_values_grp5_stg_oulad_student_info_gender__M__F__Unknown.882027f822
[0m07:45:47.689166 [debug] [Thread-2  ]: Began running node test.ex_09_oulad.not_null_grp5_stg_oulad_student_info_id_student.1a2bfbb142
[0m07:45:47.691791 [debug] [Thread-3  ]: Began running node test.ex_09_oulad.unique_grp5_stg_oulad_student_info_id_student.9bf9337d34
[0m07:45:47.693543 [info ] [Thread-1  ]: 1 of 3 START test accepted_values_grp5_stg_oulad_student_info_gender__M__F__Unknown  [RUN]
[0m07:45:47.695867 [info ] [Thread-2  ]: 2 of 3 START test not_null_grp5_stg_oulad_student_info_id_student .............. [RUN]
[0m07:45:47.698620 [info ] [Thread-3  ]: 3 of 3 START test unique_grp5_stg_oulad_student_info_id_student ................ [RUN]
[0m07:45:47.701785 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'test.ex_09_oulad.accepted_values_grp5_stg_oulad_student_info_gender__M__F__Unknown.882027f822'
[0m07:45:47.705235 [debug] [Thread-2  ]: Acquiring new clickhouse connection 'test.ex_09_oulad.not_null_grp5_stg_oulad_student_info_id_student.1a2bfbb142'
[0m07:45:47.708765 [debug] [Thread-3  ]: Acquiring new clickhouse connection 'test.ex_09_oulad.unique_grp5_stg_oulad_student_info_id_student.9bf9337d34'
[0m07:45:47.710859 [debug] [Thread-1  ]: Began compiling node test.ex_09_oulad.accepted_values_grp5_stg_oulad_student_info_gender__M__F__Unknown.882027f822
[0m07:45:47.713678 [debug] [Thread-2  ]: Began compiling node test.ex_09_oulad.not_null_grp5_stg_oulad_student_info_id_student.1a2bfbb142
[0m07:45:47.716348 [debug] [Thread-3  ]: Began compiling node test.ex_09_oulad.unique_grp5_stg_oulad_student_info_id_student.9bf9337d34
[0m07:45:47.768337 [debug] [Thread-1  ]: Writing injected SQL for node "test.ex_09_oulad.accepted_values_grp5_stg_oulad_student_info_gender__M__F__Unknown.882027f822"
[0m07:45:47.821288 [debug] [Thread-2  ]: Writing injected SQL for node "test.ex_09_oulad.not_null_grp5_stg_oulad_student_info_id_student.1a2bfbb142"
[0m07:45:47.829983 [debug] [Thread-3  ]: Writing injected SQL for node "test.ex_09_oulad.unique_grp5_stg_oulad_student_info_id_student.9bf9337d34"
[0m07:45:47.832522 [debug] [Thread-1  ]: Began executing node test.ex_09_oulad.accepted_values_grp5_stg_oulad_student_info_gender__M__F__Unknown.882027f822
[0m07:45:47.837299 [debug] [Thread-2  ]: Began executing node test.ex_09_oulad.not_null_grp5_stg_oulad_student_info_id_student.1a2bfbb142
[0m07:45:47.839386 [debug] [Thread-3  ]: Began executing node test.ex_09_oulad.unique_grp5_stg_oulad_student_info_id_student.9bf9337d34
[0m07:45:47.986312 [debug] [Thread-1  ]: Writing runtime sql for node "test.ex_09_oulad.accepted_values_grp5_stg_oulad_student_info_gender__M__F__Unknown.882027f822"
[0m07:45:47.988976 [debug] [Thread-3  ]: Writing runtime sql for node "test.ex_09_oulad.unique_grp5_stg_oulad_student_info_id_student.9bf9337d34"
[0m07:45:47.990910 [debug] [Thread-2  ]: Writing runtime sql for node "test.ex_09_oulad.not_null_grp5_stg_oulad_student_info_id_student.1a2bfbb142"
[0m07:45:47.995727 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m07:45:47.998086 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m07:45:48.000132 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m07:45:51.312683 [debug] [Thread-2  ]: dbt_clickhouse adapter: On test.ex_09_oulad.not_null_grp5_stg_oulad_student_info_id_student.1a2bfbb142: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "test.ex_09_oulad.not_null_grp5_stg_oulad_student_info_id_student.1a2bfbb142"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id_student
from `clean`.`grp5_stg_oulad_student_info`
where id_student is null



    ) dbt_internal_test...
[0m07:45:51.590092 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.28 seconds
[0m07:45:51.601583 [info ] [Thread-2  ]: 2 of 3 PASS not_null_grp5_stg_oulad_student_info_id_student .................... [[32mPASS[0m in 3.90s]
[0m07:45:51.603827 [debug] [Thread-2  ]: Finished running node test.ex_09_oulad.not_null_grp5_stg_oulad_student_info_id_student.1a2bfbb142
[0m07:45:52.410108 [debug] [Thread-1  ]: dbt_clickhouse adapter: On test.ex_09_oulad.accepted_values_grp5_stg_oulad_student_info_gender__M__F__Unknown.882027f822: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "test.ex_09_oulad.accepted_values_grp5_stg_oulad_student_info_gender__M__F__Unknown.882027f822"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        gender as value_field,
        count(*) as n_records

    from `clean`.`grp5_stg_oulad_student_info`
    group by gender

)

select *
from all_values
where value_field not in (
    'M','F','Unknown'
)



    ) dbt_internal_test...
[0m07:45:52.462411 [debug] [Thread-3  ]: dbt_clickhouse adapter: On test.ex_09_oulad.unique_grp5_stg_oulad_student_info_id_student.9bf9337d34: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "test.ex_09_oulad.unique_grp5_stg_oulad_student_info_id_student.9bf9337d34"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id_student as unique_field,
    count(*) as n_records

from `clean`.`grp5_stg_oulad_student_info`
where id_student is not null
group by id_student
having count(*) > 1



    ) dbt_internal_test...
[0m07:45:52.755841 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.34 seconds
[0m07:45:52.760595 [info ] [Thread-1  ]: 1 of 3 PASS accepted_values_grp5_stg_oulad_student_info_gender__M__F__Unknown .. [[32mPASS[0m in 5.06s]
[0m07:45:52.762868 [debug] [Thread-1  ]: Finished running node test.ex_09_oulad.accepted_values_grp5_stg_oulad_student_info_gender__M__F__Unknown.882027f822
[0m07:45:52.845896 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.38 seconds
[0m07:45:52.851047 [error] [Thread-3  ]: 3 of 3 FAIL 3538 unique_grp5_stg_oulad_student_info_id_student ................. [[31mFAIL 3538[0m in 5.14s]
[0m07:45:52.853099 [debug] [Thread-3  ]: Finished running node test.ex_09_oulad.unique_grp5_stg_oulad_student_info_id_student.9bf9337d34
[0m07:45:52.857995 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:45:52.858858 [debug] [MainThread]: Connection 'list__clean' was left open.
[0m07:45:52.859723 [debug] [MainThread]: On list__clean: Close
[0m07:45:52.860661 [debug] [MainThread]: Connection 'list__mart' was left open.
[0m07:45:52.861561 [debug] [MainThread]: On list__mart: Close
[0m07:45:52.862709 [debug] [MainThread]: Connection 'list__sandbox' was left open.
[0m07:45:52.864065 [debug] [MainThread]: On list__sandbox: Close
[0m07:45:52.865342 [debug] [MainThread]: Connection 'test.ex_09_oulad.accepted_values_grp5_stg_oulad_student_info_gender__M__F__Unknown.882027f822' was left open.
[0m07:45:52.866355 [debug] [MainThread]: On test.ex_09_oulad.accepted_values_grp5_stg_oulad_student_info_gender__M__F__Unknown.882027f822: Close
[0m07:45:52.867225 [debug] [MainThread]: Connection 'test.ex_09_oulad.not_null_grp5_stg_oulad_student_info_id_student.1a2bfbb142' was left open.
[0m07:45:52.868662 [debug] [MainThread]: On test.ex_09_oulad.not_null_grp5_stg_oulad_student_info_id_student.1a2bfbb142: Close
[0m07:45:52.869597 [debug] [MainThread]: Connection 'test.ex_09_oulad.unique_grp5_stg_oulad_student_info_id_student.9bf9337d34' was left open.
[0m07:45:52.870641 [debug] [MainThread]: On test.ex_09_oulad.unique_grp5_stg_oulad_student_info_id_student.9bf9337d34: Close
[0m07:45:52.872673 [info ] [MainThread]: 
[0m07:45:52.874002 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 11.71 seconds (11.71s).
[0m07:45:52.877692 [debug] [MainThread]: Command end result
[0m07:45:52.969487 [info ] [MainThread]: 
[0m07:45:52.971026 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:45:52.972526 [info ] [MainThread]: 
[0m07:45:52.974638 [error] [MainThread]: [31mFailure in test unique_grp5_stg_oulad_student_info_id_student (models/clean/schema.yml)[0m
[0m07:45:52.976470 [error] [MainThread]:   Got 3538 results, configured to fail if != 0
[0m07:45:52.977900 [info ] [MainThread]: 
[0m07:45:52.980203 [info ] [MainThread]:   compiled code at target/compiled/ex_09_oulad/models/clean/schema.yml/unique_grp5_stg_oulad_student_info_id_student.sql
[0m07:45:52.981773 [info ] [MainThread]: 
[0m07:45:52.985154 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m07:45:52.989715 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 14.2784, "process_in_blocks": "5280", "process_kernel_time": 1.975595, "process_mem_max_rss": "114760", "process_out_blocks": "10536", "process_user_time": 7.462533}
[0m07:45:52.991803 [debug] [MainThread]: Command `dbt test` failed at 07:45:52.991243 after 14.28 seconds
[0m07:45:52.993618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b7181c4310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b71615c250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b7144b9280>]}
[0m07:45:52.995649 [debug] [MainThread]: Flushing usage events
[0m14:15:39.238581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792d78a90310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792d756deb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792d756de9d0>]}


============================== 14:15:39.293323 | a922a72e-74b4-4256-88e2-888bc2eaeda7 ==============================
[0m14:15:39.293323 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:15:39.296984 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'fail_fast': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'use_colors': 'True', 'log_format': 'default', 'log_cache_events': 'False', 'version_check': 'True', 'empty': 'False', 'quiet': 'False', 'debug': 'False', 'printer_width': '80', 'no_print': 'None', 'indirect_selection': 'eager', 'write_json': 'True', 'invocation_command': 'dbt build --profiles-dir . --target remote', 'profiles_dir': '.', 'introspect': 'True', 'log_path': '/workdir/transforms/09_oulad/logs'}
[0m14:15:39.952809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a922a72e-74b4-4256-88e2-888bc2eaeda7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792d755db640>]}
[0m14:15:40.131441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a922a72e-74b4-4256-88e2-888bc2eaeda7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792d757ecd60>]}
[0m14:15:40.135616 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m14:15:40.453792 [debug] [MainThread]: checksum: 265ce5244aff672775eaff93c261d21692ed3f5650f4d9e918c76acdb0e9479a, vars: {}, profile: , target: remote, version: 1.8.9
[0m14:15:41.082531 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 3 files added, 1 files changed.
[0m14:15:41.084442 [debug] [MainThread]: Partial parsing: added file: ex_09_oulad://models/mart/dq/schema.yml
[0m14:15:41.085846 [debug] [MainThread]: Partial parsing: added file: ex_09_oulad://models/mart/dq/grp5_dq_oulad_studentVle_anomalies.sql
[0m14:15:41.086899 [debug] [MainThread]: Partial parsing: added file: ex_09_oulad://models/mart/dq/grp5_dq_oulad_studenVle_summary.sql
[0m14:15:41.089020 [debug] [MainThread]: Partial parsing: updated file: ex_09_oulad://models/sources.yml
[0m14:15:42.896316 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies' (models/mart/dq/grp5_dq_oulad_studentVle_anomalies.sql) depends on a node named 'studentVle' which was not found
[0m14:15:42.901869 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 3.922602, "process_in_blocks": "73008", "process_kernel_time": 2.809702, "process_mem_max_rss": "102692", "process_out_blocks": "6616", "process_user_time": 8.30088}
[0m14:15:42.906919 [debug] [MainThread]: Command `dbt build` failed at 14:15:42.906488 after 3.93 seconds
[0m14:15:42.910815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792d78a90310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792d73abb970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792d753de970>]}
[0m14:15:42.914379 [debug] [MainThread]: Flushing usage events
[0m14:23:54.297534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706294351e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706290fa6490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706290fa65e0>]}


============================== 14:23:54.340654 | 61c9e114-3a6a-4b0b-9af0-fa8f5f3a0071 ==============================
[0m14:23:54.340654 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:23:54.343136 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'use_experimental_parser': 'False', 'debug': 'False', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'quiet': 'False', 'static_parser': 'True', 'version_check': 'True', 'empty': 'False', 'profiles_dir': '.', 'target_path': 'None', 'indirect_selection': 'eager', 'printer_width': '80', 'use_colors': 'True', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt build --profiles-dir . --target remote', 'no_print': 'None', 'log_path': '/workdir/transforms/09_oulad/logs', 'cache_selected_only': 'False', 'warn_error': 'None', 'log_format': 'default'}
[0m14:23:54.849922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '61c9e114-3a6a-4b0b-9af0-fa8f5f3a0071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706294763b50>]}
[0m14:23:54.981989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '61c9e114-3a6a-4b0b-9af0-fa8f5f3a0071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706290fda220>]}
[0m14:23:54.984328 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m14:23:55.306443 [debug] [MainThread]: checksum: 265ce5244aff672775eaff93c261d21692ed3f5650f4d9e918c76acdb0e9479a, vars: {}, profile: , target: remote, version: 1.8.9
[0m14:23:55.807794 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 3 files added, 1 files changed.
[0m14:23:55.809379 [debug] [MainThread]: Partial parsing: added file: ex_09_oulad://models/mart/dq/schema.yml
[0m14:23:55.810538 [debug] [MainThread]: Partial parsing: added file: ex_09_oulad://models/mart/dq/grp5_dq_oulad_studentVle_anomalies.sql
[0m14:23:55.811450 [debug] [MainThread]: Partial parsing: added file: ex_09_oulad://models/mart/dq/grp5_dq_oulad_studenVle_summary.sql
[0m14:23:55.813346 [debug] [MainThread]: Partial parsing: updated file: ex_09_oulad://models/sources.yml
[0m14:23:56.331476 [error] [MainThread]: Encountered an error:
Compilation Error in model grp5_dq_oulad_studenVle_summary (models/mart/dq/grp5_dq_oulad_studenVle_summary.sql)
  source() takes exactly two arguments (1 given)
[0m14:23:56.335431 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 2.215765, "process_in_blocks": "616", "process_kernel_time": 3.624368, "process_mem_max_rss": "100448", "process_out_blocks": "6616", "process_user_time": 7.136873}
[0m14:23:56.337013 [debug] [MainThread]: Command `dbt build` failed at 14:23:56.336554 after 2.22 seconds
[0m14:23:56.338203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706294351e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706290b09130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70628f521a60>]}
[0m14:23:56.339357 [debug] [MainThread]: Flushing usage events
[0m14:24:45.566083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d95378d9310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d953453abb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d953453aa60>]}


============================== 14:24:45.585616 | 4fa6db25-f5c7-4bd0-a713-e892a53a5491 ==============================
[0m14:24:45.585616 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:24:45.588010 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'write_json': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'use_colors': 'True', 'version_check': 'True', 'printer_width': '80', 'fail_fast': 'False', 'profiles_dir': '.', 'static_parser': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'log_path': '/workdir/transforms/09_oulad/logs', 'debug': 'False', 'log_cache_events': 'False', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt build --profiles-dir . --target remote', 'quiet': 'False', 'use_experimental_parser': 'False', 'target_path': 'None'}
[0m14:24:46.037524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4fa6db25-f5c7-4bd0-a713-e892a53a5491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d95344f2d30>]}
[0m14:24:46.165373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4fa6db25-f5c7-4bd0-a713-e892a53a5491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d95349ae6d0>]}
[0m14:24:46.167269 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m14:24:46.400540 [debug] [MainThread]: checksum: 265ce5244aff672775eaff93c261d21692ed3f5650f4d9e918c76acdb0e9479a, vars: {}, profile: , target: remote, version: 1.8.9
[0m14:24:46.859471 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 3 files added, 1 files changed.
[0m14:24:46.862009 [debug] [MainThread]: Partial parsing: added file: ex_09_oulad://models/mart/dq/grp5_dq_oulad_studentVle_anomalies.sql
[0m14:24:46.863466 [debug] [MainThread]: Partial parsing: added file: ex_09_oulad://models/mart/dq/grp5_dq_oulad_studenVle_summary.sql
[0m14:24:46.864610 [debug] [MainThread]: Partial parsing: added file: ex_09_oulad://models/mart/dq/schema.yml
[0m14:24:46.866460 [debug] [MainThread]: Partial parsing: updated file: ex_09_oulad://models/sources.yml
[0m14:24:45.541854 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ex_09_oulad.grp5_dq_oulad_studenVle_summary' (models/mart/dq/grp5_dq_oulad_studenVle_summary.sql) depends on a node named 'grp5_stg_oulad_studentVle' which was not found
[0m14:24:45.549192 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 2.5678852, "process_in_blocks": "832", "process_kernel_time": 1.811809, "process_mem_max_rss": "103524", "process_out_blocks": "6616", "process_user_time": 6.3955}
[0m14:24:45.566282 [debug] [MainThread]: Command `dbt build` failed at 14:24:45.565299 after 2.59 seconds
[0m14:24:45.569481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d95378d9310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9533d3dd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9533d3d1c0>]}
[0m14:24:45.572479 [debug] [MainThread]: Flushing usage events
[0m14:28:17.344467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ba6f4e6e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ba6c15ab80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ba6c15aa30>]}


============================== 14:28:17.389448 | 71d6b4f7-56f6-4403-acf5-13f9ac4298f8 ==============================
[0m14:28:17.389448 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:28:17.391630 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'log_path': '/workdir/transforms/09_oulad/logs', 'target_path': 'None', 'partial_parse': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt build --profiles-dir . --target remote', 'cache_selected_only': 'False', 'warn_error': 'None', 'no_print': 'None', 'introspect': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'printer_width': '80', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'debug': 'False', 'write_json': 'True', 'empty': 'False'}
[0m14:28:17.840426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '71d6b4f7-56f6-4403-acf5-13f9ac4298f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ba6f700b50>]}
[0m14:28:18.023213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '71d6b4f7-56f6-4403-acf5-13f9ac4298f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ba6c192220>]}
[0m14:28:18.025455 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m14:28:18.297876 [debug] [MainThread]: checksum: 265ce5244aff672775eaff93c261d21692ed3f5650f4d9e918c76acdb0e9479a, vars: {}, profile: , target: remote, version: 1.8.9
[0m14:28:18.684650 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 3 files added, 1 files changed.
[0m14:28:18.685883 [debug] [MainThread]: Partial parsing: added file: ex_09_oulad://models/mart/dq/grp5_dq_oulad_studentVle_anomalies.sql
[0m14:28:18.686995 [debug] [MainThread]: Partial parsing: added file: ex_09_oulad://models/mart/dq/grp5_dq_oulad_studenVle_summary.sql
[0m14:28:18.688258 [debug] [MainThread]: Partial parsing: added file: ex_09_oulad://models/mart/dq/schema.yml
[0m14:28:18.690152 [debug] [MainThread]: Partial parsing: updated file: ex_09_oulad://models/sources.yml
[0m14:28:14.020665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '71d6b4f7-56f6-4403-acf5-13f9ac4298f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ba6a3ae130>]}
[0m14:28:14.441169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '71d6b4f7-56f6-4403-acf5-13f9ac4298f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ba6a264340>]}
[0m14:28:14.442568 [info ] [MainThread]: Found 7 models, 6 sources, 471 macros
[0m14:28:14.453458 [info ] [MainThread]: 
[0m14:28:14.457360 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m14:28:14.494077 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m14:28:14.508160 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m14:28:14.511220 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m14:28:14.581886 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:28:14.584014 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:28:14.601372 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:28:20.694771 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m14:28:21.041247 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m14:28:21.042777 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.34 seconds
[0m14:28:21.192184 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m14:28:21.473704 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.43 seconds
[0m14:28:21.983299 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.79 seconds
[0m14:28:21.990777 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__clean)
[0m14:28:21.999180 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__mart)
[0m14:28:22.007219 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list__sandbox'
[0m14:28:22.026975 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list__mart"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'mart'
      

  ...
[0m14:28:22.028246 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list__clean"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'clean'
      

  ...
[0m14:28:22.034603 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:28:22.356477 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.32 seconds
[0m14:28:22.672566 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.63 seconds
[0m14:28:27.408730 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__sandbox: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list__sandbox"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'sandbox'
      

  ...
[0m14:28:27.737836 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.33 seconds
[0m14:28:27.829157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71d6b4f7-56f6-4403-acf5-13f9ac4298f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ba69e14c10>]}
[0m14:28:31.439560 [info ] [MainThread]: Concurrency: 4 threads (target='remote')
[0m14:28:31.442528 [info ] [MainThread]: 
[0m14:28:31.535006 [debug] [Thread-1  ]: Began running node model.ex_09_oulad.grp5_dq_oulad_studenVle_summary
[0m14:28:31.537978 [debug] [Thread-2  ]: Began running node model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies
[0m14:28:31.540840 [info ] [Thread-1  ]: 1 of 7 START sql view model `mart`.`grp5_dq_oulad_studenVle_summary` ........... [RUN]
[0m14:28:31.544849 [debug] [Thread-3  ]: Began running node model.ex_09_oulad.grp5_oulad_dim_courses
[0m14:28:31.548770 [info ] [Thread-2  ]: 2 of 7 START sql view model `mart`.`grp5_dq_oulad_studentVle_anomalies` ........ [RUN]
[0m14:28:31.553613 [debug] [Thread-4  ]: Began running node model.ex_09_oulad.grp5_oulad_dim_module_presentation
[0m14:28:31.559358 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.ex_09_oulad.grp5_dq_oulad_studenVle_summary'
[0m14:28:31.565590 [info ] [Thread-3  ]: 3 of 7 START sql table model `mart`.`grp5_oulad_dim_courses` ................... [RUN]
[0m14:28:31.569790 [debug] [Thread-2  ]: Acquiring new clickhouse connection 'model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies'
[0m14:28:31.573356 [info ] [Thread-4  ]: 4 of 7 START sql table model `sandbox`.`grp5_oulad_dim_module_presentation` .... [RUN]
[0m14:28:31.577187 [debug] [Thread-1  ]: Began compiling node model.ex_09_oulad.grp5_dq_oulad_studenVle_summary
[0m14:28:31.581052 [debug] [Thread-3  ]: Acquiring new clickhouse connection 'model.ex_09_oulad.grp5_oulad_dim_courses'
[0m14:28:31.592770 [debug] [Thread-2  ]: Began compiling node model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies
[0m14:28:31.596562 [debug] [Thread-4  ]: Acquiring new clickhouse connection 'model.ex_09_oulad.grp5_oulad_dim_module_presentation'
[0m14:28:31.617984 [debug] [Thread-3  ]: Began compiling node model.ex_09_oulad.grp5_oulad_dim_courses
[0m14:28:31.655080 [debug] [Thread-4  ]: Began compiling node model.ex_09_oulad.grp5_oulad_dim_module_presentation
[0m14:28:27.042493 [debug] [Thread-2  ]: Writing injected SQL for node "model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies"
[0m14:28:27.046987 [debug] [Thread-3  ]: Writing injected SQL for node "model.ex_09_oulad.grp5_oulad_dim_courses"
[0m14:28:27.054117 [debug] [Thread-2  ]: Began executing node model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies
[0m14:28:27.038191 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_09_oulad.grp5_dq_oulad_studenVle_summary"
[0m14:28:27.076102 [debug] [Thread-4  ]: Writing injected SQL for node "model.ex_09_oulad.grp5_oulad_dim_module_presentation"
[0m14:28:27.099497 [debug] [Thread-3  ]: Began executing node model.ex_09_oulad.grp5_oulad_dim_courses
[0m14:28:27.136164 [debug] [Thread-1  ]: Began executing node model.ex_09_oulad.grp5_dq_oulad_studenVle_summary
[0m14:28:27.159517 [debug] [Thread-4  ]: Began executing node model.ex_09_oulad.grp5_oulad_dim_module_presentation
[0m14:28:27.642574 [debug] [Thread-2  ]: Creating new relation grp5_dq_oulad_studentVle_anomalies
[0m14:28:27.736395 [debug] [Thread-1  ]: Creating new relation grp5_dq_oulad_studenVle_summary
[0m14:28:27.937355 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m14:28:27.969543 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m14:28:28.101874 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m14:28:28.099502 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m14:28:32.835065 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_09_oulad.grp5_dq_oulad_studenVle_summary"
[0m14:28:32.841164 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_dq_oulad_studenVle_summary: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_dq_oulad_studenVle_summary"} */


  create view `mart`.`grp5_dq_oulad_studenVle_summary` 
  
    
    
  as (
    -- Path: ftw-de-bootcamp/dbt/transforms/09_oulad/models/mart/dq/grp5_dq_oulad_studenVle_summary.sql



-- Summary-level DQ KPIs for studentVLE

with src as (
    select * from `raw`.`studentVle`
),
cln as (
    select * from `clean`.`grp5_stg_oulad_studentVle`
),

-- Row counts
counts as (
    select
        (select count(*) from src) as row_count_raw,
        (select count(*) from cln) as row_count_clean
),

-- Null value checks
nulls as (
    select
        round(100.0 * countIf(id_student is null) / nullif(count(),0),2) as pct_null_id_student,
        round(100.0 * countIf(code_module is null) / nullif(count(),0),2) as pct_null_code_module,
        round(100.0 * countIf(code_presentation is null) / nullif(count(),0),2) as pct_null_code_presentation,
        round(100.0 * countIf(sum_click is null) / nullif(count(),0),2) as pct_null_sum_click
    from cln
),

-- Domain validity: valid module + presentation combinations
domains as (
    select
        countIf((code_module, code_presentation) not in (
            ('AAA','2013J'), ('AAA','2014J'),
            ('BBB','2013J'), ('BBB','2014J'), ('BBB','2013B'), ('BBB','2014B'),
            ('CCC','2014J'), ('CCC','2014B'),
            ('DDD','2013J'), ('DDD','2014J'), ('DDD','2013B'), ('DDD','2014B'),
            ('EEE','2013J'), ('EEE','2014J'), ('EEE','2014B'),
            ('FFF','2013J'), ('FFF','2014J'), ('FFF','2013B'), ('FFF','2014B'),
            ('GGG','2013J'), ('GGG','2014J'), ('GGG','2014B')
        )) as invalid_module_presentation
    from cln
),

-- Bounds/logical checks
bounds as (
    select
        countIf(sum_click < 0) as negative_sum_click,
        countIf(date < 0) as negative_date
    from cln
),

-- Combine all metrics
joined as (
    select
        counts.row_count_raw,
        counts.row_count_clean,
        (counts.row_count_raw - counts.row_count_clean) as dropped_rows,

        nulls.pct_null_id_student,
        nulls.pct_null_code_module,
        nulls.pct_null_code_presentation,
        nulls.pct_null_sum_click,

        domains.invalid_module_presentation,

        bounds.negative_sum_click,
        bounds.negative_date
    from counts
    cross join nulls
    cross join domains
    cross join bounds
)

select * from joined;
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m14:28:33.019997 [debug] [Thread-2  ]: Writing runtime sql for node "model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies"
[0m14:28:33.023559 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_module_presentation: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_module_presentation"} */

            

    
        create table `sandbox`.`grp5_oulad_dim_module_presentation__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Dimension table for module + presentation (simple, with Nullable types)
select
    cast(code_module as Nullable(String))                           as code_module,
    cast(code_presentation as Nullable(String))                     as code_presentation,
    cast(module_presentation_length as Nullable(Int32))             as length_days
from `clean`.`grp5_stg_oulad_courses`
          )
        
        ...
[0m14:28:33.030622 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies"} */


  create view `mart`.`grp5_dq_oulad_studentVle_anomalies` 
  
    
    
  as (
    -- Path: ftw-de-bootcamp/dbt/transforms/09_oulad/models/mart/dq/grp5_dq_oulad_studentVle_anomalies.sql



-- Row-level drilldown of “obviously wrong” studentVLE records
-- LIMIT 50 for demo purposes; remove in production.

with cln as (
    select * from `clean`.`grp5_stg_oulad_studentVle`
),

violations as (
    select
        id_student,
        code_module,
        code_presentation,
        id_site,
        date,
        sum_click,

        multiIf(
            id_student is null,                                     'null_id_student',
            code_module is null,                                    'null_code_module',
            code_presentation is null,                              'null_code_presentation',
            sum_click is null,                                      'null_sum_click',
            sum_click < 0,                                         'negative_sum_click',
            date < 0,                                              'negative_date',
            (code_module, code_presentation) not in (
                ('AAA','2013J'), ('AAA','2014J'),
                ('BBB','2013J'), ('BBB','2014J'), ('BBB','2013B'), ('BBB','2014B'),
                ('CCC','2014J'), ('CCC','2014B'),
                ('DDD','2013J'), ('DDD','2014J'), ('DDD','2013B'), ('DDD','2014B'),
                ('EEE','2013J'), ('EEE','2014J'), ('EEE','2014B'),
                ('FFF','2013J'), ('FFF','2014J'), ('FFF','2013B'), ('FFF','2014B'),
                ('GGG','2013J'), ('GGG','2014J'), ('GGG','2014B')
            ),                                                    'invalid_module_presentation',
            'ok'
        ) as dq_issue
    from cln
)

select *
from violations
where dq_issue != 'ok'
limit 50;
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m14:28:33.195511 [debug] [Thread-1  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_dq_oulad_studenVle_summary"} */


  create view `mart`.`grp5_dq_oulad_studenVle_summary` 
  
    
    
  as (
    -- Path: ftw-de-bootcamp/dbt/transforms/09_oulad/models/mart/dq/grp5_dq_oulad_studenVle_summary.sql



-- Summary-level DQ KPIs for studentVLE

with src as (
    select * from `raw`.`studentVle`
),
cln as (
    select * from `clean`.`grp5_stg_oulad_studentVle`
),

-- Row counts
counts as (
    select
        (select count(*) from src) as row_count_raw,
        (select count(*) from cln) as row_count_clean
),

-- Null value checks
nulls as (
    select
        round(100.0 * countIf(id_student is null) / nullif(count(),0),2) as pct_null_id_student,
        round(100.0 * countIf(code_module is null) / nullif(count(),0),2) as pct_null_code_module,
        round(100.0 * countIf(code_presentation is null) / nullif(count(),0),2) as pct_null_code_presentation,
        round(100.0 * countIf(sum_click is null) / nullif(count(),0),2) as pct_null_sum_click
    from cln
),

-- Domain validity: valid module + presentation combinations
domains as (
    select
        countIf((code_module, code_presentation) not in (
            ('AAA','2013J'), ('AAA','2014J'),
            ('BBB','2013J'), ('BBB','2014J'), ('BBB','2013B'), ('BBB','2014B'),
            ('CCC','2014J'), ('CCC','2014B'),
            ('DDD','2013J'), ('DDD','2014J'), ('DDD','2013B'), ('DDD','2014B'),
            ('EEE','2013J'), ('EEE','2014J'), ('EEE','2014B'),
            ('FFF','2013J'), ('FFF','2014J'), ('FFF','2013B'), ('FFF','2014B'),
            ('GGG','2013J'), ('GGG','2014J'), ('GGG','2014B')
        )) as invalid_module_presentation
    from cln
),

-- Bounds/logical checks
bounds as (
    select
        countIf(sum_click < 0) as negative_sum_click,
        countIf(date < 0) as negative_date
    from cln
),

-- Combine all metrics
joined as (
    select
        counts.row_count_raw,
        counts.row_count_clean,
        (counts.row_count_raw - counts.row_count_clean) as dropped_rows,

        nulls.pct_null_id_student,
        nulls.pct_null_code_module,
        nulls.pct_null_code_presentation,
        nulls.pct_null_sum_click,

        domains.invalid_module_presentation,

        bounds.negative_sum_click,
        bounds.negative_date
    from counts
    cross join nulls
    cross join domains
    cross join bounds
)

select * from joined;
    
  )
      
      
                    -- end_of_sql
                    
                    
[0m14:28:33.216107 [debug] [Thread-1  ]: Database Error in model grp5_dq_oulad_studenVle_summary (models/mart/dq/grp5_dq_oulad_studenVle_summary.sql)
  HTTPDriver for http://54.87.106.52:8123 received ClickHouse error code 62
   Code: 62. DB::Exception: Syntax error: failed at position 2491 (end of query) (line 84, col 21): ;
      
    )
        
        
                      -- end_of_sql
                      
                      . Expected one of: token, Dot, OpeningRoundBracket, UUID, alias, AS, identifier, FINAL, SAMPLE, table, table function, subquery or list of joined tables, array join, LEFT ARRAY JOIN, INNER, ARRAY JOIN, JOIN, PREWHERE, WHERE, GROUP BY, WITH, HAVING, WINDOW, ORDER BY, LIMIT, OFFSET, FETCH, SETTINGS, UNION, EXCEPT, INTERSECT. (SYNTAX_ERROR) (version 23.12.6.19 (official build))
  compiled code at target/run/ex_09_oulad/models/mart/dq/grp5_dq_oulad_studenVle_summary.sql
[0m14:28:33.221821 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71d6b4f7-56f6-4403-acf5-13f9ac4298f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ba69fca5b0>]}
[0m14:28:33.225779 [error] [Thread-1  ]: 1 of 7 ERROR creating sql view model `mart`.`grp5_dq_oulad_studenVle_summary` .. [[31mERROR[0m in 1.66s]
[0m14:28:33.229998 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_courses: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_courses"} */

            

    
        create table `mart`.`grp5_oulad_dim_courses__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

select
    concat(cast(code_module as Nullable(String)), cast(code_presentation as Nullable(String))) 
        as id_course,
    cast(code_module as Nullable(String))                           as code_module,
    cast(code_presentation as Nullable(String))                     as code_presentation,
    cast(module_presentation_length as Nullable(Int32))             as module_presentation_length
from `clean`.`grp5_stg_oulad_courses`
          )
        
        ...
[0m14:28:33.234094 [debug] [Thread-1  ]: Finished running node model.ex_09_oulad.grp5_dq_oulad_studenVle_summary
[0m14:28:33.240554 [debug] [Thread-1  ]: Began running node model.ex_09_oulad.grp5_oulad_dim_student
[0m14:28:33.245879 [info ] [Thread-1  ]: 5 of 7 START sql table model `sandbox`.`grp5_oulad_dim_student` ................ [RUN]
[0m14:28:33.249108 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ex_09_oulad.grp5_dq_oulad_studenVle_summary, now model.ex_09_oulad.grp5_oulad_dim_student)
[0m14:28:33.251328 [debug] [Thread-1  ]: Began compiling node model.ex_09_oulad.grp5_oulad_dim_student
[0m14:28:33.280225 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_09_oulad.grp5_oulad_dim_student"
[0m14:28:33.283253 [debug] [Thread-1  ]: Began executing node model.ex_09_oulad.grp5_oulad_dim_student
[0m14:28:33.310465 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_student: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_student"} */

            

    
        create table `sandbox`.`grp5_oulad_dim_student__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Dimension table for students (no surrogate key)
select
    cast(id_student as Int64)               as id_student,
    cast(gender as Nullable(String))        as gender,
    cast(age_band as Nullable(String))      as age_band,
    cast(region as Nullable(String))        as region,
    cast(highest_education as Nullable(String)) as highest_education,
    cast(imd_band as Nullable(String))      as imd_band,
    cast(disability as Nullable(String))    as disability
from `clean`.`grp5_stg_oulad_student_info`
          )
        
        ...
[0m14:28:33.386823 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.36 seconds
[0m14:28:33.390296 [debug] [Thread-2  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies"} */


  create view `mart`.`grp5_dq_oulad_studentVle_anomalies` 
  
    
    
  as (
    -- Path: ftw-de-bootcamp/dbt/transforms/09_oulad/models/mart/dq/grp5_dq_oulad_studentVle_anomalies.sql



-- Row-level drilldown of “obviously wrong” studentVLE records
-- LIMIT 50 for demo purposes; remove in production.

with cln as (
    select * from `clean`.`grp5_stg_oulad_studentVle`
),

violations as (
    select
        id_student,
        code_module,
        code_presentation,
        id_site,
        date,
        sum_click,

        multiIf(
            id_student is null,                                     'null_id_student',
            code_module is null,                                    'null_code_module',
            code_presentation is null,                              'null_code_presentation',
            sum_click is null,                                      'null_sum_click',
            sum_click < 0,                                         'negative_sum_click',
            date < 0,                                              'negative_date',
            (code_module, code_presentation) not in (
                ('AAA','2013J'), ('AAA','2014J'),
                ('BBB','2013J'), ('BBB','2014J'), ('BBB','2013B'), ('BBB','2014B'),
                ('CCC','2014J'), ('CCC','2014B'),
                ('DDD','2013J'), ('DDD','2014J'), ('DDD','2013B'), ('DDD','2014B'),
                ('EEE','2013J'), ('EEE','2014J'), ('EEE','2014B'),
                ('FFF','2013J'), ('FFF','2014J'), ('FFF','2013B'), ('FFF','2014B'),
                ('GGG','2013J'), ('GGG','2014J'), ('GGG','2014B')
            ),                                                    'invalid_module_presentation',
            'ok'
        ) as dq_issue
    from cln
)

select *
from violations
where dq_issue != 'ok'
limit 50;
    
  )
      
      
                    -- end_of_sql
                    
                    
[0m14:28:33.425886 [debug] [Thread-2  ]: Database Error in model grp5_dq_oulad_studentVle_anomalies (models/mart/dq/grp5_dq_oulad_studentVle_anomalies.sql)
  HTTPDriver for http://54.87.106.52:8123 received ClickHouse error code 62
   Code: 62. DB::Exception: Syntax error: failed at position 1994 (end of query) (line 53, col 9): ;
      
    )
        
        
                      -- end_of_sql
                      
                      . Expected one of: token, DoubleColon, OR, AND, IS NOT DISTINCT FROM, IS NULL, IS NOT NULL, BETWEEN, NOT BETWEEN, LIKE, ILIKE, NOT LIKE, NOT ILIKE, REGEXP, IN, NOT IN, GLOBAL IN, GLOBAL NOT IN, MOD, DIV, alias, AS, Comma, OFFSET, WITH TIES, BY, FETCH, LIMIT, SETTINGS, UNION, EXCEPT, INTERSECT. (SYNTAX_ERROR) (version 23.12.6.19 (official build))
  compiled code at target/run/ex_09_oulad/models/mart/dq/grp5_dq_oulad_studentVle_anomalies.sql
[0m14:28:33.434454 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71d6b4f7-56f6-4403-acf5-13f9ac4298f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ba69576850>]}
[0m14:28:33.444465 [error] [Thread-2  ]: 2 of 7 ERROR creating sql view model `mart`.`grp5_dq_oulad_studentVle_anomalies`  [[31mERROR[0m in 1.87s]
[0m14:28:33.471741 [debug] [Thread-2  ]: Finished running node model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies
[0m14:28:33.474849 [debug] [Thread-2  ]: Began running node model.ex_09_oulad.grp5_stg_oulad_student_assessment
[0m14:28:33.479112 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_module_presentation: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_module_presentation"} */

    select name, type from system.columns where table = 'grp5_oulad_dim_module_presentation__dbt_backup'
    
      and database = 'sandbox'
    
    order by position
  ...
[0m14:28:33.484885 [info ] [Thread-2  ]: 6 of 7 START sql table model `clean`.`grp5_stg_oulad_student_assessment` ....... [RUN]
[0m14:28:33.498084 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies, now model.ex_09_oulad.grp5_stg_oulad_student_assessment)
[0m14:28:33.501338 [debug] [Thread-2  ]: Began compiling node model.ex_09_oulad.grp5_stg_oulad_student_assessment
[0m14:28:33.535851 [debug] [Thread-2  ]: Writing injected SQL for node "model.ex_09_oulad.grp5_stg_oulad_student_assessment"
[0m14:28:33.539732 [debug] [Thread-2  ]: Began executing node model.ex_09_oulad.grp5_stg_oulad_student_assessment
[0m14:28:33.568336 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_assessment"} */

            

    
        create table `clean`.`grp5_stg_oulad_student_assessment__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
             

-- Standardize names and types for student assessment
select
  cast(id_assessment  as Nullable(Int64)) as assessment_id,
  cast(id_student     as Nullable(Int64)) as student_id,
  cast(date_submitted as Nullable(Int64)) as date_submitted,
  cast(is_banked      as Nullable(Int64)) as is_banked,
  cast(score          as Nullable(Int64)) as score
from `raw`.`grp5_oulad___student_assessment`
          )
        
        ...
[0m14:28:33.668538 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.43 seconds
[0m14:28:33.671010 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.36 seconds
[0m14:28:33.680586 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_courses: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_courses"} */

    select name, type from system.columns where table = 'grp5_oulad_dim_courses__dbt_backup'
    
      and database = 'mart'
    
    order by position
  ...
[0m14:28:33.689241 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_student: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_student"} */

    select name, type from system.columns where table = 'grp5_oulad_dim_student__dbt_backup'
    
      and database = 'sandbox'
    
    order by position
  ...
[0m14:28:33.889697 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.40 seconds
[0m14:28:33.898451 [debug] [Thread-4  ]: Writing runtime sql for node "model.ex_09_oulad.grp5_oulad_dim_module_presentation"
[0m14:28:33.900623 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_module_presentation: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_module_presentation"} */

  
    
    
    
        
         


        insert into `sandbox`.`grp5_oulad_dim_module_presentation__dbt_backup`
        ("code_module", "code_presentation", "length_days")

-- Dimension table for module + presentation (simple, with Nullable types)
select
    cast(code_module as Nullable(String))                           as code_module,
    cast(code_presentation as Nullable(String))                     as code_presentation,
    cast(module_presentation_length as Nullable(Int32))             as length_days
from `clean`.`grp5_stg_oulad_courses`
  ...
[0m14:28:34.141031 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.57 seconds
[0m14:28:34.145072 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.45 seconds
[0m14:28:34.148400 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.45 seconds
[0m14:28:34.158785 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_assessment"} */

    select name, type from system.columns where table = 'grp5_stg_oulad_student_assessment__dbt_backup'
    
      and database = 'clean'
    
    order by position
  ...
[0m14:28:34.163564 [debug] [Thread-3  ]: Writing runtime sql for node "model.ex_09_oulad.grp5_oulad_dim_courses"
[0m14:28:34.169602 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_09_oulad.grp5_oulad_dim_student"
[0m14:28:34.174980 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_courses: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_courses"} */

  
    
    
    
        
         


        insert into `mart`.`grp5_oulad_dim_courses__dbt_backup`
        ("id_course", "code_module", "code_presentation", "module_presentation_length")

select
    concat(cast(code_module as Nullable(String)), cast(code_presentation as Nullable(String))) 
        as id_course,
    cast(code_module as Nullable(String))                           as code_module,
    cast(code_presentation as Nullable(String))                     as code_presentation,
    cast(module_presentation_length as Nullable(Int32))             as module_presentation_length
from `clean`.`grp5_stg_oulad_courses`
  ...
[0m14:28:34.176844 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_student: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_student"} */

  
    
    
    
        
         


        insert into `sandbox`.`grp5_oulad_dim_student__dbt_backup`
        ("id_student", "gender", "age_band", "region", "highest_education", "imd_band", "disability")

-- Dimension table for students (no surrogate key)
select
    cast(id_student as Int64)               as id_student,
    cast(gender as Nullable(String))        as gender,
    cast(age_band as Nullable(String))      as age_band,
    cast(region as Nullable(String))        as region,
    cast(highest_education as Nullable(String)) as highest_education,
    cast(imd_band as Nullable(String))      as imd_band,
    cast(disability as Nullable(String))    as disability
from `clean`.`grp5_stg_oulad_student_info`
  ...
[0m14:28:34.340180 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.44 seconds
[0m14:28:34.355419 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_module_presentation: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_module_presentation"} */
EXCHANGE TABLES `sandbox`.`grp5_oulad_dim_module_presentation__dbt_backup` AND `sandbox`.`grp5_oulad_dim_module_presentation` 
  
  ...
[0m14:28:34.579548 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.41 seconds
[0m14:28:34.582348 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.40 seconds
[0m14:28:34.587536 [debug] [Thread-2  ]: Writing runtime sql for node "model.ex_09_oulad.grp5_stg_oulad_student_assessment"
[0m14:28:34.591829 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_courses: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_courses"} */
EXCHANGE TABLES `mart`.`grp5_oulad_dim_courses__dbt_backup` AND `mart`.`grp5_oulad_dim_courses` 
  
  ...
[0m14:28:34.597274 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_assessment"} */

  
    
    
    
        
         


        insert into `clean`.`grp5_stg_oulad_student_assessment__dbt_backup`
        ("assessment_id", "student_id", "date_submitted", "is_banked", "score") 

-- Standardize names and types for student assessment
select
  cast(id_assessment  as Nullable(Int64)) as assessment_id,
  cast(id_student     as Nullable(Int64)) as student_id,
  cast(date_submitted as Nullable(Int64)) as date_submitted,
  cast(is_banked      as Nullable(Int64)) as is_banked,
  cast(score          as Nullable(Int64)) as score
from `raw`.`grp5_oulad___student_assessment`
  ...
[0m14:28:34.611170 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.43 seconds
[0m14:28:34.614596 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_student: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_student"} */
EXCHANGE TABLES `sandbox`.`grp5_oulad_dim_student__dbt_backup` AND `sandbox`.`grp5_oulad_dim_student` 
  
  ...
[0m14:28:34.709069 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.35 seconds
[0m14:28:34.782777 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_module_presentation: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_module_presentation"} */

    drop table if exists `sandbox`.`grp5_oulad_dim_module_presentation__dbt_backup` 
  ...
[0m14:28:35.069660 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.47 seconds
[0m14:28:35.073953 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.46 seconds
[0m14:28:35.097929 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_courses: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_courses"} */

    drop table if exists `mart`.`grp5_oulad_dim_courses__dbt_backup` 
  ...
[0m14:28:35.100902 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.50 seconds
[0m14:28:35.114346 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_student: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_student"} */

    drop table if exists `sandbox`.`grp5_oulad_dim_student__dbt_backup` 
  ...
[0m14:28:35.120583 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_assessment"} */
EXCHANGE TABLES `clean`.`grp5_stg_oulad_student_assessment__dbt_backup` AND `clean`.`grp5_stg_oulad_student_assessment` 
  
  ...
[0m14:28:35.223176 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.44 seconds
[0m14:28:35.231314 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71d6b4f7-56f6-4403-acf5-13f9ac4298f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ba69d2b3d0>]}
[0m14:28:35.233933 [info ] [Thread-4  ]: 4 of 7 OK created sql table model `sandbox`.`grp5_oulad_dim_module_presentation`  [[32mOK[0m in 3.64s]
[0m14:28:35.236406 [debug] [Thread-4  ]: Finished running node model.ex_09_oulad.grp5_oulad_dim_module_presentation
[0m14:28:35.238116 [debug] [Thread-4  ]: Began running node model.ex_09_oulad.grp5_stg_oulad_student_info
[0m14:28:35.239996 [info ] [Thread-4  ]: 7 of 7 START sql table model `clean`.`grp5_stg_oulad_student_info` ............. [RUN]
[0m14:28:35.241707 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.ex_09_oulad.grp5_oulad_dim_module_presentation, now model.ex_09_oulad.grp5_stg_oulad_student_info)
[0m14:28:35.243682 [debug] [Thread-4  ]: Began compiling node model.ex_09_oulad.grp5_stg_oulad_student_info
[0m14:28:35.258895 [debug] [Thread-4  ]: Writing injected SQL for node "model.ex_09_oulad.grp5_stg_oulad_student_info"
[0m14:28:35.262053 [debug] [Thread-4  ]: Began executing node model.ex_09_oulad.grp5_stg_oulad_student_info
[0m14:28:35.279694 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_info: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_info"} */

            

    
        create table `clean`.`grp5_stg_oulad_student_info__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            
select
  cast(code_module            as String)     as code_module,
  cast(code_presentation      as String)     as code_presentation,
  cast(id_student             as Int64)      as id_student,
  cast(
    case
      when gender IN ('M', 'F') then gender
      else 'Unknown'
    end as String) as gender,
  cast(region                 as String)     as region,
  cast(highest_education      as String)     as highest_education,
  cast(
    case
        when imd_band = '?' then null
        when imd_band not like '%\%%' then concat(imd_band, '%')
        else imd_band
    end as Nullable(String)) as imd_band,
  cast(age_band               as String)     as age_band,
  cast(num_of_prev_attempts   as Int64)      as num_of_prev_attempts,
  cast(studied_credits        as Int64)      as studied_credits,
  cast(disability             as String)     as disability,
  cast(final_result           as String)     as final_result
from `raw`.`grp5_oulad___student_info`
          )
        
        ...
[0m14:28:35.554373 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.43 seconds
[0m14:28:35.557074 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.43 seconds
[0m14:28:35.562476 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71d6b4f7-56f6-4403-acf5-13f9ac4298f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ba69d47790>]}
[0m14:28:35.573080 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_assessment"} */

    drop table if exists `clean`.`grp5_stg_oulad_student_assessment__dbt_backup` 
  ...
[0m14:28:35.576249 [info ] [Thread-1  ]: 5 of 7 OK created sql table model `sandbox`.`grp5_oulad_dim_student` ........... [[32mOK[0m in 2.31s]
[0m14:28:35.581494 [debug] [Thread-1  ]: Finished running node model.ex_09_oulad.grp5_oulad_dim_student
[0m14:28:35.699185 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.42 seconds
[0m14:28:35.707365 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_info: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_info"} */

    select name, type from system.columns where table = 'grp5_stg_oulad_student_info__dbt_backup'
    
      and database = 'clean'
    
    order by position
  ...
[0m14:28:36.067699 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.49 seconds
[0m14:28:36.070449 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.36 seconds
[0m14:28:36.077750 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71d6b4f7-56f6-4403-acf5-13f9ac4298f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ba695850a0>]}
[0m14:28:36.082590 [debug] [Thread-4  ]: Writing runtime sql for node "model.ex_09_oulad.grp5_stg_oulad_student_info"
[0m14:28:36.085440 [info ] [Thread-2  ]: 6 of 7 OK created sql table model `clean`.`grp5_stg_oulad_student_assessment` .. [[32mOK[0m in 2.58s]
[0m14:28:36.088497 [debug] [Thread-2  ]: Finished running node model.ex_09_oulad.grp5_stg_oulad_student_assessment
[0m14:28:36.091208 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_info: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_info"} */

  
    
    
    
        
         


        insert into `clean`.`grp5_stg_oulad_student_info__dbt_backup`
        ("code_module", "code_presentation", "id_student", "gender", "region", "highest_education", "imd_band", "age_band", "num_of_prev_attempts", "studied_credits", "disability", "final_result")
select
  cast(code_module            as String)     as code_module,
  cast(code_presentation      as String)     as code_presentation,
  cast(id_student             as Int64)      as id_student,
  cast(
    case
      when gender IN ('M', 'F') then gender
      else 'Unknown'
    end as String) as gender,
  cast(region                 as String)     as region,
  cast(highest_education      as String)     as highest_education,
  cast(
    case
        when imd_band = '?' then null
        when imd_band not like '%\%%' then concat(imd_band, '%')
        else imd_band
    end as Nullable(String)) as imd_band,
  cast(age_band               as String)     as age_band,
  cast(num_of_prev_attempts   as Int64)      as num_of_prev_attempts,
  cast(studied_credits        as Int64)      as studied_credits,
  cast(disability             as String)     as disability,
  cast(final_result           as String)     as final_result
from `raw`.`grp5_oulad___student_info`
  ...
[0m14:28:36.176534 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 1.07 seconds
[0m14:28:36.182250 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71d6b4f7-56f6-4403-acf5-13f9ac4298f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ba69cdc850>]}
[0m14:28:36.184215 [info ] [Thread-3  ]: 3 of 7 OK created sql table model `mart`.`grp5_oulad_dim_courses` .............. [[32mOK[0m in 4.60s]
[0m14:28:36.187385 [debug] [Thread-3  ]: Finished running node model.ex_09_oulad.grp5_oulad_dim_courses
[0m14:28:36.464303 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.37 seconds
[0m14:28:36.467506 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_info: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_info"} */
EXCHANGE TABLES `clean`.`grp5_stg_oulad_student_info__dbt_backup` AND `clean`.`grp5_stg_oulad_student_info` 
  
  ...
[0m14:28:36.934522 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.47 seconds
[0m14:28:36.945157 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_info: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_info"} */

    drop table if exists `clean`.`grp5_stg_oulad_student_info__dbt_backup` 
  ...
[0m14:28:37.318701 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.37 seconds
[0m14:28:37.322860 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71d6b4f7-56f6-4403-acf5-13f9ac4298f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ba68caf040>]}
[0m14:28:37.324748 [info ] [Thread-4  ]: 7 of 7 OK created sql table model `clean`.`grp5_stg_oulad_student_info` ........ [[32mOK[0m in 2.08s]
[0m14:28:37.326943 [debug] [Thread-4  ]: Finished running node model.ex_09_oulad.grp5_stg_oulad_student_info
[0m14:28:37.333086 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:28:37.336030 [debug] [MainThread]: Connection 'list__clean' was left open.
[0m14:28:37.338208 [debug] [MainThread]: On list__clean: Close
[0m14:28:37.339246 [debug] [MainThread]: Connection 'list__mart' was left open.
[0m14:28:37.340372 [debug] [MainThread]: On list__mart: Close
[0m14:28:37.341741 [debug] [MainThread]: Connection 'list_' was left open.
[0m14:28:37.343091 [debug] [MainThread]: On list_: Close
[0m14:28:37.344084 [debug] [MainThread]: Connection 'list__sandbox' was left open.
[0m14:28:37.345153 [debug] [MainThread]: On list__sandbox: Close
[0m14:28:37.346607 [debug] [MainThread]: Connection 'model.ex_09_oulad.grp5_oulad_dim_student' was left open.
[0m14:28:37.347574 [debug] [MainThread]: On model.ex_09_oulad.grp5_oulad_dim_student: Close
[0m14:28:37.348414 [debug] [MainThread]: Connection 'model.ex_09_oulad.grp5_stg_oulad_student_assessment' was left open.
[0m14:28:37.349404 [debug] [MainThread]: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: Close
[0m14:28:37.352443 [debug] [MainThread]: Connection 'model.ex_09_oulad.grp5_oulad_dim_courses' was left open.
[0m14:28:37.353836 [debug] [MainThread]: On model.ex_09_oulad.grp5_oulad_dim_courses: Close
[0m14:28:37.354835 [debug] [MainThread]: Connection 'model.ex_09_oulad.grp5_stg_oulad_student_info' was left open.
[0m14:28:37.355679 [debug] [MainThread]: On model.ex_09_oulad.grp5_stg_oulad_student_info: Close
[0m14:28:37.359141 [info ] [MainThread]: 
[0m14:28:37.360748 [info ] [MainThread]: Finished running 2 view models, 5 table models in 0 hours 0 minutes and 22.90 seconds (22.90s).
[0m14:28:37.367296 [debug] [MainThread]: Command end result
[0m14:28:37.662754 [info ] [MainThread]: 
[0m14:28:37.665285 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m14:28:37.671943 [info ] [MainThread]: 
[0m14:28:37.678501 [error] [MainThread]:   Database Error in model grp5_dq_oulad_studenVle_summary (models/mart/dq/grp5_dq_oulad_studenVle_summary.sql)
  HTTPDriver for http://54.87.106.52:8123 received ClickHouse error code 62
   Code: 62. DB::Exception: Syntax error: failed at position 2491 (end of query) (line 84, col 21): ;
      
    )
        
        
                      -- end_of_sql
                      
                      . Expected one of: token, Dot, OpeningRoundBracket, UUID, alias, AS, identifier, FINAL, SAMPLE, table, table function, subquery or list of joined tables, array join, LEFT ARRAY JOIN, INNER, ARRAY JOIN, JOIN, PREWHERE, WHERE, GROUP BY, WITH, HAVING, WINDOW, ORDER BY, LIMIT, OFFSET, FETCH, SETTINGS, UNION, EXCEPT, INTERSECT. (SYNTAX_ERROR) (version 23.12.6.19 (official build))
  compiled code at target/run/ex_09_oulad/models/mart/dq/grp5_dq_oulad_studenVle_summary.sql
[0m14:28:37.681107 [info ] [MainThread]: 
[0m14:28:37.684200 [error] [MainThread]:   Database Error in model grp5_dq_oulad_studentVle_anomalies (models/mart/dq/grp5_dq_oulad_studentVle_anomalies.sql)
  HTTPDriver for http://54.87.106.52:8123 received ClickHouse error code 62
   Code: 62. DB::Exception: Syntax error: failed at position 1994 (end of query) (line 53, col 9): ;
      
    )
        
        
                      -- end_of_sql
                      
                      . Expected one of: token, DoubleColon, OR, AND, IS NOT DISTINCT FROM, IS NULL, IS NOT NULL, BETWEEN, NOT BETWEEN, LIKE, ILIKE, NOT LIKE, NOT ILIKE, REGEXP, IN, NOT IN, GLOBAL IN, GLOBAL NOT IN, MOD, DIV, alias, AS, Comma, OFFSET, WITH TIES, BY, FETCH, LIMIT, SETTINGS, UNION, EXCEPT, INTERSECT. (SYNTAX_ERROR) (version 23.12.6.19 (official build))
  compiled code at target/run/ex_09_oulad/models/mart/dq/grp5_dq_oulad_studentVle_anomalies.sql
[0m14:28:37.696661 [info ] [MainThread]: 
[0m14:28:37.698890 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=0 TOTAL=7
[0m14:28:37.704926 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 27.562098, "process_in_blocks": "12160", "process_kernel_time": 2.887922, "process_mem_max_rss": "119804", "process_out_blocks": "10760", "process_user_time": 9.791396}
[0m14:28:37.707388 [debug] [MainThread]: Command `dbt build` failed at 14:28:37.706742 after 27.56 seconds
[0m14:28:37.709738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ba6f4e6e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ba6f42b430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ba68b75b20>]}
[0m14:28:37.722062 [debug] [MainThread]: Flushing usage events
[0m14:32:19.339748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b62b577cdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b62b23debe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b62b23dea90>]}


============================== 14:32:19.354394 | 517db240-09e5-4bc9-9cbd-a6e989f60efd ==============================
[0m14:32:19.354394 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:32:19.356665 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'introspect': 'True', 'use_colors': 'True', 'invocation_command': 'dbt build --profiles-dir . --target remote', 'indirect_selection': 'eager', 'no_print': 'None', 'use_experimental_parser': 'False', 'write_json': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'static_parser': 'True', 'printer_width': '80', 'log_path': '/workdir/transforms/09_oulad/logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '.', 'partial_parse': 'True', 'target_path': 'None', 'empty': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True'}
[0m14:32:19.896168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '517db240-09e5-4bc9-9cbd-a6e989f60efd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b62b4c15940>]}
[0m14:32:20.027254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '517db240-09e5-4bc9-9cbd-a6e989f60efd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b62b59b5370>]}
[0m14:32:20.029451 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m14:32:20.342246 [debug] [MainThread]: checksum: 265ce5244aff672775eaff93c261d21692ed3f5650f4d9e918c76acdb0e9479a, vars: {}, profile: , target: remote, version: 1.8.9
[0m14:32:20.663329 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m14:32:20.665014 [debug] [MainThread]: Partial parsing: updated file: ex_09_oulad://models/mart/dq/grp5_dq_oulad_studenVle_summary.sql
[0m14:32:20.666171 [debug] [MainThread]: Partial parsing: updated file: ex_09_oulad://models/mart/dq/grp5_dq_oulad_studentVle_anomalies.sql
[0m14:32:21.569345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '517db240-09e5-4bc9-9cbd-a6e989f60efd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b62b070d130>]}
[0m14:32:22.021592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '517db240-09e5-4bc9-9cbd-a6e989f60efd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b62b0790310>]}
[0m14:32:22.023026 [info ] [MainThread]: Found 7 models, 6 sources, 471 macros
[0m14:32:22.031934 [info ] [MainThread]: 
[0m14:32:22.037749 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m14:32:22.064045 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m14:32:22.073653 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m14:32:22.082105 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m14:32:22.149883 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:32:22.151389 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:32:22.169098 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:32:28.463019 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m14:32:28.469091 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m14:32:28.857715 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.39 seconds
[0m14:32:28.860072 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m14:32:28.863133 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.39 seconds
[0m14:32:29.444591 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.58 seconds
[0m14:32:29.451571 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__clean)
[0m14:32:29.454355 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__sandbox)
[0m14:32:29.456592 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__mart)
[0m14:32:29.480421 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list__clean"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'clean'
      

  ...
[0m14:32:29.488855 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__sandbox: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list__sandbox"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'sandbox'
      

  ...
[0m14:32:29.495547 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list__mart"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'mart'
      

  ...
[0m14:32:29.827924 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.32 seconds
[0m14:32:29.853599 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.36 seconds
[0m14:32:29.873411 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.37 seconds
[0m14:32:30.246147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '517db240-09e5-4bc9-9cbd-a6e989f60efd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b62b0441fa0>]}
[0m14:32:30.247470 [info ] [MainThread]: Concurrency: 4 threads (target='remote')
[0m14:32:30.248521 [info ] [MainThread]: 
[0m14:32:30.292417 [debug] [Thread-1  ]: Began running node model.ex_09_oulad.grp5_dq_oulad_studenVle_summary
[0m14:32:30.294020 [debug] [Thread-2  ]: Began running node model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies
[0m14:32:30.298130 [debug] [Thread-3  ]: Began running node model.ex_09_oulad.grp5_oulad_dim_courses
[0m14:32:30.300024 [debug] [Thread-4  ]: Began running node model.ex_09_oulad.grp5_oulad_dim_module_presentation
[0m14:32:30.296594 [info ] [Thread-1  ]: 1 of 7 START sql view model `mart`.`grp5_dq_oulad_studenVle_summary` ........... [RUN]
[0m14:32:30.302612 [info ] [Thread-2  ]: 2 of 7 START sql view model `mart`.`grp5_dq_oulad_studentVle_anomalies` ........ [RUN]
[0m14:32:30.305797 [info ] [Thread-3  ]: 3 of 7 START sql table model `mart`.`grp5_oulad_dim_courses` ................... [RUN]
[0m14:32:30.310068 [info ] [Thread-4  ]: 4 of 7 START sql table model `sandbox`.`grp5_oulad_dim_module_presentation` .... [RUN]
[0m14:32:30.314286 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.ex_09_oulad.grp5_dq_oulad_studenVle_summary'
[0m14:32:30.317840 [debug] [Thread-2  ]: Acquiring new clickhouse connection 'model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies'
[0m14:32:30.320545 [debug] [Thread-3  ]: Acquiring new clickhouse connection 'model.ex_09_oulad.grp5_oulad_dim_courses'
[0m14:32:30.323292 [debug] [Thread-4  ]: Acquiring new clickhouse connection 'model.ex_09_oulad.grp5_oulad_dim_module_presentation'
[0m14:32:30.325957 [debug] [Thread-1  ]: Began compiling node model.ex_09_oulad.grp5_dq_oulad_studenVle_summary
[0m14:32:30.327739 [debug] [Thread-2  ]: Began compiling node model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies
[0m14:32:30.329511 [debug] [Thread-3  ]: Began compiling node model.ex_09_oulad.grp5_oulad_dim_courses
[0m14:32:30.331291 [debug] [Thread-4  ]: Began compiling node model.ex_09_oulad.grp5_oulad_dim_module_presentation
[0m14:32:30.377014 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_09_oulad.grp5_dq_oulad_studenVle_summary"
[0m14:32:30.381410 [debug] [Thread-2  ]: Writing injected SQL for node "model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies"
[0m14:32:30.390762 [debug] [Thread-3  ]: Writing injected SQL for node "model.ex_09_oulad.grp5_oulad_dim_courses"
[0m14:32:30.400874 [debug] [Thread-4  ]: Writing injected SQL for node "model.ex_09_oulad.grp5_oulad_dim_module_presentation"
[0m14:32:30.404174 [debug] [Thread-1  ]: Began executing node model.ex_09_oulad.grp5_dq_oulad_studenVle_summary
[0m14:32:30.407827 [debug] [Thread-2  ]: Began executing node model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies
[0m14:32:30.421581 [debug] [Thread-3  ]: Began executing node model.ex_09_oulad.grp5_oulad_dim_courses
[0m14:32:30.447059 [debug] [Thread-4  ]: Began executing node model.ex_09_oulad.grp5_oulad_dim_module_presentation
[0m14:32:30.515778 [debug] [Thread-1  ]: Creating new relation grp5_dq_oulad_studenVle_summary
[0m14:32:30.564076 [debug] [Thread-2  ]: Creating new relation grp5_dq_oulad_studentVle_anomalies
[0m14:32:30.740581 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m14:32:30.743321 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m14:32:30.889837 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m14:32:30.894581 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m14:32:35.581669 [debug] [Thread-2  ]: Writing runtime sql for node "model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies"
[0m14:32:35.586260 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies"} */


  create view `mart`.`grp5_dq_oulad_studentVle_anomalies` 
  
    
    
  as (
    -- Path: ftw-de-bootcamp/dbt/transforms/09_oulad/models/mart/dq/grp5_dq_oulad_studentVle_anomalies.sql



with cln as (
    select * from `clean`.`grp5_stg_oulad_studentVle`
),

violations as (
    select
        id_student,
        code_module,
        code_presentation,
        id_site,
        date,
        sum_click,

        multiIf(
            id_student is null, 'null_id_student',
            code_module is null, 'null_code_module',
            code_presentation is null, 'null_code_presentation',
            sum_click is null, 'null_sum_click',
            sum_click < 0, 'negative_sum_click',
            date < 0, 'negative_date',
            NOT (
                (code_module='AAA' AND code_presentation='2013J') OR
                (code_module='AAA' AND code_presentation='2014J') OR
                (code_module='BBB' AND code_presentation='2013J') OR
                (code_module='BBB' AND code_presentation='2014J') OR
                (code_module='BBB' AND code_presentation='2013B') OR
                (code_module='BBB' AND code_presentation='2014B') OR
                (code_module='CCC' AND code_presentation='2014J') OR
                (code_module='CCC' AND code_presentation='2014B') OR
                (code_module='DDD' AND code_presentation='2013J') OR
                (code_module='DDD' AND code_presentation='2014J') OR
                (code_module='DDD' AND code_presentation='2013B') OR
                (code_module='DDD' AND code_presentation='2014B') OR
                (code_module='EEE' AND code_presentation='2013J') OR
                (code_module='EEE' AND code_presentation='2014J') OR
                (code_module='EEE' AND code_presentation='2014B') OR
                (code_module='FFF' AND code_presentation='2013J') OR
                (code_module='FFF' AND code_presentation='2014J') OR
                (code_module='FFF' AND code_presentation='2013B') OR
                (code_module='FFF' AND code_presentation='2014B') OR
                (code_module='GGG' AND code_presentation='2013J') OR
                (code_module='GGG' AND code_presentation='2014J') OR
                (code_module='GGG' AND code_presentation='2014B')
            ), 'invalid_module_presentation',
            'ok'
        ) as dq_issue
    from cln
)

select *
from violations
where dq_issue != 'ok'
limit 50;
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m14:32:35.606472 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_module_presentation: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_module_presentation"} */

            

    
        create table `sandbox`.`grp5_oulad_dim_module_presentation__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Dimension table for module + presentation (simple, with Nullable types)
select
    cast(code_module as Nullable(String))                           as code_module,
    cast(code_presentation as Nullable(String))                     as code_presentation,
    cast(module_presentation_length as Nullable(Int32))             as length_days
from `clean`.`grp5_stg_oulad_courses`
          )
        
        ...
[0m14:32:35.915142 [debug] [Thread-2  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies"} */


  create view `mart`.`grp5_dq_oulad_studentVle_anomalies` 
  
    
    
  as (
    -- Path: ftw-de-bootcamp/dbt/transforms/09_oulad/models/mart/dq/grp5_dq_oulad_studentVle_anomalies.sql



with cln as (
    select * from `clean`.`grp5_stg_oulad_studentVle`
),

violations as (
    select
        id_student,
        code_module,
        code_presentation,
        id_site,
        date,
        sum_click,

        multiIf(
            id_student is null, 'null_id_student',
            code_module is null, 'null_code_module',
            code_presentation is null, 'null_code_presentation',
            sum_click is null, 'null_sum_click',
            sum_click < 0, 'negative_sum_click',
            date < 0, 'negative_date',
            NOT (
                (code_module='AAA' AND code_presentation='2013J') OR
                (code_module='AAA' AND code_presentation='2014J') OR
                (code_module='BBB' AND code_presentation='2013J') OR
                (code_module='BBB' AND code_presentation='2014J') OR
                (code_module='BBB' AND code_presentation='2013B') OR
                (code_module='BBB' AND code_presentation='2014B') OR
                (code_module='CCC' AND code_presentation='2014J') OR
                (code_module='CCC' AND code_presentation='2014B') OR
                (code_module='DDD' AND code_presentation='2013J') OR
                (code_module='DDD' AND code_presentation='2014J') OR
                (code_module='DDD' AND code_presentation='2013B') OR
                (code_module='DDD' AND code_presentation='2014B') OR
                (code_module='EEE' AND code_presentation='2013J') OR
                (code_module='EEE' AND code_presentation='2014J') OR
                (code_module='EEE' AND code_presentation='2014B') OR
                (code_module='FFF' AND code_presentation='2013J') OR
                (code_module='FFF' AND code_presentation='2014J') OR
                (code_module='FFF' AND code_presentation='2013B') OR
                (code_module='FFF' AND code_presentation='2014B') OR
                (code_module='GGG' AND code_presentation='2013J') OR
                (code_module='GGG' AND code_presentation='2014J') OR
                (code_module='GGG' AND code_presentation='2014B')
            ), 'invalid_module_presentation',
            'ok'
        ) as dq_issue
    from cln
)

select *
from violations
where dq_issue != 'ok'
limit 50;
    
  )
      
      
                    -- end_of_sql
                    
                    
[0m14:32:35.941849 [debug] [Thread-2  ]: Database Error in model grp5_dq_oulad_studentVle_anomalies (models/mart/dq/grp5_dq_oulad_studentVle_anomalies.sql)
  HTTPDriver for http://54.87.106.52:8123 received ClickHouse error code 62
   Code: 62. DB::Exception: Syntax error: failed at position 2594 (end of query) (line 65, col 9): ;
      
    )
        
        
                      -- end_of_sql
                      
                      . Expected one of: token, DoubleColon, OR, AND, IS NOT DISTINCT FROM, IS NULL, IS NOT NULL, BETWEEN, NOT BETWEEN, LIKE, ILIKE, NOT LIKE, NOT ILIKE, REGEXP, IN, NOT IN, GLOBAL IN, GLOBAL NOT IN, MOD, DIV, alias, AS, Comma, OFFSET, WITH TIES, BY, FETCH, LIMIT, SETTINGS, UNION, EXCEPT, INTERSECT. (SYNTAX_ERROR) (version 23.12.6.19 (official build))
  compiled code at target/run/ex_09_oulad/models/mart/dq/grp5_dq_oulad_studentVle_anomalies.sql
[0m14:32:35.946444 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '517db240-09e5-4bc9-9cbd-a6e989f60efd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b62b00ac880>]}
[0m14:32:35.949519 [error] [Thread-2  ]: 2 of 7 ERROR creating sql view model `mart`.`grp5_dq_oulad_studentVle_anomalies`  [[31mERROR[0m in 5.63s]
[0m14:32:35.952661 [debug] [Thread-2  ]: Finished running node model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies
[0m14:32:35.954269 [debug] [Thread-2  ]: Began running node model.ex_09_oulad.grp5_oulad_dim_student
[0m14:32:35.956752 [info ] [Thread-2  ]: 5 of 7 START sql table model `sandbox`.`grp5_oulad_dim_student` ................ [RUN]
[0m14:32:35.959199 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies, now model.ex_09_oulad.grp5_oulad_dim_student)
[0m14:32:35.961598 [debug] [Thread-2  ]: Began compiling node model.ex_09_oulad.grp5_oulad_dim_student
[0m14:32:35.977539 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.37 seconds
[0m14:32:35.982240 [debug] [Thread-2  ]: Writing injected SQL for node "model.ex_09_oulad.grp5_oulad_dim_student"
[0m14:32:36.020769 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_module_presentation: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_module_presentation"} */

    select name, type from system.columns where table = 'grp5_oulad_dim_module_presentation__dbt_backup'
    
      and database = 'sandbox'
    
    order by position
  ...
[0m14:32:36.025998 [debug] [Thread-2  ]: Began executing node model.ex_09_oulad.grp5_oulad_dim_student
[0m14:32:36.047539 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_student: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_student"} */

            

    
        create table `sandbox`.`grp5_oulad_dim_student__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Dimension table for students (no surrogate key)
select
    cast(id_student as Int64)               as id_student,
    cast(gender as Nullable(String))        as gender,
    cast(age_band as Nullable(String))      as age_band,
    cast(region as Nullable(String))        as region,
    cast(highest_education as Nullable(String)) as highest_education,
    cast(imd_band as Nullable(String))      as imd_band,
    cast(disability as Nullable(String))    as disability
from `clean`.`grp5_stg_oulad_student_info`
          )
        
        ...
[0m14:32:36.292211 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_09_oulad.grp5_dq_oulad_studenVle_summary"
[0m14:32:36.295531 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_dq_oulad_studenVle_summary: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_dq_oulad_studenVle_summary"} */


  create view `mart`.`grp5_dq_oulad_studenVle_summary` 
  
    
    
  as (
    -- Path: ftw-de-bootcamp/dbt/transforms/09_oulad/models/mart/dq/grp5_dq_oulad_studenVle_summary.sql



with src as (
    select * from `raw`.`studentVle`
),
cln as (
    select * from `clean`.`grp5_stg_oulad_studentVle`
),

-- Row counts
counts as (
    select
        (select count(*) from src) as row_count_raw,
        (select count(*) from cln) as row_count_clean
),

-- Null value checks
nulls as (
    select
        round(100.0 * countIf(id_student is null) / nullif(count(),0),2) as pct_null_id_student,
        round(100.0 * countIf(code_module is null) / nullif(count(),0),2) as pct_null_code_module,
        round(100.0 * countIf(code_presentation is null) / nullif(count(),0),2) as pct_null_code_presentation,
        round(100.0 * countIf(sum_click is null) / nullif(count(),0),2) as pct_null_sum_click
    from cln
),

-- Domain validity (explicit OR conditions)
domains as (
    select
        countIf(
            NOT (
                (code_module='AAA' AND code_presentation='2013J') OR
                (code_module='AAA' AND code_presentation='2014J') OR
                (code_module='BBB' AND code_presentation='2013J') OR
                (code_module='BBB' AND code_presentation='2014J') OR
                (code_module='BBB' AND code_presentation='2013B') OR
                (code_module='BBB' AND code_presentation='2014B') OR
                (code_module='CCC' AND code_presentation='2014J') OR
                (code_module='CCC' AND code_presentation='2014B') OR
                (code_module='DDD' AND code_presentation='2013J') OR
                (code_module='DDD' AND code_presentation='2014J') OR
                (code_module='DDD' AND code_presentation='2013B') OR
                (code_module='DDD' AND code_presentation='2014B') OR
                (code_module='EEE' AND code_presentation='2013J') OR
                (code_module='EEE' AND code_presentation='2014J') OR
                (code_module='EEE' AND code_presentation='2014B') OR
                (code_module='FFF' AND code_presentation='2013J') OR
                (code_module='FFF' AND code_presentation='2014J') OR
                (code_module='FFF' AND code_presentation='2013B') OR
                (code_module='FFF' AND code_presentation='2014B') OR
                (code_module='GGG' AND code_presentation='2013J') OR
                (code_module='GGG' AND code_presentation='2014J') OR
                (code_module='GGG' AND code_presentation='2014B')
            )
        ) as invalid_module_presentation
    from cln
),

-- Bounds/logical checks
bounds as (
    select
        countIf(sum_click < 0) as negative_sum_click,
        countIf(date < 0) as negative_date
    from cln
),

-- Combine all metrics
joined as (
    select
        counts.row_count_raw,
        counts.row_count_clean,
        (counts.row_count_raw - counts.row_count_clean) as dropped_rows,

        nulls.pct_null_id_student,
        nulls.pct_null_code_module,
        nulls.pct_null_code_presentation,
        nulls.pct_null_sum_click,

        domains.invalid_module_presentation,

        bounds.negative_sum_click,
        bounds.negative_date
    from counts
    cross join nulls
    cross join domains
    cross join bounds
)

select * from joined;
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m14:32:36.323330 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_courses: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_courses"} */

            

    
        create table `mart`.`grp5_oulad_dim_courses__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

select
    concat(cast(code_module as Nullable(String)), cast(code_presentation as Nullable(String))) 
        as id_course,
    cast(code_module as Nullable(String))                           as code_module,
    cast(code_presentation as Nullable(String))                     as code_presentation,
    cast(module_presentation_length as Nullable(Int32))             as module_presentation_length
from `clean`.`grp5_stg_oulad_courses`
          )
        
        ...
[0m14:32:36.396875 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.37 seconds
[0m14:32:36.405168 [debug] [Thread-4  ]: Writing runtime sql for node "model.ex_09_oulad.grp5_oulad_dim_module_presentation"
[0m14:32:36.406914 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_module_presentation: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_module_presentation"} */

  
    
    
    
        
         


        insert into `sandbox`.`grp5_oulad_dim_module_presentation__dbt_backup`
        ("code_module", "code_presentation", "length_days")

-- Dimension table for module + presentation (simple, with Nullable types)
select
    cast(code_module as Nullable(String))                           as code_module,
    cast(code_presentation as Nullable(String))                     as code_presentation,
    cast(module_presentation_length as Nullable(Int32))             as length_days
from `clean`.`grp5_stg_oulad_courses`
  ...
[0m14:32:36.431466 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.38 seconds
[0m14:32:36.440458 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_student: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_student"} */

    select name, type from system.columns where table = 'grp5_oulad_dim_student__dbt_backup'
    
      and database = 'sandbox'
    
    order by position
  ...
[0m14:32:36.710254 [debug] [Thread-1  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_dq_oulad_studenVle_summary"} */


  create view `mart`.`grp5_dq_oulad_studenVle_summary` 
  
    
    
  as (
    -- Path: ftw-de-bootcamp/dbt/transforms/09_oulad/models/mart/dq/grp5_dq_oulad_studenVle_summary.sql



with src as (
    select * from `raw`.`studentVle`
),
cln as (
    select * from `clean`.`grp5_stg_oulad_studentVle`
),

-- Row counts
counts as (
    select
        (select count(*) from src) as row_count_raw,
        (select count(*) from cln) as row_count_clean
),

-- Null value checks
nulls as (
    select
        round(100.0 * countIf(id_student is null) / nullif(count(),0),2) as pct_null_id_student,
        round(100.0 * countIf(code_module is null) / nullif(count(),0),2) as pct_null_code_module,
        round(100.0 * countIf(code_presentation is null) / nullif(count(),0),2) as pct_null_code_presentation,
        round(100.0 * countIf(sum_click is null) / nullif(count(),0),2) as pct_null_sum_click
    from cln
),

-- Domain validity (explicit OR conditions)
domains as (
    select
        countIf(
            NOT (
                (code_module='AAA' AND code_presentation='2013J') OR
                (code_module='AAA' AND code_presentation='2014J') OR
                (code_module='BBB' AND code_presentation='2013J') OR
                (code_module='BBB' AND code_presentation='2014J') OR
                (code_module='BBB' AND code_presentation='2013B') OR
                (code_module='BBB' AND code_presentation='2014B') OR
                (code_module='CCC' AND code_presentation='2014J') OR
                (code_module='CCC' AND code_presentation='2014B') OR
                (code_module='DDD' AND code_presentation='2013J') OR
                (code_module='DDD' AND code_presentation='2014J') OR
                (code_module='DDD' AND code_presentation='2013B') OR
                (code_module='DDD' AND code_presentation='2014B') OR
                (code_module='EEE' AND code_presentation='2013J') OR
                (code_module='EEE' AND code_presentation='2014J') OR
                (code_module='EEE' AND code_presentation='2014B') OR
                (code_module='FFF' AND code_presentation='2013J') OR
                (code_module='FFF' AND code_presentation='2014J') OR
                (code_module='FFF' AND code_presentation='2013B') OR
                (code_module='FFF' AND code_presentation='2014B') OR
                (code_module='GGG' AND code_presentation='2013J') OR
                (code_module='GGG' AND code_presentation='2014J') OR
                (code_module='GGG' AND code_presentation='2014B')
            )
        ) as invalid_module_presentation
    from cln
),

-- Bounds/logical checks
bounds as (
    select
        countIf(sum_click < 0) as negative_sum_click,
        countIf(date < 0) as negative_date
    from cln
),

-- Combine all metrics
joined as (
    select
        counts.row_count_raw,
        counts.row_count_clean,
        (counts.row_count_raw - counts.row_count_clean) as dropped_rows,

        nulls.pct_null_id_student,
        nulls.pct_null_code_module,
        nulls.pct_null_code_presentation,
        nulls.pct_null_sum_click,

        domains.invalid_module_presentation,

        bounds.negative_sum_click,
        bounds.negative_date
    from counts
    cross join nulls
    cross join domains
    cross join bounds
)

select * from joined;
    
  )
      
      
                    -- end_of_sql
                    
                    
[0m14:32:36.713549 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.39 seconds
[0m14:32:36.724253 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_courses: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_courses"} */

    select name, type from system.columns where table = 'grp5_oulad_dim_courses__dbt_backup'
    
      and database = 'mart'
    
    order by position
  ...
[0m14:32:36.728782 [debug] [Thread-1  ]: Database Error in model grp5_dq_oulad_studenVle_summary (models/mart/dq/grp5_dq_oulad_studenVle_summary.sql)
  HTTPDriver for http://54.87.106.52:8123 received ClickHouse error code 62
   Code: 62. DB::Exception: Syntax error: failed at position 3481 (end of query) (line 99, col 21): ;
      
    )
        
        
                      -- end_of_sql
                      
                      . Expected one of: token, Dot, OpeningRoundBracket, UUID, alias, AS, identifier, FINAL, SAMPLE, table, table function, subquery or list of joined tables, array join, LEFT ARRAY JOIN, INNER, ARRAY JOIN, JOIN, PREWHERE, WHERE, GROUP BY, WITH, HAVING, WINDOW, ORDER BY, LIMIT, OFFSET, FETCH, SETTINGS, UNION, EXCEPT, INTERSECT. (SYNTAX_ERROR) (version 23.12.6.19 (official build))
  compiled code at target/run/ex_09_oulad/models/mart/dq/grp5_dq_oulad_studenVle_summary.sql
[0m14:32:36.731290 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '517db240-09e5-4bc9-9cbd-a6e989f60efd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b62af38edc0>]}
[0m14:32:36.736480 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.33 seconds
[0m14:32:36.734268 [error] [Thread-1  ]: 1 of 7 ERROR creating sql view model `mart`.`grp5_dq_oulad_studenVle_summary` .. [[31mERROR[0m in 6.42s]
[0m14:32:36.751300 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_module_presentation: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_module_presentation"} */
EXCHANGE TABLES `sandbox`.`grp5_oulad_dim_module_presentation__dbt_backup` AND `sandbox`.`grp5_oulad_dim_module_presentation` 
  
  ...
[0m14:32:36.753723 [debug] [Thread-1  ]: Finished running node model.ex_09_oulad.grp5_dq_oulad_studenVle_summary
[0m14:32:36.757785 [debug] [Thread-1  ]: Began running node model.ex_09_oulad.grp5_stg_oulad_student_assessment
[0m14:32:36.760610 [info ] [Thread-1  ]: 6 of 7 START sql table model `clean`.`grp5_stg_oulad_student_assessment` ....... [RUN]
[0m14:32:36.763292 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ex_09_oulad.grp5_dq_oulad_studenVle_summary, now model.ex_09_oulad.grp5_stg_oulad_student_assessment)
[0m14:32:36.765502 [debug] [Thread-1  ]: Began compiling node model.ex_09_oulad.grp5_stg_oulad_student_assessment
[0m14:32:36.779213 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_09_oulad.grp5_stg_oulad_student_assessment"
[0m14:32:36.781686 [debug] [Thread-1  ]: Began executing node model.ex_09_oulad.grp5_stg_oulad_student_assessment
[0m14:32:36.794752 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_assessment"} */

            

    
        create table `clean`.`grp5_stg_oulad_student_assessment__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
             

-- Standardize names and types for student assessment
select
  cast(id_assessment  as Nullable(Int64)) as assessment_id,
  cast(id_student     as Nullable(Int64)) as student_id,
  cast(date_submitted as Nullable(Int64)) as date_submitted,
  cast(is_banked      as Nullable(Int64)) as is_banked,
  cast(score          as Nullable(Int64)) as score
from `raw`.`grp5_oulad___student_assessment`
          )
        
        ...
[0m14:32:37.048148 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.61 seconds
[0m14:32:37.052992 [debug] [Thread-2  ]: Writing runtime sql for node "model.ex_09_oulad.grp5_oulad_dim_student"
[0m14:32:37.054889 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_student: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_student"} */

  
    
    
    
        
         


        insert into `sandbox`.`grp5_oulad_dim_student__dbt_backup`
        ("id_student", "gender", "age_band", "region", "highest_education", "imd_band", "disability")

-- Dimension table for students (no surrogate key)
select
    cast(id_student as Int64)               as id_student,
    cast(gender as Nullable(String))        as gender,
    cast(age_band as Nullable(String))      as age_band,
    cast(region as Nullable(String))        as region,
    cast(highest_education as Nullable(String)) as highest_education,
    cast(imd_band as Nullable(String))      as imd_band,
    cast(disability as Nullable(String))    as disability
from `clean`.`grp5_stg_oulad_student_info`
  ...
[0m14:32:37.070063 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.34 seconds
[0m14:32:37.074072 [debug] [Thread-3  ]: Writing runtime sql for node "model.ex_09_oulad.grp5_oulad_dim_courses"
[0m14:32:37.076028 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_courses: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_courses"} */

  
    
    
    
        
         


        insert into `mart`.`grp5_oulad_dim_courses__dbt_backup`
        ("id_course", "code_module", "code_presentation", "module_presentation_length")

select
    concat(cast(code_module as Nullable(String)), cast(code_presentation as Nullable(String))) 
        as id_course,
    cast(code_module as Nullable(String))                           as code_module,
    cast(code_presentation as Nullable(String))                     as code_presentation,
    cast(module_presentation_length as Nullable(Int32))             as module_presentation_length
from `clean`.`grp5_stg_oulad_courses`
  ...
[0m14:32:37.408272 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.65 seconds
[0m14:32:37.412558 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.62 seconds
[0m14:32:37.416128 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.34 seconds
[0m14:32:37.430085 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.37 seconds
[0m14:32:37.446528 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_assessment"} */

    select name, type from system.columns where table = 'grp5_stg_oulad_student_assessment__dbt_backup'
    
      and database = 'clean'
    
    order by position
  ...
[0m14:32:37.451273 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_courses: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_courses"} */
EXCHANGE TABLES `mart`.`grp5_oulad_dim_courses__dbt_backup` AND `mart`.`grp5_oulad_dim_courses` 
  
  ...
[0m14:32:37.467368 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_student: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_student"} */
EXCHANGE TABLES `sandbox`.`grp5_oulad_dim_student__dbt_backup` AND `sandbox`.`grp5_oulad_dim_student` 
  
  ...
[0m14:32:37.533574 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_module_presentation: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_module_presentation"} */

    drop table if exists `sandbox`.`grp5_oulad_dim_module_presentation__dbt_backup` 
  ...
[0m14:32:37.810752 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.32 seconds
[0m14:32:37.815157 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_09_oulad.grp5_stg_oulad_student_assessment"
[0m14:32:37.818088 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_assessment"} */

  
    
    
    
        
         


        insert into `clean`.`grp5_stg_oulad_student_assessment__dbt_backup`
        ("assessment_id", "student_id", "date_submitted", "is_banked", "score") 

-- Standardize names and types for student assessment
select
  cast(id_assessment  as Nullable(Int64)) as assessment_id,
  cast(id_student     as Nullable(Int64)) as student_id,
  cast(date_submitted as Nullable(Int64)) as date_submitted,
  cast(is_banked      as Nullable(Int64)) as is_banked,
  cast(score          as Nullable(Int64)) as score
from `raw`.`grp5_oulad___student_assessment`
  ...
[0m14:32:37.841644 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.33 seconds
[0m14:32:37.868516 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_courses: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_courses"} */

    drop table if exists `mart`.`grp5_oulad_dim_courses__dbt_backup` 
  ...
[0m14:32:38.152745 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.63 seconds
[0m14:32:38.162632 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_student: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_student"} */

    drop table if exists `sandbox`.`grp5_oulad_dim_student__dbt_backup` 
  ...
[0m14:32:38.165315 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.63 seconds
[0m14:32:38.174664 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '517db240-09e5-4bc9-9cbd-a6e989f60efd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b62b05ddbb0>]}
[0m14:32:38.177067 [info ] [Thread-4  ]: 4 of 7 OK created sql table model `sandbox`.`grp5_oulad_dim_module_presentation`  [[32mOK[0m in 7.85s]
[0m14:32:38.180519 [debug] [Thread-4  ]: Finished running node model.ex_09_oulad.grp5_oulad_dim_module_presentation
[0m14:32:38.182999 [debug] [Thread-4  ]: Began running node model.ex_09_oulad.grp5_stg_oulad_student_info
[0m14:32:38.185670 [info ] [Thread-4  ]: 7 of 7 START sql table model `clean`.`grp5_stg_oulad_student_info` ............. [RUN]
[0m14:32:38.187553 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.ex_09_oulad.grp5_oulad_dim_module_presentation, now model.ex_09_oulad.grp5_stg_oulad_student_info)
[0m14:32:38.189977 [debug] [Thread-4  ]: Began compiling node model.ex_09_oulad.grp5_stg_oulad_student_info
[0m14:32:38.202863 [debug] [Thread-4  ]: Writing injected SQL for node "model.ex_09_oulad.grp5_stg_oulad_student_info"
[0m14:32:38.204866 [debug] [Thread-4  ]: Began executing node model.ex_09_oulad.grp5_stg_oulad_student_info
[0m14:32:38.218880 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_info: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_info"} */

            

    
        create table `clean`.`grp5_stg_oulad_student_info__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            
select
  cast(code_module            as String)     as code_module,
  cast(code_presentation      as String)     as code_presentation,
  cast(id_student             as Int64)      as id_student,
  cast(
    case
      when gender IN ('M', 'F') then gender
      else 'Unknown'
    end as String) as gender,
  cast(region                 as String)     as region,
  cast(highest_education      as String)     as highest_education,
  cast(
    case
        when imd_band = '?' then null
        when imd_band not like '%\%%' then concat(imd_band, '%')
        else imd_band
    end as Nullable(String)) as imd_band,
  cast(age_band               as String)     as age_band,
  cast(num_of_prev_attempts   as Int64)      as num_of_prev_attempts,
  cast(studied_credits        as Int64)      as studied_credits,
  cast(disability             as String)     as disability,
  cast(final_result           as String)     as final_result
from `raw`.`grp5_oulad___student_info`
          )
        
        ...
[0m14:32:38.240072 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.42 seconds
[0m14:32:38.244863 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_assessment"} */
EXCHANGE TABLES `clean`.`grp5_stg_oulad_student_assessment__dbt_backup` AND `clean`.`grp5_stg_oulad_student_assessment` 
  
  ...
[0m14:32:38.271493 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.40 seconds
[0m14:32:38.276191 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '517db240-09e5-4bc9-9cbd-a6e989f60efd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b62b0727eb0>]}
[0m14:32:38.278061 [info ] [Thread-3  ]: 3 of 7 OK created sql table model `mart`.`grp5_oulad_dim_courses` .............. [[32mOK[0m in 7.96s]
[0m14:32:38.280248 [debug] [Thread-3  ]: Finished running node model.ex_09_oulad.grp5_oulad_dim_courses
[0m14:32:38.728663 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.56 seconds
[0m14:32:38.731500 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.48 seconds
[0m14:32:38.734200 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.51 seconds
[0m14:32:38.738743 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '517db240-09e5-4bc9-9cbd-a6e989f60efd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b62af0fcf70>]}
[0m14:32:38.750432 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_assessment"} */

    drop table if exists `clean`.`grp5_stg_oulad_student_assessment__dbt_backup` 
  ...
[0m14:32:38.762031 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_info: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_info"} */

    select name, type from system.columns where table = 'grp5_stg_oulad_student_info__dbt_backup'
    
      and database = 'clean'
    
    order by position
  ...
[0m14:32:38.764388 [info ] [Thread-2  ]: 5 of 7 OK created sql table model `sandbox`.`grp5_oulad_dim_student` ........... [[32mOK[0m in 2.78s]
[0m14:32:38.771855 [debug] [Thread-2  ]: Finished running node model.ex_09_oulad.grp5_oulad_dim_student
[0m14:32:39.139074 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.37 seconds
[0m14:32:39.141106 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.37 seconds
[0m14:32:39.145835 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '517db240-09e5-4bc9-9cbd-a6e989f60efd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b62af0173d0>]}
[0m14:32:39.151233 [debug] [Thread-4  ]: Writing runtime sql for node "model.ex_09_oulad.grp5_stg_oulad_student_info"
[0m14:32:39.153649 [info ] [Thread-1  ]: 6 of 7 OK created sql table model `clean`.`grp5_stg_oulad_student_assessment` .. [[32mOK[0m in 2.38s]
[0m14:32:39.157667 [debug] [Thread-1  ]: Finished running node model.ex_09_oulad.grp5_stg_oulad_student_assessment
[0m14:32:39.160429 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_info: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_info"} */

  
    
    
    
        
         


        insert into `clean`.`grp5_stg_oulad_student_info__dbt_backup`
        ("code_module", "code_presentation", "id_student", "gender", "region", "highest_education", "imd_band", "age_band", "num_of_prev_attempts", "studied_credits", "disability", "final_result")
select
  cast(code_module            as String)     as code_module,
  cast(code_presentation      as String)     as code_presentation,
  cast(id_student             as Int64)      as id_student,
  cast(
    case
      when gender IN ('M', 'F') then gender
      else 'Unknown'
    end as String) as gender,
  cast(region                 as String)     as region,
  cast(highest_education      as String)     as highest_education,
  cast(
    case
        when imd_band = '?' then null
        when imd_band not like '%\%%' then concat(imd_band, '%')
        else imd_band
    end as Nullable(String)) as imd_band,
  cast(age_band               as String)     as age_band,
  cast(num_of_prev_attempts   as Int64)      as num_of_prev_attempts,
  cast(studied_credits        as Int64)      as studied_credits,
  cast(disability             as String)     as disability,
  cast(final_result           as String)     as final_result
from `raw`.`grp5_oulad___student_info`
  ...
[0m14:32:39.690367 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.53 seconds
[0m14:32:39.693912 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_info: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_info"} */
EXCHANGE TABLES `clean`.`grp5_stg_oulad_student_info__dbt_backup` AND `clean`.`grp5_stg_oulad_student_info` 
  
  ...
[0m14:32:40.081206 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.39 seconds
[0m14:32:40.091031 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_info: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_info"} */

    drop table if exists `clean`.`grp5_stg_oulad_student_info__dbt_backup` 
  ...
[0m14:32:40.470380 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.38 seconds
[0m14:32:40.475184 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '517db240-09e5-4bc9-9cbd-a6e989f60efd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b62b1af1220>]}
[0m14:32:40.476953 [info ] [Thread-4  ]: 7 of 7 OK created sql table model `clean`.`grp5_stg_oulad_student_info` ........ [[32mOK[0m in 2.29s]
[0m14:32:40.479174 [debug] [Thread-4  ]: Finished running node model.ex_09_oulad.grp5_stg_oulad_student_info
[0m14:32:40.484183 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:32:40.485356 [debug] [MainThread]: Connection 'list__clean' was left open.
[0m14:32:40.486335 [debug] [MainThread]: On list__clean: Close
[0m14:32:40.487367 [debug] [MainThread]: Connection 'list__sandbox' was left open.
[0m14:32:40.489104 [debug] [MainThread]: On list__sandbox: Close
[0m14:32:40.490941 [debug] [MainThread]: Connection 'list__mart' was left open.
[0m14:32:40.492813 [debug] [MainThread]: On list__mart: Close
[0m14:32:40.494015 [debug] [MainThread]: Connection 'model.ex_09_oulad.grp5_stg_oulad_student_assessment' was left open.
[0m14:32:40.495300 [debug] [MainThread]: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: Close
[0m14:32:40.496826 [debug] [MainThread]: Connection 'model.ex_09_oulad.grp5_oulad_dim_student' was left open.
[0m14:32:40.498208 [debug] [MainThread]: On model.ex_09_oulad.grp5_oulad_dim_student: Close
[0m14:32:40.499686 [debug] [MainThread]: Connection 'model.ex_09_oulad.grp5_oulad_dim_courses' was left open.
[0m14:32:40.501697 [debug] [MainThread]: On model.ex_09_oulad.grp5_oulad_dim_courses: Close
[0m14:32:40.503222 [debug] [MainThread]: Connection 'model.ex_09_oulad.grp5_stg_oulad_student_info' was left open.
[0m14:32:40.504776 [debug] [MainThread]: On model.ex_09_oulad.grp5_stg_oulad_student_info: Close
[0m14:32:40.507410 [info ] [MainThread]: 
[0m14:32:40.509376 [info ] [MainThread]: Finished running 2 view models, 5 table models in 0 hours 0 minutes and 18.47 seconds (18.47s).
[0m14:32:40.519483 [debug] [MainThread]: Command end result
[0m14:32:40.613453 [info ] [MainThread]: 
[0m14:32:40.616121 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m14:32:40.617692 [info ] [MainThread]: 
[0m14:32:40.619407 [error] [MainThread]:   Database Error in model grp5_dq_oulad_studentVle_anomalies (models/mart/dq/grp5_dq_oulad_studentVle_anomalies.sql)
  HTTPDriver for http://54.87.106.52:8123 received ClickHouse error code 62
   Code: 62. DB::Exception: Syntax error: failed at position 2594 (end of query) (line 65, col 9): ;
      
    )
        
        
                      -- end_of_sql
                      
                      . Expected one of: token, DoubleColon, OR, AND, IS NOT DISTINCT FROM, IS NULL, IS NOT NULL, BETWEEN, NOT BETWEEN, LIKE, ILIKE, NOT LIKE, NOT ILIKE, REGEXP, IN, NOT IN, GLOBAL IN, GLOBAL NOT IN, MOD, DIV, alias, AS, Comma, OFFSET, WITH TIES, BY, FETCH, LIMIT, SETTINGS, UNION, EXCEPT, INTERSECT. (SYNTAX_ERROR) (version 23.12.6.19 (official build))
  compiled code at target/run/ex_09_oulad/models/mart/dq/grp5_dq_oulad_studentVle_anomalies.sql
[0m14:32:40.621461 [info ] [MainThread]: 
[0m14:32:40.623214 [error] [MainThread]:   Database Error in model grp5_dq_oulad_studenVle_summary (models/mart/dq/grp5_dq_oulad_studenVle_summary.sql)
  HTTPDriver for http://54.87.106.52:8123 received ClickHouse error code 62
   Code: 62. DB::Exception: Syntax error: failed at position 3481 (end of query) (line 99, col 21): ;
      
    )
        
        
                      -- end_of_sql
                      
                      . Expected one of: token, Dot, OpeningRoundBracket, UUID, alias, AS, identifier, FINAL, SAMPLE, table, table function, subquery or list of joined tables, array join, LEFT ARRAY JOIN, INNER, ARRAY JOIN, JOIN, PREWHERE, WHERE, GROUP BY, WITH, HAVING, WINDOW, ORDER BY, LIMIT, OFFSET, FETCH, SETTINGS, UNION, EXCEPT, INTERSECT. (SYNTAX_ERROR) (version 23.12.6.19 (official build))
  compiled code at target/run/ex_09_oulad/models/mart/dq/grp5_dq_oulad_studenVle_summary.sql
[0m14:32:40.625322 [info ] [MainThread]: 
[0m14:32:40.629121 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=0 TOTAL=7
[0m14:32:40.635728 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 21.554403, "process_in_blocks": "3456", "process_kernel_time": 2.009044, "process_mem_max_rss": "118628", "process_out_blocks": "10784", "process_user_time": 8.839794}
[0m14:32:40.637735 [debug] [MainThread]: Command `dbt build` failed at 14:32:40.637268 after 21.56 seconds
[0m14:32:40.639312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b62b577cdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b62b3712be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b62b0790f70>]}
[0m14:32:40.641153 [debug] [MainThread]: Flushing usage events
[0m14:38:14.619822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c8798a3310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c876503af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c8765039a0>]}


============================== 14:38:14.641154 | 98f789e2-77c5-4be7-9443-a72a3e5dac6c ==============================
[0m14:38:14.641154 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:38:14.644968 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'quiet': 'False', 'printer_width': '80', 'invocation_command': 'dbt build --profiles-dir . --target remote', 'introspect': 'True', 'warn_error': 'None', 'write_json': 'True', 'partial_parse': 'True', 'use_colors': 'True', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'no_print': 'None', 'static_parser': 'True', 'profiles_dir': '.', 'indirect_selection': 'eager', 'version_check': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'log_path': '/workdir/transforms/09_oulad/logs'}
[0m14:38:15.175714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '98f789e2-77c5-4be7-9443-a72a3e5dac6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c87641d4c0>]}
[0m14:38:15.344171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '98f789e2-77c5-4be7-9443-a72a3e5dac6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c876602ca0>]}
[0m14:38:15.346709 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m14:38:15.617907 [debug] [MainThread]: checksum: 265ce5244aff672775eaff93c261d21692ed3f5650f4d9e918c76acdb0e9479a, vars: {}, profile: , target: remote, version: 1.8.9
[0m14:38:16.069274 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m14:38:16.072270 [debug] [MainThread]: Partial parsing: updated file: ex_09_oulad://models/mart/dq/grp5_dq_oulad_studenVle_summary.sql
[0m14:38:16.073672 [debug] [MainThread]: Partial parsing: updated file: ex_09_oulad://models/mart/dq/grp5_dq_oulad_studentVle_anomalies.sql
[0m14:38:17.176328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '98f789e2-77c5-4be7-9443-a72a3e5dac6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c87484a130>]}
[0m14:38:17.550600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '98f789e2-77c5-4be7-9443-a72a3e5dac6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c8748c8700>]}
[0m14:38:17.552965 [info ] [MainThread]: Found 7 models, 6 sources, 471 macros
[0m14:38:17.561017 [info ] [MainThread]: 
[0m14:38:17.565157 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m14:38:17.598625 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m14:38:17.602455 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m14:38:17.611000 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m14:38:17.687962 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:38:17.694300 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:38:17.715452 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:38:23.581538 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m14:38:23.968127 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.38 seconds
[0m14:38:23.971571 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m14:38:24.406080 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m14:38:24.410278 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.43 seconds
[0m14:38:24.749062 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.34 seconds
[0m14:38:24.760376 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__mart)
[0m14:38:24.776317 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__clean)
[0m14:38:24.780871 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list__sandbox'
[0m14:38:24.805356 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list__mart"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'mart'
      

  ...
[0m14:38:24.818784 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list__clean"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'clean'
      

  ...
[0m14:38:24.822784 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:38:25.204630 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.38 seconds
[0m14:38:25.246929 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.42 seconds
[0m14:38:29.793739 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__sandbox: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list__sandbox"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'sandbox'
      

  ...
[0m14:38:30.175718 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.38 seconds
[0m14:38:30.323014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98f789e2-77c5-4be7-9443-a72a3e5dac6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c87475f670>]}
[0m14:38:30.325873 [info ] [MainThread]: Concurrency: 4 threads (target='remote')
[0m14:38:30.329510 [info ] [MainThread]: 
[0m14:38:30.426208 [debug] [Thread-2  ]: Began running node model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies
[0m14:38:30.429372 [debug] [Thread-3  ]: Began running node model.ex_09_oulad.grp5_oulad_dim_courses
[0m14:38:30.431349 [debug] [Thread-1  ]: Began running node model.ex_09_oulad.grp5_dq_oulad_studenVle_summary
[0m14:38:30.434502 [debug] [Thread-4  ]: Began running node model.ex_09_oulad.grp5_oulad_dim_module_presentation
[0m14:38:30.437657 [info ] [Thread-2  ]: 2 of 7 START sql view model `mart`.`grp5_dq_oulad_studentVle_anomalies` ........ [RUN]
[0m14:38:30.441665 [info ] [Thread-3  ]: 3 of 7 START sql table model `mart`.`grp5_oulad_dim_courses` ................... [RUN]
[0m14:38:30.446429 [info ] [Thread-1  ]: 1 of 7 START sql view model `mart`.`grp5_dq_oulad_studenVle_summary` ........... [RUN]
[0m14:38:30.450604 [info ] [Thread-4  ]: 4 of 7 START sql table model `sandbox`.`grp5_oulad_dim_module_presentation` .... [RUN]
[0m14:38:30.454049 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list__sandbox, now model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies)
[0m14:38:30.457481 [debug] [Thread-3  ]: Acquiring new clickhouse connection 'model.ex_09_oulad.grp5_oulad_dim_courses'
[0m14:38:30.461399 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.ex_09_oulad.grp5_dq_oulad_studenVle_summary'
[0m14:38:30.470349 [debug] [Thread-4  ]: Acquiring new clickhouse connection 'model.ex_09_oulad.grp5_oulad_dim_module_presentation'
[0m14:38:30.475611 [debug] [Thread-2  ]: Began compiling node model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies
[0m14:38:30.478640 [debug] [Thread-3  ]: Began compiling node model.ex_09_oulad.grp5_oulad_dim_courses
[0m14:38:30.481245 [debug] [Thread-1  ]: Began compiling node model.ex_09_oulad.grp5_dq_oulad_studenVle_summary
[0m14:38:30.484441 [debug] [Thread-4  ]: Began compiling node model.ex_09_oulad.grp5_oulad_dim_module_presentation
[0m14:38:30.608339 [debug] [Thread-2  ]: Writing injected SQL for node "model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies"
[0m14:38:30.630818 [debug] [Thread-4  ]: Writing injected SQL for node "model.ex_09_oulad.grp5_oulad_dim_module_presentation"
[0m14:38:30.646624 [debug] [Thread-3  ]: Writing injected SQL for node "model.ex_09_oulad.grp5_oulad_dim_courses"
[0m14:38:30.673402 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_09_oulad.grp5_dq_oulad_studenVle_summary"
[0m14:38:30.679431 [debug] [Thread-2  ]: Began executing node model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies
[0m14:38:30.683343 [debug] [Thread-4  ]: Began executing node model.ex_09_oulad.grp5_oulad_dim_module_presentation
[0m14:38:30.692822 [debug] [Thread-3  ]: Began executing node model.ex_09_oulad.grp5_oulad_dim_courses
[0m14:38:30.708989 [debug] [Thread-1  ]: Began executing node model.ex_09_oulad.grp5_dq_oulad_studenVle_summary
[0m14:38:31.095421 [debug] [Thread-2  ]: Creating new relation grp5_dq_oulad_studentVle_anomalies
[0m14:38:31.220148 [debug] [Thread-1  ]: Creating new relation grp5_dq_oulad_studenVle_summary
[0m14:38:31.472179 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m14:38:31.492757 [debug] [Thread-2  ]: Writing runtime sql for node "model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies"
[0m14:38:31.645201 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m14:38:31.653880 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m14:38:31.656753 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies"} */


  create view `mart`.`grp5_dq_oulad_studentVle_anomalies` 
  
    
    
  as (
    

with cln as (
    select * from `clean`.`grp5_stg_oulad_studentVle`
),

violations as (
    select
        id_student,
        code_module,
        code_presentation,
        id_site,
        date,
        sum_click,

        multiIf(
            id_student is null, 'null_id_student',
            code_module is null, 'null_code_module',
            code_presentation is null, 'null_code_presentation',
            sum_click is null, 'null_sum_click',
            sum_click < 0, 'negative_sum_click',
            date < 0, 'negative_date',
            NOT (
                (code_module='AAA' AND code_presentation='2013J') OR
                (code_module='AAA' AND code_presentation='2014J') OR
                (code_module='BBB' AND code_presentation='2013J') OR
                (code_module='BBB' AND code_presentation='2014J') OR
                (code_module='BBB' AND code_presentation='2013B') OR
                (code_module='BBB' AND code_presentation='2014B') OR
                (code_module='CCC' AND code_presentation='2014J') OR
                (code_module='CCC' AND code_presentation='2014B') OR
                (code_module='DDD' AND code_presentation='2013J') OR
                (code_module='DDD' AND code_presentation='2014J') OR
                (code_module='DDD' AND code_presentation='2013B') OR
                (code_module='DDD' AND code_presentation='2014B') OR
                (code_module='EEE' AND code_presentation='2013J') OR
                (code_module='EEE' AND code_presentation='2014J') OR
                (code_module='EEE' AND code_presentation='2014B') OR
                (code_module='FFF' AND code_presentation='2013J') OR
                (code_module='FFF' AND code_presentation='2014J') OR
                (code_module='FFF' AND code_presentation='2013B') OR
                (code_module='FFF' AND code_presentation='2014B') OR
                (code_module='GGG' AND code_presentation='2013J') OR
                (code_module='GGG' AND code_presentation='2014J') OR
                (code_module='GGG' AND code_presentation='2014B')
            ), 'invalid_module_presentation',
            'ok'
        ) as dq_issue
    from cln
)

select *
from violations
where dq_issue != 'ok'
limit 50;
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m14:38:32.699514 [debug] [Thread-2  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies"} */


  create view `mart`.`grp5_dq_oulad_studentVle_anomalies` 
  
    
    
  as (
    

with cln as (
    select * from `clean`.`grp5_stg_oulad_studentVle`
),

violations as (
    select
        id_student,
        code_module,
        code_presentation,
        id_site,
        date,
        sum_click,

        multiIf(
            id_student is null, 'null_id_student',
            code_module is null, 'null_code_module',
            code_presentation is null, 'null_code_presentation',
            sum_click is null, 'null_sum_click',
            sum_click < 0, 'negative_sum_click',
            date < 0, 'negative_date',
            NOT (
                (code_module='AAA' AND code_presentation='2013J') OR
                (code_module='AAA' AND code_presentation='2014J') OR
                (code_module='BBB' AND code_presentation='2013J') OR
                (code_module='BBB' AND code_presentation='2014J') OR
                (code_module='BBB' AND code_presentation='2013B') OR
                (code_module='BBB' AND code_presentation='2014B') OR
                (code_module='CCC' AND code_presentation='2014J') OR
                (code_module='CCC' AND code_presentation='2014B') OR
                (code_module='DDD' AND code_presentation='2013J') OR
                (code_module='DDD' AND code_presentation='2014J') OR
                (code_module='DDD' AND code_presentation='2013B') OR
                (code_module='DDD' AND code_presentation='2014B') OR
                (code_module='EEE' AND code_presentation='2013J') OR
                (code_module='EEE' AND code_presentation='2014J') OR
                (code_module='EEE' AND code_presentation='2014B') OR
                (code_module='FFF' AND code_presentation='2013J') OR
                (code_module='FFF' AND code_presentation='2014J') OR
                (code_module='FFF' AND code_presentation='2013B') OR
                (code_module='FFF' AND code_presentation='2014B') OR
                (code_module='GGG' AND code_presentation='2013J') OR
                (code_module='GGG' AND code_presentation='2014J') OR
                (code_module='GGG' AND code_presentation='2014B')
            ), 'invalid_module_presentation',
            'ok'
        ) as dq_issue
    from cln
)

select *
from violations
where dq_issue != 'ok'
limit 50;
    
  )
      
      
                    -- end_of_sql
                    
                    
[0m14:38:32.718022 [debug] [Thread-2  ]: Database Error in model grp5_dq_oulad_studentVle_anomalies (models/mart/dq/grp5_dq_oulad_studentVle_anomalies.sql)
  HTTPDriver for http://54.87.106.52:8123 received ClickHouse error code 62
   Code: 62. DB::Exception: Syntax error: failed at position 2490 (end of query) (line 63, col 9): ;
      
    )
        
        
                      -- end_of_sql
                      
                      . Expected one of: token, DoubleColon, OR, AND, IS NOT DISTINCT FROM, IS NULL, IS NOT NULL, BETWEEN, NOT BETWEEN, LIKE, ILIKE, NOT LIKE, NOT ILIKE, REGEXP, IN, NOT IN, GLOBAL IN, GLOBAL NOT IN, MOD, DIV, alias, AS, Comma, OFFSET, WITH TIES, BY, FETCH, LIMIT, SETTINGS, UNION, EXCEPT, INTERSECT. (SYNTAX_ERROR) (version 23.12.6.19 (official build))
  compiled code at target/run/ex_09_oulad/models/mart/dq/grp5_dq_oulad_studentVle_anomalies.sql
[0m14:38:32.722730 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98f789e2-77c5-4be7-9443-a72a3e5dac6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c874199ac0>]}
[0m14:38:32.725645 [error] [Thread-2  ]: 2 of 7 ERROR creating sql view model `mart`.`grp5_dq_oulad_studentVle_anomalies`  [[31mERROR[0m in 2.27s]
[0m14:38:32.728542 [debug] [Thread-2  ]: Finished running node model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies
[0m14:38:32.730547 [debug] [Thread-2  ]: Began running node model.ex_09_oulad.grp5_oulad_dim_student
[0m14:38:32.733626 [info ] [Thread-2  ]: 5 of 7 START sql table model `sandbox`.`grp5_oulad_dim_student` ................ [RUN]
[0m14:38:32.737018 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies, now model.ex_09_oulad.grp5_oulad_dim_student)
[0m14:38:32.740791 [debug] [Thread-2  ]: Began compiling node model.ex_09_oulad.grp5_oulad_dim_student
[0m14:38:32.754940 [debug] [Thread-2  ]: Writing injected SQL for node "model.ex_09_oulad.grp5_oulad_dim_student"
[0m14:38:32.757915 [debug] [Thread-2  ]: Began executing node model.ex_09_oulad.grp5_oulad_dim_student
[0m14:38:32.774591 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_student: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_student"} */

            

    
        create table `sandbox`.`grp5_oulad_dim_student__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Dimension table for students (no surrogate key)
select
    cast(id_student as Int64)               as id_student,
    cast(gender as Nullable(String))        as gender,
    cast(age_band as Nullable(String))      as age_band,
    cast(region as Nullable(String))        as region,
    cast(highest_education as Nullable(String)) as highest_education,
    cast(imd_band as Nullable(String))      as imd_band,
    cast(disability as Nullable(String))    as disability
from `clean`.`grp5_stg_oulad_student_info`
          )
        
        ...
[0m14:38:33.197453 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.42 seconds
[0m14:38:33.225599 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_student: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_student"} */

    select name, type from system.columns where table = 'grp5_oulad_dim_student__dbt_backup'
    
      and database = 'sandbox'
    
    order by position
  ...
[0m14:38:33.855359 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.63 seconds
[0m14:38:33.876818 [debug] [Thread-2  ]: Writing runtime sql for node "model.ex_09_oulad.grp5_oulad_dim_student"
[0m14:38:33.881485 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_student: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_student"} */

  
    
    
    
        
         


        insert into `sandbox`.`grp5_oulad_dim_student__dbt_backup`
        ("id_student", "gender", "age_band", "region", "highest_education", "imd_band", "disability")

-- Dimension table for students (no surrogate key)
select
    cast(id_student as Int64)               as id_student,
    cast(gender as Nullable(String))        as gender,
    cast(age_band as Nullable(String))      as age_band,
    cast(region as Nullable(String))        as region,
    cast(highest_education as Nullable(String)) as highest_education,
    cast(imd_band as Nullable(String))      as imd_band,
    cast(disability as Nullable(String))    as disability
from `clean`.`grp5_stg_oulad_student_info`
  ...
[0m14:38:34.274497 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.39 seconds
[0m14:38:34.296100 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_student: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_student"} */
EXCHANGE TABLES `sandbox`.`grp5_oulad_dim_student__dbt_backup` AND `sandbox`.`grp5_oulad_dim_student` 
  
  ...
[0m14:38:34.648161 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.35 seconds
[0m14:38:34.745270 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_student: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_student"} */

    drop table if exists `sandbox`.`grp5_oulad_dim_student__dbt_backup` 
  ...
[0m14:38:35.116240 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.37 seconds
[0m14:38:35.132868 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98f789e2-77c5-4be7-9443-a72a3e5dac6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c87454e550>]}
[0m14:38:35.136072 [info ] [Thread-2  ]: 5 of 7 OK created sql table model `sandbox`.`grp5_oulad_dim_student` ........... [[32mOK[0m in 2.39s]
[0m14:38:35.140342 [debug] [Thread-2  ]: Finished running node model.ex_09_oulad.grp5_oulad_dim_student
[0m14:38:35.143601 [debug] [Thread-2  ]: Began running node model.ex_09_oulad.grp5_stg_oulad_student_assessment
[0m14:38:35.146787 [info ] [Thread-2  ]: 6 of 7 START sql table model `clean`.`grp5_stg_oulad_student_assessment` ....... [RUN]
[0m14:38:35.150250 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ex_09_oulad.grp5_oulad_dim_student, now model.ex_09_oulad.grp5_stg_oulad_student_assessment)
[0m14:38:35.153276 [debug] [Thread-2  ]: Began compiling node model.ex_09_oulad.grp5_stg_oulad_student_assessment
[0m14:38:35.170893 [debug] [Thread-2  ]: Writing injected SQL for node "model.ex_09_oulad.grp5_stg_oulad_student_assessment"
[0m14:38:35.174432 [debug] [Thread-2  ]: Began executing node model.ex_09_oulad.grp5_stg_oulad_student_assessment
[0m14:38:35.196250 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_assessment"} */

            

    
        create table `clean`.`grp5_stg_oulad_student_assessment__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
             

-- Standardize names and types for student assessment
select
  cast(id_assessment  as Nullable(Int64)) as assessment_id,
  cast(id_student     as Nullable(Int64)) as student_id,
  cast(date_submitted as Nullable(Int64)) as date_submitted,
  cast(is_banked      as Nullable(Int64)) as is_banked,
  cast(score          as Nullable(Int64)) as score
from `raw`.`grp5_oulad___student_assessment`
          )
        
        ...
[0m14:38:35.734421 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.54 seconds
[0m14:38:35.753872 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_assessment"} */

    select name, type from system.columns where table = 'grp5_stg_oulad_student_assessment__dbt_backup'
    
      and database = 'clean'
    
    order by position
  ...
[0m14:38:36.448981 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.69 seconds
[0m14:38:36.454792 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_courses: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_courses"} */

            

    
        create table `mart`.`grp5_oulad_dim_courses__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

select
    concat(cast(code_module as Nullable(String)), cast(code_presentation as Nullable(String))) 
        as id_course,
    cast(code_module as Nullable(String))                           as code_module,
    cast(code_presentation as Nullable(String))                     as code_presentation,
    cast(module_presentation_length as Nullable(Int32))             as module_presentation_length
from `clean`.`grp5_stg_oulad_courses`
          )
        
        ...
[0m14:38:36.464933 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_09_oulad.grp5_dq_oulad_studenVle_summary"
[0m14:38:36.462702 [debug] [Thread-2  ]: Writing runtime sql for node "model.ex_09_oulad.grp5_stg_oulad_student_assessment"
[0m14:38:36.472684 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_assessment"} */

  
    
    
    
        
         


        insert into `clean`.`grp5_stg_oulad_student_assessment__dbt_backup`
        ("assessment_id", "student_id", "date_submitted", "is_banked", "score") 

-- Standardize names and types for student assessment
select
  cast(id_assessment  as Nullable(Int64)) as assessment_id,
  cast(id_student     as Nullable(Int64)) as student_id,
  cast(date_submitted as Nullable(Int64)) as date_submitted,
  cast(is_banked      as Nullable(Int64)) as is_banked,
  cast(score          as Nullable(Int64)) as score
from `raw`.`grp5_oulad___student_assessment`
  ...
[0m14:38:36.475045 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_dq_oulad_studenVle_summary: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_dq_oulad_studenVle_summary"} */


  create view `mart`.`grp5_dq_oulad_studenVle_summary` 
  
    
    
  as (
    

with src as (
    select * from `raw`.`studentVle`
),
cln as (
    select * from `clean`.`grp5_stg_oulad_studentVle`
),

-- Row counts
counts as (
    select
        (select count(*) from src) as row_count_raw,
        (select count(*) from cln) as row_count_clean
),

-- Null value checks
nulls as (
    select
        round(100.0 * countIf(id_student is null) / nullif(count(),0),2) as pct_null_id_student,
        round(100.0 * countIf(code_module is null) / nullif(count(),0),2) as pct_null_code_module,
        round(100.0 * countIf(code_presentation is null) / nullif(count(),0),2) as pct_null_code_presentation,
        round(100.0 * countIf(sum_click is null) / nullif(count(),0),2) as pct_null_sum_click
    from cln
),

-- Domain validity (explicit OR conditions)
domains as (
    select
        countIf(
            NOT (
                (code_module='AAA' AND code_presentation='2013J') OR
                (code_module='AAA' AND code_presentation='2014J') OR
                (code_module='BBB' AND code_presentation='2013J') OR
                (code_module='BBB' AND code_presentation='2014J') OR
                (code_module='BBB' AND code_presentation='2013B') OR
                (code_module='BBB' AND code_presentation='2014B') OR
                (code_module='CCC' AND code_presentation='2014J') OR
                (code_module='CCC' AND code_presentation='2014B') OR
                (code_module='DDD' AND code_presentation='2013J') OR
                (code_module='DDD' AND code_presentation='2014J') OR
                (code_module='DDD' AND code_presentation='2013B') OR
                (code_module='DDD' AND code_presentation='2014B') OR
                (code_module='EEE' AND code_presentation='2013J') OR
                (code_module='EEE' AND code_presentation='2014J') OR
                (code_module='EEE' AND code_presentation='2014B') OR
                (code_module='FFF' AND code_presentation='2013J') OR
                (code_module='FFF' AND code_presentation='2014J') OR
                (code_module='FFF' AND code_presentation='2013B') OR
                (code_module='FFF' AND code_presentation='2014B') OR
                (code_module='GGG' AND code_presentation='2013J') OR
                (code_module='GGG' AND code_presentation='2014J') OR
                (code_module='GGG' AND code_presentation='2014B')
            )
        ) as invalid_module_presentation
    from cln
),

-- Bounds/logical checks
bounds as (
    select
        countIf(sum_click < 0) as negative_sum_click,
        countIf(date < 0) as negative_date
    from cln
),

-- Combine all metrics
joined as (
    select
        counts.row_count_raw,
        counts.row_count_clean,
        (counts.row_count_raw - counts.row_count_clean) as dropped_rows,

        nulls.pct_null_id_student,
        nulls.pct_null_code_module,
        nulls.pct_null_code_presentation,
        nulls.pct_null_sum_click,

        domains.invalid_module_presentation,

        bounds.negative_sum_click,
        bounds.negative_date
    from counts
    cross join nulls
    cross join domains
    cross join bounds
)

select * from joined;
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m14:38:36.789125 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_module_presentation: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_module_presentation"} */

            

    
        create table `sandbox`.`grp5_oulad_dim_module_presentation__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Dimension table for module + presentation (simple, with Nullable types)
select
    cast(code_module as Nullable(String))                           as code_module,
    cast(code_presentation as Nullable(String))                     as code_presentation,
    cast(module_presentation_length as Nullable(Int32))             as length_days
from `clean`.`grp5_stg_oulad_courses`
          )
        
        ...
[0m14:38:36.797029 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.33 seconds
[0m14:38:36.818882 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_courses: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_courses"} */

    select name, type from system.columns where table = 'grp5_oulad_dim_courses__dbt_backup'
    
      and database = 'mart'
    
    order by position
  ...
[0m14:38:36.823171 [debug] [Thread-1  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_dq_oulad_studenVle_summary"} */


  create view `mart`.`grp5_dq_oulad_studenVle_summary` 
  
    
    
  as (
    

with src as (
    select * from `raw`.`studentVle`
),
cln as (
    select * from `clean`.`grp5_stg_oulad_studentVle`
),

-- Row counts
counts as (
    select
        (select count(*) from src) as row_count_raw,
        (select count(*) from cln) as row_count_clean
),

-- Null value checks
nulls as (
    select
        round(100.0 * countIf(id_student is null) / nullif(count(),0),2) as pct_null_id_student,
        round(100.0 * countIf(code_module is null) / nullif(count(),0),2) as pct_null_code_module,
        round(100.0 * countIf(code_presentation is null) / nullif(count(),0),2) as pct_null_code_presentation,
        round(100.0 * countIf(sum_click is null) / nullif(count(),0),2) as pct_null_sum_click
    from cln
),

-- Domain validity (explicit OR conditions)
domains as (
    select
        countIf(
            NOT (
                (code_module='AAA' AND code_presentation='2013J') OR
                (code_module='AAA' AND code_presentation='2014J') OR
                (code_module='BBB' AND code_presentation='2013J') OR
                (code_module='BBB' AND code_presentation='2014J') OR
                (code_module='BBB' AND code_presentation='2013B') OR
                (code_module='BBB' AND code_presentation='2014B') OR
                (code_module='CCC' AND code_presentation='2014J') OR
                (code_module='CCC' AND code_presentation='2014B') OR
                (code_module='DDD' AND code_presentation='2013J') OR
                (code_module='DDD' AND code_presentation='2014J') OR
                (code_module='DDD' AND code_presentation='2013B') OR
                (code_module='DDD' AND code_presentation='2014B') OR
                (code_module='EEE' AND code_presentation='2013J') OR
                (code_module='EEE' AND code_presentation='2014J') OR
                (code_module='EEE' AND code_presentation='2014B') OR
                (code_module='FFF' AND code_presentation='2013J') OR
                (code_module='FFF' AND code_presentation='2014J') OR
                (code_module='FFF' AND code_presentation='2013B') OR
                (code_module='FFF' AND code_presentation='2014B') OR
                (code_module='GGG' AND code_presentation='2013J') OR
                (code_module='GGG' AND code_presentation='2014J') OR
                (code_module='GGG' AND code_presentation='2014B')
            )
        ) as invalid_module_presentation
    from cln
),

-- Bounds/logical checks
bounds as (
    select
        countIf(sum_click < 0) as negative_sum_click,
        countIf(date < 0) as negative_date
    from cln
),

-- Combine all metrics
joined as (
    select
        counts.row_count_raw,
        counts.row_count_clean,
        (counts.row_count_raw - counts.row_count_clean) as dropped_rows,

        nulls.pct_null_id_student,
        nulls.pct_null_code_module,
        nulls.pct_null_code_presentation,
        nulls.pct_null_sum_click,

        domains.invalid_module_presentation,

        bounds.negative_sum_click,
        bounds.negative_date
    from counts
    cross join nulls
    cross join domains
    cross join bounds
)

select * from joined;
    
  )
      
      
                    -- end_of_sql
                    
                    
[0m14:38:36.840004 [debug] [Thread-1  ]: Database Error in model grp5_dq_oulad_studenVle_summary (models/mart/dq/grp5_dq_oulad_studenVle_summary.sql)
  HTTPDriver for http://54.87.106.52:8123 received ClickHouse error code 62
   Code: 62. DB::Exception: Syntax error: failed at position 3380 (end of query) (line 97, col 21): ;
      
    )
        
        
                      -- end_of_sql
                      
                      . Expected one of: token, Dot, OpeningRoundBracket, UUID, alias, AS, identifier, FINAL, SAMPLE, table, table function, subquery or list of joined tables, array join, LEFT ARRAY JOIN, INNER, ARRAY JOIN, JOIN, PREWHERE, WHERE, GROUP BY, WITH, HAVING, WINDOW, ORDER BY, LIMIT, OFFSET, FETCH, SETTINGS, UNION, EXCEPT, INTERSECT. (SYNTAX_ERROR) (version 23.12.6.19 (official build))
  compiled code at target/run/ex_09_oulad/models/mart/dq/grp5_dq_oulad_studenVle_summary.sql
[0m14:38:36.844802 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98f789e2-77c5-4be7-9443-a72a3e5dac6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c8744cb4f0>]}
[0m14:38:36.850688 [error] [Thread-1  ]: 1 of 7 ERROR creating sql view model `mart`.`grp5_dq_oulad_studenVle_summary` .. [[31mERROR[0m in 6.38s]
[0m14:38:36.854484 [debug] [Thread-1  ]: Finished running node model.ex_09_oulad.grp5_dq_oulad_studenVle_summary
[0m14:38:36.856452 [debug] [Thread-1  ]: Began running node model.ex_09_oulad.grp5_stg_oulad_student_info
[0m14:38:36.859224 [info ] [Thread-1  ]: 7 of 7 START sql table model `clean`.`grp5_stg_oulad_student_info` ............. [RUN]
[0m14:38:36.862379 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ex_09_oulad.grp5_dq_oulad_studenVle_summary, now model.ex_09_oulad.grp5_stg_oulad_student_info)
[0m14:38:36.866704 [debug] [Thread-1  ]: Began compiling node model.ex_09_oulad.grp5_stg_oulad_student_info
[0m14:38:36.888011 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_09_oulad.grp5_stg_oulad_student_info"
[0m14:38:36.890662 [debug] [Thread-1  ]: Began executing node model.ex_09_oulad.grp5_stg_oulad_student_info
[0m14:38:36.909771 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.43 seconds
[0m14:38:36.924925 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_info: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_info"} */

            

    
        create table `clean`.`grp5_stg_oulad_student_info__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            
select
  cast(code_module            as String)     as code_module,
  cast(code_presentation      as String)     as code_presentation,
  cast(id_student             as Int64)      as id_student,
  cast(
    case
      when gender IN ('M', 'F') then gender
      else 'Unknown'
    end as String) as gender,
  cast(region                 as String)     as region,
  cast(highest_education      as String)     as highest_education,
  cast(
    case
        when imd_band = '?' then null
        when imd_band not like '%\%%' then concat(imd_band, '%')
        else imd_band
    end as Nullable(String)) as imd_band,
  cast(age_band               as String)     as age_band,
  cast(num_of_prev_attempts   as Int64)      as num_of_prev_attempts,
  cast(studied_credits        as Int64)      as studied_credits,
  cast(disability             as String)     as disability,
  cast(final_result           as String)     as final_result
from `raw`.`grp5_oulad___student_info`
          )
        
        ...
[0m14:38:36.921856 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_assessment"} */
EXCHANGE TABLES `clean`.`grp5_stg_oulad_student_assessment__dbt_backup` AND `clean`.`grp5_stg_oulad_student_assessment` 
  
  ...
[0m14:38:37.177330 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.38 seconds
[0m14:38:37.185540 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_module_presentation: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_module_presentation"} */

    select name, type from system.columns where table = 'grp5_oulad_dim_module_presentation__dbt_backup'
    
      and database = 'sandbox'
    
    order by position
  ...
[0m14:38:37.396387 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.57 seconds
[0m14:38:37.403402 [debug] [Thread-3  ]: Writing runtime sql for node "model.ex_09_oulad.grp5_oulad_dim_courses"
[0m14:38:37.407150 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.48 seconds
[0m14:38:37.410421 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.48 seconds
[0m14:38:37.420269 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_info: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_info"} */

    select name, type from system.columns where table = 'grp5_stg_oulad_student_info__dbt_backup'
    
      and database = 'clean'
    
    order by position
  ...
[0m14:38:37.434699 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_courses: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_courses"} */

  
    
    
    
        
         


        insert into `mart`.`grp5_oulad_dim_courses__dbt_backup`
        ("id_course", "code_module", "code_presentation", "module_presentation_length")

select
    concat(cast(code_module as Nullable(String)), cast(code_presentation as Nullable(String))) 
        as id_course,
    cast(code_module as Nullable(String))                           as code_module,
    cast(code_presentation as Nullable(String))                     as code_presentation,
    cast(module_presentation_length as Nullable(Int32))             as module_presentation_length
from `clean`.`grp5_stg_oulad_courses`
  ...
[0m14:38:37.445529 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_assessment"} */

    drop table if exists `clean`.`grp5_stg_oulad_student_assessment__dbt_backup` 
  ...
[0m14:38:37.748226 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.56 seconds
[0m14:38:37.755876 [debug] [Thread-4  ]: Writing runtime sql for node "model.ex_09_oulad.grp5_oulad_dim_module_presentation"
[0m14:38:37.758412 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_module_presentation: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_module_presentation"} */

  
    
    
    
        
         


        insert into `sandbox`.`grp5_oulad_dim_module_presentation__dbt_backup`
        ("code_module", "code_presentation", "length_days")

-- Dimension table for module + presentation (simple, with Nullable types)
select
    cast(code_module as Nullable(String))                           as code_module,
    cast(code_presentation as Nullable(String))                     as code_presentation,
    cast(module_presentation_length as Nullable(Int32))             as length_days
from `clean`.`grp5_stg_oulad_courses`
  ...
[0m14:38:37.778344 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.34 seconds
[0m14:38:37.784382 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_09_oulad.grp5_stg_oulad_student_info"
[0m14:38:37.788281 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_info: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_info"} */

  
    
    
    
        
         


        insert into `clean`.`grp5_stg_oulad_student_info__dbt_backup`
        ("code_module", "code_presentation", "id_student", "gender", "region", "highest_education", "imd_band", "age_band", "num_of_prev_attempts", "studied_credits", "disability", "final_result")
select
  cast(code_module            as String)     as code_module,
  cast(code_presentation      as String)     as code_presentation,
  cast(id_student             as Int64)      as id_student,
  cast(
    case
      when gender IN ('M', 'F') then gender
      else 'Unknown'
    end as String) as gender,
  cast(region                 as String)     as region,
  cast(highest_education      as String)     as highest_education,
  cast(
    case
        when imd_band = '?' then null
        when imd_band not like '%\%%' then concat(imd_band, '%')
        else imd_band
    end as Nullable(String)) as imd_band,
  cast(age_band               as String)     as age_band,
  cast(num_of_prev_attempts   as Int64)      as num_of_prev_attempts,
  cast(studied_credits        as Int64)      as studied_credits,
  cast(disability             as String)     as disability,
  cast(final_result           as String)     as final_result
from `raw`.`grp5_oulad___student_info`
  ...
[0m14:38:38.113878 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.67 seconds
[0m14:38:38.117079 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.67 seconds
[0m14:38:38.120137 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.36 seconds
[0m14:38:38.123918 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_courses: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_courses"} */
EXCHANGE TABLES `mart`.`grp5_oulad_dim_courses__dbt_backup` AND `mart`.`grp5_oulad_dim_courses` 
  
  ...
[0m14:38:38.129789 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98f789e2-77c5-4be7-9443-a72a3e5dac6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c873edcfd0>]}
[0m14:38:38.133435 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_module_presentation: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_module_presentation"} */
EXCHANGE TABLES `sandbox`.`grp5_oulad_dim_module_presentation__dbt_backup` AND `sandbox`.`grp5_oulad_dim_module_presentation` 
  
  ...
[0m14:38:38.140289 [info ] [Thread-2  ]: 6 of 7 OK created sql table model `clean`.`grp5_stg_oulad_student_assessment` .. [[32mOK[0m in 2.98s]
[0m14:38:38.144978 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.35 seconds
[0m14:38:38.151158 [debug] [Thread-2  ]: Finished running node model.ex_09_oulad.grp5_stg_oulad_student_assessment
[0m14:38:38.158916 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_info: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_info"} */
EXCHANGE TABLES `clean`.`grp5_stg_oulad_student_info__dbt_backup` AND `clean`.`grp5_stg_oulad_student_info` 
  
  ...
[0m14:38:38.535749 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.39 seconds
[0m14:38:38.538814 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.40 seconds
[0m14:38:38.552964 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_module_presentation: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_module_presentation"} */

    drop table if exists `sandbox`.`grp5_oulad_dim_module_presentation__dbt_backup` 
  ...
[0m14:38:38.569681 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_courses: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_courses"} */

    drop table if exists `mart`.`grp5_oulad_dim_courses__dbt_backup` 
  ...
[0m14:38:38.571642 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.41 seconds
[0m14:38:38.586688 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_info: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_info"} */

    drop table if exists `clean`.`grp5_stg_oulad_student_info__dbt_backup` 
  ...
[0m14:38:38.966317 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.39 seconds
[0m14:38:38.970127 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.39 seconds
[0m14:38:38.978795 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98f789e2-77c5-4be7-9443-a72a3e5dac6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c8742c5dc0>]}
[0m14:38:38.984875 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98f789e2-77c5-4be7-9443-a72a3e5dac6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c8742c5340>]}
[0m14:38:38.988188 [info ] [Thread-4  ]: 4 of 7 OK created sql table model `sandbox`.`grp5_oulad_dim_module_presentation`  [[32mOK[0m in 8.51s]
[0m14:38:38.992513 [info ] [Thread-3  ]: 3 of 7 OK created sql table model `mart`.`grp5_oulad_dim_courses` .............. [[32mOK[0m in 8.53s]
[0m14:38:38.998303 [debug] [Thread-4  ]: Finished running node model.ex_09_oulad.grp5_oulad_dim_module_presentation
[0m14:38:39.002501 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.41 seconds
[0m14:38:39.007165 [debug] [Thread-3  ]: Finished running node model.ex_09_oulad.grp5_oulad_dim_courses
[0m14:38:39.015375 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98f789e2-77c5-4be7-9443-a72a3e5dac6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c873253df0>]}
[0m14:38:39.019560 [info ] [Thread-1  ]: 7 of 7 OK created sql table model `clean`.`grp5_stg_oulad_student_info` ........ [[32mOK[0m in 2.15s]
[0m14:38:39.022866 [debug] [Thread-1  ]: Finished running node model.ex_09_oulad.grp5_stg_oulad_student_info
[0m14:38:39.028848 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:38:39.030904 [debug] [MainThread]: Connection 'list__mart' was left open.
[0m14:38:39.032653 [debug] [MainThread]: On list__mart: Close
[0m14:38:39.034558 [debug] [MainThread]: Connection 'list__clean' was left open.
[0m14:38:39.036378 [debug] [MainThread]: On list__clean: Close
[0m14:38:39.037682 [debug] [MainThread]: Connection 'list_' was left open.
[0m14:38:39.038982 [debug] [MainThread]: On list_: Close
[0m14:38:39.039924 [debug] [MainThread]: Connection 'model.ex_09_oulad.grp5_stg_oulad_student_assessment' was left open.
[0m14:38:39.040911 [debug] [MainThread]: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: Close
[0m14:38:39.041816 [debug] [MainThread]: Connection 'model.ex_09_oulad.grp5_oulad_dim_courses' was left open.
[0m14:38:39.042805 [debug] [MainThread]: On model.ex_09_oulad.grp5_oulad_dim_courses: Close
[0m14:38:39.043663 [debug] [MainThread]: Connection 'model.ex_09_oulad.grp5_stg_oulad_student_info' was left open.
[0m14:38:39.044503 [debug] [MainThread]: On model.ex_09_oulad.grp5_stg_oulad_student_info: Close
[0m14:38:39.046008 [debug] [MainThread]: Connection 'model.ex_09_oulad.grp5_oulad_dim_module_presentation' was left open.
[0m14:38:39.047762 [debug] [MainThread]: On model.ex_09_oulad.grp5_oulad_dim_module_presentation: Close
[0m14:38:39.050550 [info ] [MainThread]: 
[0m14:38:39.052787 [info ] [MainThread]: Finished running 2 view models, 5 table models in 0 hours 0 minutes and 21.49 seconds (21.49s).
[0m14:38:39.059648 [debug] [MainThread]: Command end result
[0m14:38:39.159894 [info ] [MainThread]: 
[0m14:38:39.161261 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m14:38:39.162875 [info ] [MainThread]: 
[0m14:38:39.165463 [error] [MainThread]:   Database Error in model grp5_dq_oulad_studentVle_anomalies (models/mart/dq/grp5_dq_oulad_studentVle_anomalies.sql)
  HTTPDriver for http://54.87.106.52:8123 received ClickHouse error code 62
   Code: 62. DB::Exception: Syntax error: failed at position 2490 (end of query) (line 63, col 9): ;
      
    )
        
        
                      -- end_of_sql
                      
                      . Expected one of: token, DoubleColon, OR, AND, IS NOT DISTINCT FROM, IS NULL, IS NOT NULL, BETWEEN, NOT BETWEEN, LIKE, ILIKE, NOT LIKE, NOT ILIKE, REGEXP, IN, NOT IN, GLOBAL IN, GLOBAL NOT IN, MOD, DIV, alias, AS, Comma, OFFSET, WITH TIES, BY, FETCH, LIMIT, SETTINGS, UNION, EXCEPT, INTERSECT. (SYNTAX_ERROR) (version 23.12.6.19 (official build))
  compiled code at target/run/ex_09_oulad/models/mart/dq/grp5_dq_oulad_studentVle_anomalies.sql
[0m14:38:39.168244 [info ] [MainThread]: 
[0m14:38:39.171061 [error] [MainThread]:   Database Error in model grp5_dq_oulad_studenVle_summary (models/mart/dq/grp5_dq_oulad_studenVle_summary.sql)
  HTTPDriver for http://54.87.106.52:8123 received ClickHouse error code 62
   Code: 62. DB::Exception: Syntax error: failed at position 3380 (end of query) (line 97, col 21): ;
      
    )
        
        
                      -- end_of_sql
                      
                      . Expected one of: token, Dot, OpeningRoundBracket, UUID, alias, AS, identifier, FINAL, SAMPLE, table, table function, subquery or list of joined tables, array join, LEFT ARRAY JOIN, INNER, ARRAY JOIN, JOIN, PREWHERE, WHERE, GROUP BY, WITH, HAVING, WINDOW, ORDER BY, LIMIT, OFFSET, FETCH, SETTINGS, UNION, EXCEPT, INTERSECT. (SYNTAX_ERROR) (version 23.12.6.19 (official build))
  compiled code at target/run/ex_09_oulad/models/mart/dq/grp5_dq_oulad_studenVle_summary.sql
[0m14:38:39.173972 [info ] [MainThread]: 
[0m14:38:39.176603 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=0 TOTAL=7
[0m14:38:39.184249 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 24.763315, "process_in_blocks": "2928", "process_kernel_time": 3.081934, "process_mem_max_rss": "118520", "process_out_blocks": "10784", "process_user_time": 11.834303}
[0m14:38:39.186204 [debug] [MainThread]: Command `dbt build` failed at 14:38:39.185461 after 24.77 seconds
[0m14:38:39.187742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c8798a3310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c876602ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76c87783bd00>]}
[0m14:38:39.189294 [debug] [MainThread]: Flushing usage events
[0m14:45:05.216815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b9f4096e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b9f0d00be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b9f0d00a90>]}


============================== 14:45:05.232528 | 7273ed95-6fd2-41e6-a655-d640dceea9a1 ==============================
[0m14:45:05.232528 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:45:05.234679 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt build --profiles-dir . --target remote', 'write_json': 'True', 'debug': 'False', 'use_colors': 'True', 'empty': 'False', 'profiles_dir': '.', 'log_path': '/workdir/transforms/09_oulad/logs', 'use_experimental_parser': 'False', 'introspect': 'True', 'partial_parse': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'target_path': 'None', 'no_print': 'None', 'static_parser': 'True', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'cache_selected_only': 'False', 'quiet': 'False', 'log_format': 'default', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True'}
[0m14:45:05.681192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7273ed95-6fd2-41e6-a655-d640dceea9a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b9f0da4970>]}
[0m14:45:05.808840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7273ed95-6fd2-41e6-a655-d640dceea9a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b9f0bc94c0>]}
[0m14:45:05.810735 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m14:45:06.075496 [debug] [MainThread]: checksum: 265ce5244aff672775eaff93c261d21692ed3f5650f4d9e918c76acdb0e9479a, vars: {}, profile: , target: remote, version: 1.8.9
[0m14:45:06.420312 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:45:06.421634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7273ed95-6fd2-41e6-a655-d640dceea9a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b9f1fb9640>]}
[0m14:45:07.919908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7273ed95-6fd2-41e6-a655-d640dceea9a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b9ef14da00>]}
[0m14:45:08.413183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7273ed95-6fd2-41e6-a655-d640dceea9a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b9ef2bedc0>]}
[0m14:45:08.414576 [info ] [MainThread]: Found 7 models, 6 sources, 471 macros
[0m14:45:08.423764 [info ] [MainThread]: 
[0m14:45:08.430868 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m14:45:08.461308 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m14:45:08.465088 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m14:45:08.473684 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m14:45:08.534975 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:45:08.537614 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:45:08.556053 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:45:14.644582 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m14:45:14.648565 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m14:45:15.380673 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.73 seconds
[0m14:45:15.382883 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m14:45:15.385887 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.73 seconds
[0m14:45:16.136739 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.75 seconds
[0m14:45:16.149751 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__sandbox)
[0m14:45:16.162746 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__clean)
[0m14:45:16.170767 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__mart)
[0m14:45:16.175557 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__sandbox: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list__sandbox"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'sandbox'
      

  ...
[0m14:45:16.184786 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list__clean"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'clean'
      

  ...
[0m14:45:16.192371 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list__mart"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'mart'
      

  ...
[0m14:45:16.505524 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.31 seconds
[0m14:45:16.520861 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.32 seconds
[0m14:45:16.561756 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.36 seconds
[0m14:45:17.463236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7273ed95-6fd2-41e6-a655-d640dceea9a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b9f0acdc70>]}
[0m14:45:17.465029 [info ] [MainThread]: Concurrency: 4 threads (target='remote')
[0m14:45:17.466433 [info ] [MainThread]: 
[0m14:45:17.499944 [debug] [Thread-1  ]: Began running node model.ex_09_oulad.grp5_dq_oulad_studenVle_summary
[0m14:45:17.501841 [debug] [Thread-2  ]: Began running node model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies
[0m14:45:17.503823 [debug] [Thread-3  ]: Began running node model.ex_09_oulad.grp5_oulad_dim_courses
[0m14:45:17.506334 [info ] [Thread-1  ]: 1 of 7 START sql view model `mart`.`grp5_dq_oulad_studenVle_summary` ........... [RUN]
[0m14:45:17.509013 [debug] [Thread-4  ]: Began running node model.ex_09_oulad.grp5_oulad_dim_module_presentation
[0m14:45:17.511330 [info ] [Thread-2  ]: 2 of 7 START sql view model `mart`.`grp5_dq_oulad_studentVle_anomalies` ........ [RUN]
[0m14:45:17.514921 [info ] [Thread-3  ]: 3 of 7 START sql table model `mart`.`grp5_oulad_dim_courses` ................... [RUN]
[0m14:45:17.519182 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.ex_09_oulad.grp5_dq_oulad_studenVle_summary'
[0m14:45:17.523084 [info ] [Thread-4  ]: 4 of 7 START sql table model `sandbox`.`grp5_oulad_dim_module_presentation` .... [RUN]
[0m14:45:17.525883 [debug] [Thread-2  ]: Acquiring new clickhouse connection 'model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies'
[0m14:45:17.528732 [debug] [Thread-3  ]: Acquiring new clickhouse connection 'model.ex_09_oulad.grp5_oulad_dim_courses'
[0m14:45:17.532259 [debug] [Thread-1  ]: Began compiling node model.ex_09_oulad.grp5_dq_oulad_studenVle_summary
[0m14:45:17.536311 [debug] [Thread-4  ]: Acquiring new clickhouse connection 'model.ex_09_oulad.grp5_oulad_dim_module_presentation'
[0m14:45:17.538973 [debug] [Thread-2  ]: Began compiling node model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies
[0m14:45:17.541492 [debug] [Thread-3  ]: Began compiling node model.ex_09_oulad.grp5_oulad_dim_courses
[0m14:45:17.550130 [debug] [Thread-4  ]: Began compiling node model.ex_09_oulad.grp5_oulad_dim_module_presentation
[0m14:45:17.593792 [debug] [Thread-2  ]: Writing injected SQL for node "model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies"
[0m14:45:17.599055 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_09_oulad.grp5_dq_oulad_studenVle_summary"
[0m14:45:17.611817 [debug] [Thread-3  ]: Writing injected SQL for node "model.ex_09_oulad.grp5_oulad_dim_courses"
[0m14:45:17.623988 [debug] [Thread-4  ]: Writing injected SQL for node "model.ex_09_oulad.grp5_oulad_dim_module_presentation"
[0m14:45:17.627875 [debug] [Thread-1  ]: Began executing node model.ex_09_oulad.grp5_dq_oulad_studenVle_summary
[0m14:45:17.629644 [debug] [Thread-2  ]: Began executing node model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies
[0m14:45:17.630854 [debug] [Thread-3  ]: Began executing node model.ex_09_oulad.grp5_oulad_dim_courses
[0m14:45:17.674232 [debug] [Thread-4  ]: Began executing node model.ex_09_oulad.grp5_oulad_dim_module_presentation
[0m14:45:17.745551 [debug] [Thread-1  ]: Creating new relation grp5_dq_oulad_studenVle_summary
[0m14:45:17.792340 [debug] [Thread-2  ]: Creating new relation grp5_dq_oulad_studentVle_anomalies
[0m14:45:17.912168 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m14:45:17.922485 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m14:45:18.082244 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m14:45:18.084411 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m14:45:23.289326 [debug] [Thread-2  ]: Writing runtime sql for node "model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies"
[0m14:45:23.294350 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_module_presentation: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_module_presentation"} */

            

    
        create table `sandbox`.`grp5_oulad_dim_module_presentation__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Dimension table for module + presentation (simple, with Nullable types)
select
    cast(code_module as Nullable(String))                           as code_module,
    cast(code_presentation as Nullable(String))                     as code_presentation,
    cast(module_presentation_length as Nullable(Int32))             as length_days
from `clean`.`grp5_stg_oulad_courses`
          )
        
        ...
[0m14:45:23.299616 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies"} */


  create view `mart`.`grp5_dq_oulad_studentVle_anomalies` 
  
    
    
  as (
    

with cln as (
    select * from `clean`.`grp5_stg_oulad_studentVle`
),

violations as (
    select
        id_student,
        code_module,
        code_presentation,
        id_site,
        date,
        sum_click,

        multiIf(
            id_student is null, 'null_id_student',
            code_module is null, 'null_code_module',
            code_presentation is null, 'null_code_presentation',
            sum_click is null, 'null_sum_click',
            sum_click < 0, 'negative_sum_click',
            date < 0, 'negative_date',
            NOT (
                (code_module='AAA' AND code_presentation='2013J') OR
                (code_module='AAA' AND code_presentation='2014J') OR
                (code_module='BBB' AND code_presentation='2013J') OR
                (code_module='BBB' AND code_presentation='2014J') OR
                (code_module='BBB' AND code_presentation='2013B') OR
                (code_module='BBB' AND code_presentation='2014B') OR
                (code_module='CCC' AND code_presentation='2014J') OR
                (code_module='CCC' AND code_presentation='2014B') OR
                (code_module='DDD' AND code_presentation='2013J') OR
                (code_module='DDD' AND code_presentation='2014J') OR
                (code_module='DDD' AND code_presentation='2013B') OR
                (code_module='DDD' AND code_presentation='2014B') OR
                (code_module='EEE' AND code_presentation='2013J') OR
                (code_module='EEE' AND code_presentation='2014J') OR
                (code_module='EEE' AND code_presentation='2014B') OR
                (code_module='FFF' AND code_presentation='2013J') OR
                (code_module='FFF' AND code_presentation='2014J') OR
                (code_module='FFF' AND code_presentation='2013B') OR
                (code_module='FFF' AND code_presentation='2014B') OR
                (code_module='GGG' AND code_presentation='2013J') OR
                (code_module='GGG' AND code_presentation='2014J') OR
                (code_module='GGG' AND code_presentation='2014B')
            ), 'invalid_module_presentation',
            'ok'
        ) as dq_issue
    from cln
)

select *
from violations
where dq_issue != 'ok'
limit 50;
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m14:45:23.664783 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.37 seconds
[0m14:45:23.674384 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_09_oulad.grp5_dq_oulad_studenVle_summary"
[0m14:45:23.683133 [debug] [Thread-2  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies"} */


  create view `mart`.`grp5_dq_oulad_studentVle_anomalies` 
  
    
    
  as (
    

with cln as (
    select * from `clean`.`grp5_stg_oulad_studentVle`
),

violations as (
    select
        id_student,
        code_module,
        code_presentation,
        id_site,
        date,
        sum_click,

        multiIf(
            id_student is null, 'null_id_student',
            code_module is null, 'null_code_module',
            code_presentation is null, 'null_code_presentation',
            sum_click is null, 'null_sum_click',
            sum_click < 0, 'negative_sum_click',
            date < 0, 'negative_date',
            NOT (
                (code_module='AAA' AND code_presentation='2013J') OR
                (code_module='AAA' AND code_presentation='2014J') OR
                (code_module='BBB' AND code_presentation='2013J') OR
                (code_module='BBB' AND code_presentation='2014J') OR
                (code_module='BBB' AND code_presentation='2013B') OR
                (code_module='BBB' AND code_presentation='2014B') OR
                (code_module='CCC' AND code_presentation='2014J') OR
                (code_module='CCC' AND code_presentation='2014B') OR
                (code_module='DDD' AND code_presentation='2013J') OR
                (code_module='DDD' AND code_presentation='2014J') OR
                (code_module='DDD' AND code_presentation='2013B') OR
                (code_module='DDD' AND code_presentation='2014B') OR
                (code_module='EEE' AND code_presentation='2013J') OR
                (code_module='EEE' AND code_presentation='2014J') OR
                (code_module='EEE' AND code_presentation='2014B') OR
                (code_module='FFF' AND code_presentation='2013J') OR
                (code_module='FFF' AND code_presentation='2014J') OR
                (code_module='FFF' AND code_presentation='2013B') OR
                (code_module='FFF' AND code_presentation='2014B') OR
                (code_module='GGG' AND code_presentation='2013J') OR
                (code_module='GGG' AND code_presentation='2014J') OR
                (code_module='GGG' AND code_presentation='2014B')
            ), 'invalid_module_presentation',
            'ok'
        ) as dq_issue
    from cln
)

select *
from violations
where dq_issue != 'ok'
limit 50;
    
  )
      
      
                    -- end_of_sql
                    
                    
[0m14:45:23.710985 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_module_presentation: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_module_presentation"} */

    select name, type from system.columns where table = 'grp5_oulad_dim_module_presentation__dbt_backup'
    
      and database = 'sandbox'
    
    order by position
  ...
[0m14:45:23.715129 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_dq_oulad_studenVle_summary: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_dq_oulad_studenVle_summary"} */


  create view `mart`.`grp5_dq_oulad_studenVle_summary` 
  
    
    
  as (
    

with src as (
    select * from `raw`.`studentVle`
),
cln as (
    select * from `clean`.`grp5_stg_oulad_studentVle`
),

counts as (
    select
        (select count(*) from src) as row_count_raw,
        (select count(*) from cln) as row_count_clean
),

nulls as (
    select
        round(100.0 * countIf(id_student is null) / nullif(count(),0),2) as pct_null_id_student,
        round(100.0 * countIf(code_module is null) / nullif(count(),0),2) as pct_null_code_module,
        round(100.0 * countIf(code_presentation is null) / nullif(count(),0),2) as pct_null_code_presentation,
        round(100.0 * countIf(sum_click is null) / nullif(count(),0),2) as pct_null_sum_click
    from cln
),

domains as (
    select
        countIf(
            NOT (
                (code_module='AAA' AND code_presentation='2013J') OR
                (code_module='AAA' AND code_presentation='2014J') OR
                (code_module='BBB' AND code_presentation='2013J') OR
                (code_module='BBB' AND code_presentation='2014J') OR
                (code_module='BBB' AND code_presentation='2013B') OR
                (code_module='BBB' AND code_presentation='2014B') OR
                (code_module='CCC' AND code_presentation='2014J') OR
                (code_module='CCC' AND code_presentation='2014B') OR
                (code_module='DDD' AND code_presentation='2013J') OR
                (code_module='DDD' AND code_presentation='2014J') OR
                (code_module='DDD' AND code_presentation='2013B') OR
                (code_module='DDD' AND code_presentation='2014B') OR
                (code_module='EEE' AND code_presentation='2013J') OR
                (code_module='EEE' AND code_presentation='2014J') OR
                (code_module='EEE' AND code_presentation='2014B') OR
                (code_module='FFF' AND code_presentation='2013J') OR
                (code_module='FFF' AND code_presentation='2014J') OR
                (code_module='FFF' AND code_presentation='2013B') OR
                (code_module='FFF' AND code_presentation='2014B') OR
                (code_module='GGG' AND code_presentation='2013J') OR
                (code_module='GGG' AND code_presentation='2014J') OR
                (code_module='GGG' AND code_presentation='2014B')
            )
        ) as invalid_module_presentation
    from cln
),

bounds as (
    select
        countIf(sum_click < 0) as negative_sum_click,
        countIf(date < 0) as negative_date
    from cln
),

joined as (
    select
        counts.row_count_raw,
        counts.row_count_clean,
        (counts.row_count_raw - counts.row_count_clean) as dropped_rows,
        nulls.pct_null_id_student,
        nulls.pct_null_code_module,
        nulls.pct_null_code_presentation,
        nulls.pct_null_sum_click,
        domains.invalid_module_presentation,
        bounds.negative_sum_click,
        bounds.negative_date
    from counts
    cross join nulls
    cross join domains
    cross join bounds
)

select * from joined;
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m14:45:23.735306 [debug] [Thread-2  ]: Database Error in model grp5_dq_oulad_studentVle_anomalies (models/mart/dq/grp5_dq_oulad_studentVle_anomalies.sql)
  HTTPDriver for http://54.87.106.52:8123 received ClickHouse error code 62
   Code: 62. DB::Exception: Syntax error: failed at position 2490 (end of query) (line 63, col 9): ;
      
    )
        
        
                      -- end_of_sql
                      
                      . Expected one of: token, DoubleColon, OR, AND, IS NOT DISTINCT FROM, IS NULL, IS NOT NULL, BETWEEN, NOT BETWEEN, LIKE, ILIKE, NOT LIKE, NOT ILIKE, REGEXP, IN, NOT IN, GLOBAL IN, GLOBAL NOT IN, MOD, DIV, alias, AS, Comma, OFFSET, WITH TIES, BY, FETCH, LIMIT, SETTINGS, UNION, EXCEPT, INTERSECT. (SYNTAX_ERROR) (version 23.12.6.19 (official build))
  compiled code at target/run/ex_09_oulad/models/mart/dq/grp5_dq_oulad_studentVle_anomalies.sql
[0m14:45:23.739980 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7273ed95-6fd2-41e6-a655-d640dceea9a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b9edb828e0>]}
[0m14:45:23.742949 [error] [Thread-2  ]: 2 of 7 ERROR creating sql view model `mart`.`grp5_dq_oulad_studentVle_anomalies`  [[31mERROR[0m in 6.21s]
[0m14:45:23.745598 [debug] [Thread-2  ]: Finished running node model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies
[0m14:45:23.747104 [debug] [Thread-2  ]: Began running node model.ex_09_oulad.grp5_oulad_dim_student
[0m14:45:23.750080 [info ] [Thread-2  ]: 5 of 7 START sql table model `sandbox`.`grp5_oulad_dim_student` ................ [RUN]
[0m14:45:23.753903 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies, now model.ex_09_oulad.grp5_oulad_dim_student)
[0m14:45:23.757055 [debug] [Thread-2  ]: Began compiling node model.ex_09_oulad.grp5_oulad_dim_student
[0m14:45:23.770922 [debug] [Thread-2  ]: Writing injected SQL for node "model.ex_09_oulad.grp5_oulad_dim_student"
[0m14:45:23.773684 [debug] [Thread-2  ]: Began executing node model.ex_09_oulad.grp5_oulad_dim_student
[0m14:45:23.791243 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_student: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_student"} */

            

    
        create table `sandbox`.`grp5_oulad_dim_student__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Dimension table for students (no surrogate key)
select
    cast(id_student as Int64)               as id_student,
    cast(gender as Nullable(String))        as gender,
    cast(age_band as Nullable(String))      as age_band,
    cast(region as Nullable(String))        as region,
    cast(highest_education as Nullable(String)) as highest_education,
    cast(imd_band as Nullable(String))      as imd_band,
    cast(disability as Nullable(String))    as disability
from `clean`.`grp5_stg_oulad_student_info`
          )
        
        ...
[0m14:45:24.077325 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_courses: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_courses"} */

            

    
        create table `mart`.`grp5_oulad_dim_courses__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

select
    concat(cast(code_module as Nullable(String)), cast(code_presentation as Nullable(String))) 
        as id_course,
    cast(code_module as Nullable(String))                           as code_module,
    cast(code_presentation as Nullable(String))                     as code_presentation,
    cast(module_presentation_length as Nullable(Int32))             as module_presentation_length
from `clean`.`grp5_stg_oulad_courses`
          )
        
        ...
[0m14:45:24.082642 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.37 seconds
[0m14:45:24.093415 [debug] [Thread-4  ]: Writing runtime sql for node "model.ex_09_oulad.grp5_oulad_dim_module_presentation"
[0m14:45:24.095788 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_module_presentation: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_module_presentation"} */

  
    
    
    
        
         


        insert into `sandbox`.`grp5_oulad_dim_module_presentation__dbt_backup`
        ("code_module", "code_presentation", "length_days")

-- Dimension table for module + presentation (simple, with Nullable types)
select
    cast(code_module as Nullable(String))                           as code_module,
    cast(code_presentation as Nullable(String))                     as code_presentation,
    cast(module_presentation_length as Nullable(Int32))             as length_days
from `clean`.`grp5_stg_oulad_courses`
  ...
[0m14:45:24.106960 [debug] [Thread-1  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_dq_oulad_studenVle_summary"} */


  create view `mart`.`grp5_dq_oulad_studenVle_summary` 
  
    
    
  as (
    

with src as (
    select * from `raw`.`studentVle`
),
cln as (
    select * from `clean`.`grp5_stg_oulad_studentVle`
),

counts as (
    select
        (select count(*) from src) as row_count_raw,
        (select count(*) from cln) as row_count_clean
),

nulls as (
    select
        round(100.0 * countIf(id_student is null) / nullif(count(),0),2) as pct_null_id_student,
        round(100.0 * countIf(code_module is null) / nullif(count(),0),2) as pct_null_code_module,
        round(100.0 * countIf(code_presentation is null) / nullif(count(),0),2) as pct_null_code_presentation,
        round(100.0 * countIf(sum_click is null) / nullif(count(),0),2) as pct_null_sum_click
    from cln
),

domains as (
    select
        countIf(
            NOT (
                (code_module='AAA' AND code_presentation='2013J') OR
                (code_module='AAA' AND code_presentation='2014J') OR
                (code_module='BBB' AND code_presentation='2013J') OR
                (code_module='BBB' AND code_presentation='2014J') OR
                (code_module='BBB' AND code_presentation='2013B') OR
                (code_module='BBB' AND code_presentation='2014B') OR
                (code_module='CCC' AND code_presentation='2014J') OR
                (code_module='CCC' AND code_presentation='2014B') OR
                (code_module='DDD' AND code_presentation='2013J') OR
                (code_module='DDD' AND code_presentation='2014J') OR
                (code_module='DDD' AND code_presentation='2013B') OR
                (code_module='DDD' AND code_presentation='2014B') OR
                (code_module='EEE' AND code_presentation='2013J') OR
                (code_module='EEE' AND code_presentation='2014J') OR
                (code_module='EEE' AND code_presentation='2014B') OR
                (code_module='FFF' AND code_presentation='2013J') OR
                (code_module='FFF' AND code_presentation='2014J') OR
                (code_module='FFF' AND code_presentation='2013B') OR
                (code_module='FFF' AND code_presentation='2014B') OR
                (code_module='GGG' AND code_presentation='2013J') OR
                (code_module='GGG' AND code_presentation='2014J') OR
                (code_module='GGG' AND code_presentation='2014B')
            )
        ) as invalid_module_presentation
    from cln
),

bounds as (
    select
        countIf(sum_click < 0) as negative_sum_click,
        countIf(date < 0) as negative_date
    from cln
),

joined as (
    select
        counts.row_count_raw,
        counts.row_count_clean,
        (counts.row_count_raw - counts.row_count_clean) as dropped_rows,
        nulls.pct_null_id_student,
        nulls.pct_null_code_module,
        nulls.pct_null_code_presentation,
        nulls.pct_null_sum_click,
        domains.invalid_module_presentation,
        bounds.negative_sum_click,
        bounds.negative_date
    from counts
    cross join nulls
    cross join domains
    cross join bounds
)

select * from joined;
    
  )
      
      
                    -- end_of_sql
                    
                    
[0m14:45:24.110153 [debug] [Thread-1  ]: Database Error in model grp5_dq_oulad_studenVle_summary (models/mart/dq/grp5_dq_oulad_studenVle_summary.sql)
  HTTPDriver for http://54.87.106.52:8123 received ClickHouse error code 62
   Code: 62. DB::Exception: Syntax error: failed at position 3250 (end of query) (line 89, col 21): ;
      
    )
        
        
                      -- end_of_sql
                      
                      . Expected one of: token, Dot, OpeningRoundBracket, UUID, alias, AS, identifier, FINAL, SAMPLE, table, table function, subquery or list of joined tables, array join, LEFT ARRAY JOIN, INNER, ARRAY JOIN, JOIN, PREWHERE, WHERE, GROUP BY, WITH, HAVING, WINDOW, ORDER BY, LIMIT, OFFSET, FETCH, SETTINGS, UNION, EXCEPT, INTERSECT. (SYNTAX_ERROR) (version 23.12.6.19 (official build))
  compiled code at target/run/ex_09_oulad/models/mart/dq/grp5_dq_oulad_studenVle_summary.sql
[0m14:45:24.111752 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7273ed95-6fd2-41e6-a655-d640dceea9a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b9eec81190>]}
[0m14:45:24.113714 [error] [Thread-1  ]: 1 of 7 ERROR creating sql view model `mart`.`grp5_dq_oulad_studenVle_summary` .. [[31mERROR[0m in 6.59s]
[0m14:45:24.115925 [debug] [Thread-1  ]: Finished running node model.ex_09_oulad.grp5_dq_oulad_studenVle_summary
[0m14:45:24.117609 [debug] [Thread-1  ]: Began running node model.ex_09_oulad.grp5_stg_oulad_student_assessment
[0m14:45:24.119540 [info ] [Thread-1  ]: 6 of 7 START sql table model `clean`.`grp5_stg_oulad_student_assessment` ....... [RUN]
[0m14:45:24.121746 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ex_09_oulad.grp5_dq_oulad_studenVle_summary, now model.ex_09_oulad.grp5_stg_oulad_student_assessment)
[0m14:45:24.123275 [debug] [Thread-1  ]: Began compiling node model.ex_09_oulad.grp5_stg_oulad_student_assessment
[0m14:45:24.142175 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_09_oulad.grp5_stg_oulad_student_assessment"
[0m14:45:24.147203 [debug] [Thread-1  ]: Began executing node model.ex_09_oulad.grp5_stg_oulad_student_assessment
[0m14:45:24.162262 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_assessment"} */

            

    
        create table `clean`.`grp5_stg_oulad_student_assessment__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
             

-- Standardize names and types for student assessment
select
  cast(id_assessment  as Nullable(Int64)) as assessment_id,
  cast(id_student     as Nullable(Int64)) as student_id,
  cast(date_submitted as Nullable(Int64)) as date_submitted,
  cast(is_banked      as Nullable(Int64)) as is_banked,
  cast(score          as Nullable(Int64)) as score
from `raw`.`grp5_oulad___student_assessment`
          )
        
        ...
[0m14:45:24.167696 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.37 seconds
[0m14:45:24.178142 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_student: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_student"} */

    select name, type from system.columns where table = 'grp5_oulad_dim_student__dbt_backup'
    
      and database = 'sandbox'
    
    order by position
  ...
[0m14:45:24.477405 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.40 seconds
[0m14:45:24.485343 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_courses: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_courses"} */

    select name, type from system.columns where table = 'grp5_oulad_dim_courses__dbt_backup'
    
      and database = 'mart'
    
    order by position
  ...
[0m14:45:24.510517 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.41 seconds
[0m14:45:24.513507 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.35 seconds
[0m14:45:24.533863 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_module_presentation: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_module_presentation"} */
EXCHANGE TABLES `sandbox`.`grp5_oulad_dim_module_presentation__dbt_backup` AND `sandbox`.`grp5_oulad_dim_module_presentation` 
  
  ...
[0m14:45:24.537756 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_assessment"} */

    select name, type from system.columns where table = 'grp5_stg_oulad_student_assessment__dbt_backup'
    
      and database = 'clean'
    
    order by position
  ...
[0m14:45:24.547833 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.37 seconds
[0m14:45:24.553507 [debug] [Thread-2  ]: Writing runtime sql for node "model.ex_09_oulad.grp5_oulad_dim_student"
[0m14:45:24.557469 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_student: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_student"} */

  
    
    
    
        
         


        insert into `sandbox`.`grp5_oulad_dim_student__dbt_backup`
        ("id_student", "gender", "age_band", "region", "highest_education", "imd_band", "disability")

-- Dimension table for students (no surrogate key)
select
    cast(id_student as Int64)               as id_student,
    cast(gender as Nullable(String))        as gender,
    cast(age_band as Nullable(String))      as age_band,
    cast(region as Nullable(String))        as region,
    cast(highest_education as Nullable(String)) as highest_education,
    cast(imd_band as Nullable(String))      as imd_band,
    cast(disability as Nullable(String))    as disability
from `clean`.`grp5_stg_oulad_student_info`
  ...
[0m14:45:24.875298 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.39 seconds
[0m14:45:24.877696 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.34 seconds
[0m14:45:24.882167 [debug] [Thread-3  ]: Writing runtime sql for node "model.ex_09_oulad.grp5_oulad_dim_courses"
[0m14:45:24.914456 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.37 seconds
[0m14:45:24.922536 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.36 seconds
[0m14:45:24.927205 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_09_oulad.grp5_stg_oulad_student_assessment"
[0m14:45:24.941116 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_courses: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_courses"} */

  
    
    
    
        
         


        insert into `mart`.`grp5_oulad_dim_courses__dbt_backup`
        ("id_course", "code_module", "code_presentation", "module_presentation_length")

select
    concat(cast(code_module as Nullable(String)), cast(code_presentation as Nullable(String))) 
        as id_course,
    cast(code_module as Nullable(String))                           as code_module,
    cast(code_presentation as Nullable(String))                     as code_presentation,
    cast(module_presentation_length as Nullable(Int32))             as module_presentation_length
from `clean`.`grp5_stg_oulad_courses`
  ...
[0m14:45:24.951168 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_student: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_student"} */
EXCHANGE TABLES `sandbox`.`grp5_oulad_dim_student__dbt_backup` AND `sandbox`.`grp5_oulad_dim_student` 
  
  ...
[0m14:45:24.971462 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_module_presentation: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_module_presentation"} */

    drop table if exists `sandbox`.`grp5_oulad_dim_module_presentation__dbt_backup` 
  ...
[0m14:45:24.979464 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_assessment"} */

  
    
    
    
        
         


        insert into `clean`.`grp5_stg_oulad_student_assessment__dbt_backup`
        ("assessment_id", "student_id", "date_submitted", "is_banked", "score") 

-- Standardize names and types for student assessment
select
  cast(id_assessment  as Nullable(Int64)) as assessment_id,
  cast(id_student     as Nullable(Int64)) as student_id,
  cast(date_submitted as Nullable(Int64)) as date_submitted,
  cast(is_banked      as Nullable(Int64)) as is_banked,
  cast(score          as Nullable(Int64)) as score
from `raw`.`grp5_oulad___student_assessment`
  ...
[0m14:45:25.331897 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.36 seconds
[0m14:45:25.336376 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_courses: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_courses"} */
EXCHANGE TABLES `mart`.`grp5_oulad_dim_courses__dbt_backup` AND `mart`.`grp5_oulad_dim_courses` 
  
  ...
[0m14:45:25.339132 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.36 seconds
[0m14:45:25.341685 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.36 seconds
[0m14:45:25.351656 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7273ed95-6fd2-41e6-a655-d640dceea9a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b9ee0c9a00>]}
[0m14:45:25.363061 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_student: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_student"} */

    drop table if exists `sandbox`.`grp5_oulad_dim_student__dbt_backup` 
  ...
[0m14:45:25.366082 [info ] [Thread-4  ]: 4 of 7 OK created sql table model `sandbox`.`grp5_oulad_dim_module_presentation`  [[32mOK[0m in 7.82s]
[0m14:45:25.371231 [debug] [Thread-4  ]: Finished running node model.ex_09_oulad.grp5_oulad_dim_module_presentation
[0m14:45:25.372987 [debug] [Thread-4  ]: Began running node model.ex_09_oulad.grp5_stg_oulad_student_info
[0m14:45:25.375526 [info ] [Thread-4  ]: 7 of 7 START sql table model `clean`.`grp5_stg_oulad_student_info` ............. [RUN]
[0m14:45:25.380665 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.ex_09_oulad.grp5_oulad_dim_module_presentation, now model.ex_09_oulad.grp5_stg_oulad_student_info)
[0m14:45:25.383142 [debug] [Thread-4  ]: Began compiling node model.ex_09_oulad.grp5_stg_oulad_student_info
[0m14:45:25.386425 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.40 seconds
[0m14:45:25.402832 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_assessment"} */
EXCHANGE TABLES `clean`.`grp5_stg_oulad_student_assessment__dbt_backup` AND `clean`.`grp5_stg_oulad_student_assessment` 
  
  ...
[0m14:45:25.399048 [debug] [Thread-4  ]: Writing injected SQL for node "model.ex_09_oulad.grp5_stg_oulad_student_info"
[0m14:45:25.408343 [debug] [Thread-4  ]: Began executing node model.ex_09_oulad.grp5_stg_oulad_student_info
[0m14:45:25.423797 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_info: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_info"} */

            

    
        create table `clean`.`grp5_stg_oulad_student_info__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            
select
  cast(code_module            as String)     as code_module,
  cast(code_presentation      as String)     as code_presentation,
  cast(id_student             as Int64)      as id_student,
  cast(
    case
      when gender IN ('M', 'F') then gender
      else 'Unknown'
    end as String) as gender,
  cast(region                 as String)     as region,
  cast(highest_education      as String)     as highest_education,
  cast(
    case
        when imd_band = '?' then null
        when imd_band not like '%\%%' then concat(imd_band, '%')
        else imd_band
    end as Nullable(String)) as imd_band,
  cast(age_band               as String)     as age_band,
  cast(num_of_prev_attempts   as Int64)      as num_of_prev_attempts,
  cast(studied_credits        as Int64)      as studied_credits,
  cast(disability             as String)     as disability,
  cast(final_result           as String)     as final_result
from `raw`.`grp5_oulad___student_info`
          )
        
        ...
[0m14:45:25.804828 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.46 seconds
[0m14:45:25.808252 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.38 seconds
[0m14:45:25.811461 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.44 seconds
[0m14:45:25.814301 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.41 seconds
[0m14:45:25.827268 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_courses: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_courses"} */

    drop table if exists `mart`.`grp5_oulad_dim_courses__dbt_backup` 
  ...
[0m14:45:25.837779 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_info: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_info"} */

    select name, type from system.columns where table = 'grp5_stg_oulad_student_info__dbt_backup'
    
      and database = 'clean'
    
    order by position
  ...
[0m14:45:25.842671 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7273ed95-6fd2-41e6-a655-d640dceea9a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b9eeddf6d0>]}
[0m14:45:25.855819 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_assessment"} */

    drop table if exists `clean`.`grp5_stg_oulad_student_assessment__dbt_backup` 
  ...
[0m14:45:25.869235 [info ] [Thread-2  ]: 5 of 7 OK created sql table model `sandbox`.`grp5_oulad_dim_student` ........... [[32mOK[0m in 2.09s]
[0m14:45:25.875209 [debug] [Thread-2  ]: Finished running node model.ex_09_oulad.grp5_oulad_dim_student
[0m14:45:26.329565 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.47 seconds
[0m14:45:26.333142 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.47 seconds
[0m14:45:26.335696 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.46 seconds
[0m14:45:26.340010 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7273ed95-6fd2-41e6-a655-d640dceea9a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b9ee19c610>]}
[0m14:45:26.344975 [debug] [Thread-4  ]: Writing runtime sql for node "model.ex_09_oulad.grp5_stg_oulad_student_info"
[0m14:45:26.349571 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7273ed95-6fd2-41e6-a655-d640dceea9a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b9eee4abe0>]}
[0m14:45:26.351921 [info ] [Thread-3  ]: 3 of 7 OK created sql table model `mart`.`grp5_oulad_dim_courses` .............. [[32mOK[0m in 8.81s]
[0m14:45:26.356000 [info ] [Thread-1  ]: 6 of 7 OK created sql table model `clean`.`grp5_stg_oulad_student_assessment` .. [[32mOK[0m in 2.23s]
[0m14:45:26.359312 [debug] [Thread-3  ]: Finished running node model.ex_09_oulad.grp5_oulad_dim_courses
[0m14:45:26.361072 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_info: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_info"} */

  
    
    
    
        
         


        insert into `clean`.`grp5_stg_oulad_student_info__dbt_backup`
        ("code_module", "code_presentation", "id_student", "gender", "region", "highest_education", "imd_band", "age_band", "num_of_prev_attempts", "studied_credits", "disability", "final_result")
select
  cast(code_module            as String)     as code_module,
  cast(code_presentation      as String)     as code_presentation,
  cast(id_student             as Int64)      as id_student,
  cast(
    case
      when gender IN ('M', 'F') then gender
      else 'Unknown'
    end as String) as gender,
  cast(region                 as String)     as region,
  cast(highest_education      as String)     as highest_education,
  cast(
    case
        when imd_band = '?' then null
        when imd_band not like '%\%%' then concat(imd_band, '%')
        else imd_band
    end as Nullable(String)) as imd_band,
  cast(age_band               as String)     as age_band,
  cast(num_of_prev_attempts   as Int64)      as num_of_prev_attempts,
  cast(studied_credits        as Int64)      as studied_credits,
  cast(disability             as String)     as disability,
  cast(final_result           as String)     as final_result
from `raw`.`grp5_oulad___student_info`
  ...
[0m14:45:26.365094 [debug] [Thread-1  ]: Finished running node model.ex_09_oulad.grp5_stg_oulad_student_assessment
[0m14:45:27.190521 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.82 seconds
[0m14:45:27.195895 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_info: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_info"} */
EXCHANGE TABLES `clean`.`grp5_stg_oulad_student_info__dbt_backup` AND `clean`.`grp5_stg_oulad_student_info` 
  
  ...
[0m14:45:27.838745 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.64 seconds
[0m14:45:27.849484 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_info: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_info"} */

    drop table if exists `clean`.`grp5_stg_oulad_student_info__dbt_backup` 
  ...
[0m14:45:28.258217 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.41 seconds
[0m14:45:28.263273 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7273ed95-6fd2-41e6-a655-d640dceea9a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b9ef036970>]}
[0m14:45:28.264875 [info ] [Thread-4  ]: 7 of 7 OK created sql table model `clean`.`grp5_stg_oulad_student_info` ........ [[32mOK[0m in 2.89s]
[0m14:45:28.267650 [debug] [Thread-4  ]: Finished running node model.ex_09_oulad.grp5_stg_oulad_student_info
[0m14:45:28.273567 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:45:28.274679 [debug] [MainThread]: Connection 'list__sandbox' was left open.
[0m14:45:28.275636 [debug] [MainThread]: On list__sandbox: Close
[0m14:45:28.277432 [debug] [MainThread]: Connection 'list__clean' was left open.
[0m14:45:28.278749 [debug] [MainThread]: On list__clean: Close
[0m14:45:28.279570 [debug] [MainThread]: Connection 'list__mart' was left open.
[0m14:45:28.280445 [debug] [MainThread]: On list__mart: Close
[0m14:45:28.282007 [debug] [MainThread]: Connection 'model.ex_09_oulad.grp5_stg_oulad_student_assessment' was left open.
[0m14:45:28.283833 [debug] [MainThread]: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: Close
[0m14:45:28.285149 [debug] [MainThread]: Connection 'model.ex_09_oulad.grp5_oulad_dim_student' was left open.
[0m14:45:28.286150 [debug] [MainThread]: On model.ex_09_oulad.grp5_oulad_dim_student: Close
[0m14:45:28.287143 [debug] [MainThread]: Connection 'model.ex_09_oulad.grp5_oulad_dim_courses' was left open.
[0m14:45:28.288141 [debug] [MainThread]: On model.ex_09_oulad.grp5_oulad_dim_courses: Close
[0m14:45:28.288857 [debug] [MainThread]: Connection 'model.ex_09_oulad.grp5_stg_oulad_student_info' was left open.
[0m14:45:28.289820 [debug] [MainThread]: On model.ex_09_oulad.grp5_stg_oulad_student_info: Close
[0m14:45:28.293160 [info ] [MainThread]: 
[0m14:45:28.294923 [info ] [MainThread]: Finished running 2 view models, 5 table models in 0 hours 0 minutes and 19.86 seconds (19.86s).
[0m14:45:28.301813 [debug] [MainThread]: Command end result
[0m14:45:28.396540 [info ] [MainThread]: 
[0m14:45:28.397911 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m14:45:28.399472 [info ] [MainThread]: 
[0m14:45:28.403025 [error] [MainThread]:   Database Error in model grp5_dq_oulad_studentVle_anomalies (models/mart/dq/grp5_dq_oulad_studentVle_anomalies.sql)
  HTTPDriver for http://54.87.106.52:8123 received ClickHouse error code 62
   Code: 62. DB::Exception: Syntax error: failed at position 2490 (end of query) (line 63, col 9): ;
      
    )
        
        
                      -- end_of_sql
                      
                      . Expected one of: token, DoubleColon, OR, AND, IS NOT DISTINCT FROM, IS NULL, IS NOT NULL, BETWEEN, NOT BETWEEN, LIKE, ILIKE, NOT LIKE, NOT ILIKE, REGEXP, IN, NOT IN, GLOBAL IN, GLOBAL NOT IN, MOD, DIV, alias, AS, Comma, OFFSET, WITH TIES, BY, FETCH, LIMIT, SETTINGS, UNION, EXCEPT, INTERSECT. (SYNTAX_ERROR) (version 23.12.6.19 (official build))
  compiled code at target/run/ex_09_oulad/models/mart/dq/grp5_dq_oulad_studentVle_anomalies.sql
[0m14:45:28.404450 [info ] [MainThread]: 
[0m14:45:28.407186 [error] [MainThread]:   Database Error in model grp5_dq_oulad_studenVle_summary (models/mart/dq/grp5_dq_oulad_studenVle_summary.sql)
  HTTPDriver for http://54.87.106.52:8123 received ClickHouse error code 62
   Code: 62. DB::Exception: Syntax error: failed at position 3250 (end of query) (line 89, col 21): ;
      
    )
        
        
                      -- end_of_sql
                      
                      . Expected one of: token, Dot, OpeningRoundBracket, UUID, alias, AS, identifier, FINAL, SAMPLE, table, table function, subquery or list of joined tables, array join, LEFT ARRAY JOIN, INNER, ARRAY JOIN, JOIN, PREWHERE, WHERE, GROUP BY, WITH, HAVING, WINDOW, ORDER BY, LIMIT, OFFSET, FETCH, SETTINGS, UNION, EXCEPT, INTERSECT. (SYNTAX_ERROR) (version 23.12.6.19 (official build))
  compiled code at target/run/ex_09_oulad/models/mart/dq/grp5_dq_oulad_studenVle_summary.sql
[0m14:45:28.409794 [info ] [MainThread]: 
[0m14:45:28.412420 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=0 TOTAL=7
[0m14:45:28.423154 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 25.783585, "process_in_blocks": "14104", "process_kernel_time": 2.807442, "process_mem_max_rss": "117648", "process_out_blocks": "10880", "process_user_time": 12.334825}
[0m14:45:28.425670 [debug] [MainThread]: Command `dbt build` failed at 14:45:28.424639 after 25.79 seconds
[0m14:45:28.428046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b9f4096e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b9ef12f6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b9f181fb50>]}
[0m14:45:28.430365 [debug] [MainThread]: Flushing usage events
[0m14:46:29.827193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a4fd5f7e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a4fa248b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a4fa248a30>]}


============================== 14:46:29.841940 | 8dd2ba41-397b-45f5-8763-3d8489a77524 ==============================
[0m14:46:29.841940 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:46:29.843669 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'target_path': 'None', 'printer_width': '80', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'quiet': 'False', 'version_check': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --profiles-dir . --target remote', 'partial_parse': 'True', 'no_print': 'None', 'log_path': '/workdir/transforms/09_oulad/logs', 'log_cache_events': 'False', 'static_parser': 'True', 'log_format': 'default', 'profiles_dir': '.', 'empty': 'False', 'write_json': 'True'}
[0m14:46:30.288856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8dd2ba41-397b-45f5-8763-3d8489a77524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a4fd801b50>]}
[0m14:46:30.418497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8dd2ba41-397b-45f5-8763-3d8489a77524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a4fa2e2220>]}
[0m14:46:30.420354 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m14:46:30.676283 [debug] [MainThread]: checksum: 265ce5244aff672775eaff93c261d21692ed3f5650f4d9e918c76acdb0e9479a, vars: {}, profile: , target: remote, version: 1.8.9
[0m14:46:30.944427 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:46:30.945589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8dd2ba41-397b-45f5-8763-3d8489a77524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a4fb50a880>]}
[0m14:46:32.175519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8dd2ba41-397b-45f5-8763-3d8489a77524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a4f868ca00>]}
[0m14:46:32.544763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8dd2ba41-397b-45f5-8763-3d8489a77524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a4f8623d60>]}
[0m14:46:32.546668 [info ] [MainThread]: Found 7 models, 6 sources, 471 macros
[0m14:46:32.552384 [info ] [MainThread]: 
[0m14:46:32.555285 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m14:46:32.593637 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m14:46:32.596539 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m14:46:32.604925 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m14:46:32.710818 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:46:32.714449 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:46:32.737151 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:46:39.797413 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m14:46:39.805151 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m14:46:40.135893 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.33 seconds
[0m14:46:40.138234 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m14:46:40.140914 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.34 seconds
[0m14:46:40.553176 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.41 seconds
[0m14:46:40.561358 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__sandbox)
[0m14:46:40.563621 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__clean)
[0m14:46:40.572385 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__mart)
[0m14:46:40.591622 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__sandbox: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list__sandbox"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'sandbox'
      

  ...
[0m14:46:40.597022 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list__clean"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'clean'
      

  ...
[0m14:46:40.605762 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list__mart"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'mart'
      

  ...
[0m14:46:40.954412 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.34 seconds
[0m14:46:40.962814 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.34 seconds
[0m14:46:40.978031 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.37 seconds
[0m14:46:42.355838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8dd2ba41-397b-45f5-8763-3d8489a77524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a4f801d130>]}
[0m14:46:42.358582 [info ] [MainThread]: Concurrency: 4 threads (target='remote')
[0m14:46:42.361107 [info ] [MainThread]: 
[0m14:46:42.476688 [debug] [Thread-1  ]: Began running node model.ex_09_oulad.grp5_dq_oulad_studenVle_summary
[0m14:46:42.478492 [debug] [Thread-2  ]: Began running node model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies
[0m14:46:42.483077 [debug] [Thread-3  ]: Began running node model.ex_09_oulad.grp5_oulad_dim_courses
[0m14:46:42.485694 [debug] [Thread-4  ]: Began running node model.ex_09_oulad.grp5_oulad_dim_module_presentation
[0m14:46:42.480995 [info ] [Thread-1  ]: 1 of 7 START sql table model `mart`.`grp5_dq_oulad_studenVle_summary` .......... [RUN]
[0m14:46:42.488037 [info ] [Thread-2  ]: 2 of 7 START sql table model `mart`.`grp5_dq_oulad_studentVle_anomalies` ....... [RUN]
[0m14:46:42.491461 [info ] [Thread-3  ]: 3 of 7 START sql table model `mart`.`grp5_oulad_dim_courses` ................... [RUN]
[0m14:46:42.495845 [info ] [Thread-4  ]: 4 of 7 START sql table model `sandbox`.`grp5_oulad_dim_module_presentation` .... [RUN]
[0m14:46:42.499819 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.ex_09_oulad.grp5_dq_oulad_studenVle_summary'
[0m14:46:42.503065 [debug] [Thread-2  ]: Acquiring new clickhouse connection 'model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies'
[0m14:46:42.506840 [debug] [Thread-3  ]: Acquiring new clickhouse connection 'model.ex_09_oulad.grp5_oulad_dim_courses'
[0m14:46:42.510430 [debug] [Thread-4  ]: Acquiring new clickhouse connection 'model.ex_09_oulad.grp5_oulad_dim_module_presentation'
[0m14:46:42.512752 [debug] [Thread-1  ]: Began compiling node model.ex_09_oulad.grp5_dq_oulad_studenVle_summary
[0m14:46:42.514888 [debug] [Thread-2  ]: Began compiling node model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies
[0m14:46:42.517885 [debug] [Thread-3  ]: Began compiling node model.ex_09_oulad.grp5_oulad_dim_courses
[0m14:46:42.520344 [debug] [Thread-4  ]: Began compiling node model.ex_09_oulad.grp5_oulad_dim_module_presentation
[0m14:46:42.572171 [debug] [Thread-2  ]: Writing injected SQL for node "model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies"
[0m14:46:42.590804 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_09_oulad.grp5_dq_oulad_studenVle_summary"
[0m14:46:42.594604 [debug] [Thread-3  ]: Writing injected SQL for node "model.ex_09_oulad.grp5_oulad_dim_courses"
[0m14:46:42.607433 [debug] [Thread-4  ]: Writing injected SQL for node "model.ex_09_oulad.grp5_oulad_dim_module_presentation"
[0m14:46:42.611704 [debug] [Thread-1  ]: Began executing node model.ex_09_oulad.grp5_dq_oulad_studenVle_summary
[0m14:46:42.613623 [debug] [Thread-2  ]: Began executing node model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies
[0m14:46:42.615864 [debug] [Thread-4  ]: Began executing node model.ex_09_oulad.grp5_oulad_dim_module_presentation
[0m14:46:42.629235 [debug] [Thread-3  ]: Began executing node model.ex_09_oulad.grp5_oulad_dim_courses
[0m14:46:42.752034 [debug] [Thread-1  ]: Creating new relation grp5_dq_oulad_studenVle_summary
[0m14:46:42.794693 [debug] [Thread-2  ]: Creating new relation grp5_dq_oulad_studentVle_anomalies
[0m14:46:43.076414 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m14:46:43.081110 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m14:46:43.085277 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m14:46:43.086993 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m14:46:47.925914 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies"} */

            

    
        create table `mart`.`grp5_dq_oulad_studentVle_anomalies`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

with cln as (
    select * from `clean`.`grp5_stg_oulad_studentVle`
),

violations as (
    select
        id_student,
        code_module,
        code_presentation,
        id_site,
        date,
        sum_click,

        multiIf(
            id_student is null, 'null_id_student',
            code_module is null, 'null_code_module',
            code_presentation is null, 'null_code_presentation',
            sum_click is null, 'null_sum_click',
            sum_click < 0, 'negative_sum_click',
            date < 0, 'negative_date',
            NOT (
                (code_module='AAA' AND code_presentation='2013J') OR
                (code_module='AAA' AND code_presentation='2014J') OR
                (code_module='BBB' AND code_presentation='2013J') OR
                (code_module='BBB' AND code_presentation='2014J') OR
                (code_module='BBB' AND code_presentation='2013B') OR
                (code_module='BBB' AND code_presentation='2014B') OR
                (code_module='CCC' AND code_presentation='2014J') OR
                (code_module='CCC' AND code_presentation='2014B') OR
                (code_module='DDD' AND code_presentation='2013J') OR
                (code_module='DDD' AND code_presentation='2014J') OR
                (code_module='DDD' AND code_presentation='2013B') OR
                (code_module='DDD' AND code_presentation='2014B') OR
                (code_module='EEE' AND code_presentation='2013J') OR
                (code_module='EEE' AND code_presentation='2014J') OR
                (code_module='EEE' AND code_presentation='2014B') OR
                (code_module='FFF' AND code_presentation='2013J') OR
                (code_module='FFF' AND code_presentation='2014J') OR
                (code_module='FFF' AND code_presentation='2013B') OR
                (code_module='FFF' AND code_presentation='2014B') OR
                (code_module='GGG' AND code_presentation='2013J') OR
                (code_module='GGG' AND code_presentation='2014J') OR
                (code_module='GGG' AND code_presentation='2014B')
            ), 'invalid_module_presentation',
            'ok'
        ) as dq_issue
    from cln
)

select *
from violations
where dq_issue != 'ok'
limit 50;
          )
        
        ...
[0m14:46:47.929505 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_module_presentation: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_module_presentation"} */

            

    
        create table `sandbox`.`grp5_oulad_dim_module_presentation__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Dimension table for module + presentation (simple, with Nullable types)
select
    cast(code_module as Nullable(String))                           as code_module,
    cast(code_presentation as Nullable(String))                     as code_presentation,
    cast(module_presentation_length as Nullable(Int32))             as length_days
from `clean`.`grp5_stg_oulad_courses`
          )
        
        ...
[0m14:46:48.299878 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_courses: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_courses"} */

            

    
        create table `mart`.`grp5_oulad_dim_courses__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

select
    concat(cast(code_module as Nullable(String)), cast(code_presentation as Nullable(String))) 
        as id_course,
    cast(code_module as Nullable(String))                           as code_module,
    cast(code_presentation as Nullable(String))                     as code_presentation,
    cast(module_presentation_length as Nullable(Int32))             as module_presentation_length
from `clean`.`grp5_stg_oulad_courses`
          )
        
        ...
[0m14:46:48.304721 [debug] [Thread-2  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies"} */

            

    
        create table `mart`.`grp5_dq_oulad_studentVle_anomalies`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

with cln as (
    select * from `clean`.`grp5_stg_oulad_studentVle`
),

violations as (
    select
        id_student,
        code_module,
        code_presentation,
        id_site,
        date,
        sum_click,

        multiIf(
            id_student is null, 'null_id_student',
            code_module is null, 'null_code_module',
            code_presentation is null, 'null_code_presentation',
            sum_click is null, 'null_sum_click',
            sum_click < 0, 'negative_sum_click',
            date < 0, 'negative_date',
            NOT (
                (code_module='AAA' AND code_presentation='2013J') OR
                (code_module='AAA' AND code_presentation='2014J') OR
                (code_module='BBB' AND code_presentation='2013J') OR
                (code_module='BBB' AND code_presentation='2014J') OR
                (code_module='BBB' AND code_presentation='2013B') OR
                (code_module='BBB' AND code_presentation='2014B') OR
                (code_module='CCC' AND code_presentation='2014J') OR
                (code_module='CCC' AND code_presentation='2014B') OR
                (code_module='DDD' AND code_presentation='2013J') OR
                (code_module='DDD' AND code_presentation='2014J') OR
                (code_module='DDD' AND code_presentation='2013B') OR
                (code_module='DDD' AND code_presentation='2014B') OR
                (code_module='EEE' AND code_presentation='2013J') OR
                (code_module='EEE' AND code_presentation='2014J') OR
                (code_module='EEE' AND code_presentation='2014B') OR
                (code_module='FFF' AND code_presentation='2013J') OR
                (code_module='FFF' AND code_presentation='2014J') OR
                (code_module='FFF' AND code_presentation='2013B') OR
                (code_module='FFF' AND code_presentation='2014B') OR
                (code_module='GGG' AND code_presentation='2013J') OR
                (code_module='GGG' AND code_presentation='2014J') OR
                (code_module='GGG' AND code_presentation='2014B')
            ), 'invalid_module_presentation',
            'ok'
        ) as dq_issue
    from cln
)

select *
from violations
where dq_issue != 'ok'
limit 50;
          )
        
        
[0m14:46:48.318125 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.38 seconds
[0m14:46:48.351988 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_module_presentation: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_module_presentation"} */

    select name, type from system.columns where table = 'grp5_oulad_dim_module_presentation__dbt_backup'
    
      and database = 'sandbox'
    
    order by position
  ...
[0m14:46:48.360922 [debug] [Thread-2  ]: Database Error in model grp5_dq_oulad_studentVle_anomalies (models/mart/dq/grp5_dq_oulad_studentVle_anomalies.sql)
  HTTPDriver for http://54.87.106.52:8123 received ClickHouse error code 62
   Code: 62. DB::Exception: Syntax error: failed at position 2769 (end of query) (line 77, col 9): ;
            )
          
          . Expected one of: token, DoubleColon, OR, AND, IS NOT DISTINCT FROM, IS NULL, IS NOT NULL, BETWEEN, NOT BETWEEN, LIKE, ILIKE, NOT LIKE, NOT ILIKE, REGEXP, IN, NOT IN, GLOBAL IN, GLOBAL NOT IN, MOD, DIV, alias, AS, Comma, OFFSET, WITH TIES, BY, FETCH, LIMIT, SETTINGS, UNION, EXCEPT, INTERSECT. (SYNTAX_ERROR) (version 23.12.6.19 (official build))
[0m14:46:48.366004 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dd2ba41-397b-45f5-8763-3d8489a77524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a4f782f820>]}
[0m14:46:48.368875 [error] [Thread-2  ]: 2 of 7 ERROR creating sql table model `mart`.`grp5_dq_oulad_studentVle_anomalies`  [[31mERROR[0m in 5.86s]
[0m14:46:48.372483 [debug] [Thread-2  ]: Finished running node model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies
[0m14:46:48.374565 [debug] [Thread-2  ]: Began running node model.ex_09_oulad.grp5_oulad_dim_student
[0m14:46:48.377563 [info ] [Thread-2  ]: 5 of 7 START sql table model `sandbox`.`grp5_oulad_dim_student` ................ [RUN]
[0m14:46:48.380519 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies, now model.ex_09_oulad.grp5_oulad_dim_student)
[0m14:46:48.383275 [debug] [Thread-2  ]: Began compiling node model.ex_09_oulad.grp5_oulad_dim_student
[0m14:46:48.400470 [debug] [Thread-2  ]: Writing injected SQL for node "model.ex_09_oulad.grp5_oulad_dim_student"
[0m14:46:48.402990 [debug] [Thread-2  ]: Began executing node model.ex_09_oulad.grp5_oulad_dim_student
[0m14:46:48.428343 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_student: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_student"} */

            

    
        create table `sandbox`.`grp5_oulad_dim_student__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Dimension table for students (no surrogate key)
select
    cast(id_student as Int64)               as id_student,
    cast(gender as Nullable(String))        as gender,
    cast(age_band as Nullable(String))      as age_band,
    cast(region as Nullable(String))        as region,
    cast(highest_education as Nullable(String)) as highest_education,
    cast(imd_band as Nullable(String))      as imd_band,
    cast(disability as Nullable(String))    as disability
from `clean`.`grp5_stg_oulad_student_info`
          )
        
        ...
[0m14:46:48.678554 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.37 seconds
[0m14:46:48.674477 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_dq_oulad_studenVle_summary: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_dq_oulad_studenVle_summary"} */

            

    
        create table `mart`.`grp5_dq_oulad_studenVle_summary`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

with src as (
    select * from `raw`.`studentVle`
),
cln as (
    select * from `clean`.`grp5_stg_oulad_studentVle`
),

counts as (
    select
        (select count(*) from src) as row_count_raw,
        (select count(*) from cln) as row_count_clean
),

nulls as (
    select
        round(100.0 * countIf(id_student is null) / nullif(count(),0),2) as pct_null_id_student,
        round(100.0 * countIf(code_module is null) / nullif(count(),0),2) as pct_null_code_module,
        round(100.0 * countIf(code_presentation is null) / nullif(count(),0),2) as pct_null_code_presentation,
        round(100.0 * countIf(sum_click is null) / nullif(count(),0),2) as pct_null_sum_click
    from cln
),

domains as (
    select
        countIf(
            NOT (
                (code_module='AAA' AND code_presentation='2013J') OR
                (code_module='AAA' AND code_presentation='2014J') OR
                (code_module='BBB' AND code_presentation='2013J') OR
                (code_module='BBB' AND code_presentation='2014J') OR
                (code_module='BBB' AND code_presentation='2013B') OR
                (code_module='BBB' AND code_presentation='2014B') OR
                (code_module='CCC' AND code_presentation='2014J') OR
                (code_module='CCC' AND code_presentation='2014B') OR
                (code_module='DDD' AND code_presentation='2013J') OR
                (code_module='DDD' AND code_presentation='2014J') OR
                (code_module='DDD' AND code_presentation='2013B') OR
                (code_module='DDD' AND code_presentation='2014B') OR
                (code_module='EEE' AND code_presentation='2013J') OR
                (code_module='EEE' AND code_presentation='2014J') OR
                (code_module='EEE' AND code_presentation='2014B') OR
                (code_module='FFF' AND code_presentation='2013J') OR
                (code_module='FFF' AND code_presentation='2014J') OR
                (code_module='FFF' AND code_presentation='2013B') OR
                (code_module='FFF' AND code_presentation='2014B') OR
                (code_module='GGG' AND code_presentation='2013J') OR
                (code_module='GGG' AND code_presentation='2014J') OR
                (code_module='GGG' AND code_presentation='2014B')
            )
        ) as invalid_module_presentation
    from cln
),

bounds as (
    select
        countIf(sum_click < 0) as negative_sum_click,
        countIf(date < 0) as negative_date
    from cln
),

joined as (
    select
        counts.row_count_raw,
        counts.row_count_clean,
        (counts.row_count_raw - counts.row_count_clean) as dropped_rows,
        nulls.pct_null_id_student,
        nulls.pct_null_code_module,
        nulls.pct_null_code_presentation,
        nulls.pct_null_sum_click,
        domains.invalid_module_presentation,
        bounds.negative_sum_click,
        bounds.negative_date
    from counts
    cross join nulls
    cross join domains
    cross join bounds
)

select * from joined;
          )
        
        ...
[0m14:46:48.702323 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_courses: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_courses"} */

    select name, type from system.columns where table = 'grp5_oulad_dim_courses__dbt_backup'
    
      and database = 'mart'
    
    order by position
  ...
[0m14:46:49.036967 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.68 seconds
[0m14:46:49.039763 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.61 seconds
[0m14:46:49.050574 [debug] [Thread-4  ]: Writing runtime sql for node "model.ex_09_oulad.grp5_oulad_dim_module_presentation"
[0m14:46:49.061110 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_student: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_student"} */

    select name, type from system.columns where table = 'grp5_oulad_dim_student__dbt_backup'
    
      and database = 'sandbox'
    
    order by position
  ...
[0m14:46:49.063854 [debug] [Thread-1  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_dq_oulad_studenVle_summary"} */

            

    
        create table `mart`.`grp5_dq_oulad_studenVle_summary`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

with src as (
    select * from `raw`.`studentVle`
),
cln as (
    select * from `clean`.`grp5_stg_oulad_studentVle`
),

counts as (
    select
        (select count(*) from src) as row_count_raw,
        (select count(*) from cln) as row_count_clean
),

nulls as (
    select
        round(100.0 * countIf(id_student is null) / nullif(count(),0),2) as pct_null_id_student,
        round(100.0 * countIf(code_module is null) / nullif(count(),0),2) as pct_null_code_module,
        round(100.0 * countIf(code_presentation is null) / nullif(count(),0),2) as pct_null_code_presentation,
        round(100.0 * countIf(sum_click is null) / nullif(count(),0),2) as pct_null_sum_click
    from cln
),

domains as (
    select
        countIf(
            NOT (
                (code_module='AAA' AND code_presentation='2013J') OR
                (code_module='AAA' AND code_presentation='2014J') OR
                (code_module='BBB' AND code_presentation='2013J') OR
                (code_module='BBB' AND code_presentation='2014J') OR
                (code_module='BBB' AND code_presentation='2013B') OR
                (code_module='BBB' AND code_presentation='2014B') OR
                (code_module='CCC' AND code_presentation='2014J') OR
                (code_module='CCC' AND code_presentation='2014B') OR
                (code_module='DDD' AND code_presentation='2013J') OR
                (code_module='DDD' AND code_presentation='2014J') OR
                (code_module='DDD' AND code_presentation='2013B') OR
                (code_module='DDD' AND code_presentation='2014B') OR
                (code_module='EEE' AND code_presentation='2013J') OR
                (code_module='EEE' AND code_presentation='2014J') OR
                (code_module='EEE' AND code_presentation='2014B') OR
                (code_module='FFF' AND code_presentation='2013J') OR
                (code_module='FFF' AND code_presentation='2014J') OR
                (code_module='FFF' AND code_presentation='2013B') OR
                (code_module='FFF' AND code_presentation='2014B') OR
                (code_module='GGG' AND code_presentation='2013J') OR
                (code_module='GGG' AND code_presentation='2014J') OR
                (code_module='GGG' AND code_presentation='2014B')
            )
        ) as invalid_module_presentation
    from cln
),

bounds as (
    select
        countIf(sum_click < 0) as negative_sum_click,
        countIf(date < 0) as negative_date
    from cln
),

joined as (
    select
        counts.row_count_raw,
        counts.row_count_clean,
        (counts.row_count_raw - counts.row_count_clean) as dropped_rows,
        nulls.pct_null_id_student,
        nulls.pct_null_code_module,
        nulls.pct_null_code_presentation,
        nulls.pct_null_sum_click,
        domains.invalid_module_presentation,
        bounds.negative_sum_click,
        bounds.negative_date
    from counts
    cross join nulls
    cross join domains
    cross join bounds
)

select * from joined;
          )
        
        
[0m14:46:49.070379 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_module_presentation: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_module_presentation"} */

  
    
    
    
        
         


        insert into `sandbox`.`grp5_oulad_dim_module_presentation__dbt_backup`
        ("code_module", "code_presentation", "length_days")

-- Dimension table for module + presentation (simple, with Nullable types)
select
    cast(code_module as Nullable(String))                           as code_module,
    cast(code_presentation as Nullable(String))                     as code_presentation,
    cast(module_presentation_length as Nullable(Int32))             as length_days
from `clean`.`grp5_stg_oulad_courses`
  ...
[0m14:46:49.078901 [debug] [Thread-1  ]: Database Error in model grp5_dq_oulad_studenVle_summary (models/mart/dq/grp5_dq_oulad_studenVle_summary.sql)
  HTTPDriver for http://54.87.106.52:8123 received ClickHouse error code 62
   Code: 62. DB::Exception: Syntax error: failed at position 3529 (end of query) (line 103, col 21): ;
            )
          
          . Expected one of: token, Dot, OpeningRoundBracket, UUID, alias, AS, identifier, FINAL, SAMPLE, table, table function, subquery or list of joined tables, array join, LEFT ARRAY JOIN, INNER, ARRAY JOIN, JOIN, PREWHERE, WHERE, GROUP BY, WITH, HAVING, WINDOW, ORDER BY, LIMIT, OFFSET, FETCH, SETTINGS, UNION, EXCEPT, INTERSECT. (SYNTAX_ERROR) (version 23.12.6.19 (official build))
[0m14:46:49.082051 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dd2ba41-397b-45f5-8763-3d8489a77524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a4f81c8670>]}
[0m14:46:49.084333 [error] [Thread-1  ]: 1 of 7 ERROR creating sql table model `mart`.`grp5_dq_oulad_studenVle_summary` . [[31mERROR[0m in 6.58s]
[0m14:46:49.086892 [debug] [Thread-1  ]: Finished running node model.ex_09_oulad.grp5_dq_oulad_studenVle_summary
[0m14:46:49.089221 [debug] [Thread-1  ]: Began running node model.ex_09_oulad.grp5_stg_oulad_student_assessment
[0m14:46:49.091514 [info ] [Thread-1  ]: 6 of 7 START sql table model `clean`.`grp5_stg_oulad_student_assessment` ....... [RUN]
[0m14:46:49.093836 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ex_09_oulad.grp5_dq_oulad_studenVle_summary, now model.ex_09_oulad.grp5_stg_oulad_student_assessment)
[0m14:46:49.096224 [debug] [Thread-1  ]: Began compiling node model.ex_09_oulad.grp5_stg_oulad_student_assessment
[0m14:46:49.109274 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_09_oulad.grp5_stg_oulad_student_assessment"
[0m14:46:49.111985 [debug] [Thread-1  ]: Began executing node model.ex_09_oulad.grp5_stg_oulad_student_assessment
[0m14:46:49.130626 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_assessment"} */

            

    
        create table `clean`.`grp5_stg_oulad_student_assessment__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
             

-- Standardize names and types for student assessment
select
  cast(id_assessment  as Nullable(Int64)) as assessment_id,
  cast(id_student     as Nullable(Int64)) as student_id,
  cast(date_submitted as Nullable(Int64)) as date_submitted,
  cast(is_banked      as Nullable(Int64)) as is_banked,
  cast(score          as Nullable(Int64)) as score
from `raw`.`grp5_oulad___student_assessment`
          )
        
        ...
[0m14:46:49.198333 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.49 seconds
[0m14:46:49.202713 [debug] [Thread-3  ]: Writing runtime sql for node "model.ex_09_oulad.grp5_oulad_dim_courses"
[0m14:46:49.204742 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_courses: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_courses"} */

  
    
    
    
        
         


        insert into `mart`.`grp5_oulad_dim_courses__dbt_backup`
        ("id_course", "code_module", "code_presentation", "module_presentation_length")

select
    concat(cast(code_module as Nullable(String)), cast(code_presentation as Nullable(String))) 
        as id_course,
    cast(code_module as Nullable(String))                           as code_module,
    cast(code_presentation as Nullable(String))                     as code_presentation,
    cast(module_presentation_length as Nullable(Int32))             as module_presentation_length
from `clean`.`grp5_stg_oulad_courses`
  ...
[0m14:46:49.499561 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.43 seconds
[0m14:46:49.502216 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.37 seconds
[0m14:46:49.504929 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.43 seconds
[0m14:46:49.509923 [debug] [Thread-2  ]: Writing runtime sql for node "model.ex_09_oulad.grp5_oulad_dim_student"
[0m14:46:49.518854 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_assessment"} */

    select name, type from system.columns where table = 'grp5_stg_oulad_student_assessment__dbt_backup'
    
      and database = 'clean'
    
    order by position
  ...
[0m14:46:49.534699 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_module_presentation: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_module_presentation"} */
EXCHANGE TABLES `sandbox`.`grp5_oulad_dim_module_presentation__dbt_backup` AND `sandbox`.`grp5_oulad_dim_module_presentation` 
  
  ...
[0m14:46:49.542658 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_student: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_student"} */

  
    
    
    
        
         


        insert into `sandbox`.`grp5_oulad_dim_student__dbt_backup`
        ("id_student", "gender", "age_band", "region", "highest_education", "imd_band", "disability")

-- Dimension table for students (no surrogate key)
select
    cast(id_student as Int64)               as id_student,
    cast(gender as Nullable(String))        as gender,
    cast(age_band as Nullable(String))      as age_band,
    cast(region as Nullable(String))        as region,
    cast(highest_education as Nullable(String)) as highest_education,
    cast(imd_band as Nullable(String))      as imd_band,
    cast(disability as Nullable(String))    as disability
from `clean`.`grp5_stg_oulad_student_info`
  ...
[0m14:46:49.694052 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.49 seconds
[0m14:46:49.697851 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_courses: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_courses"} */
EXCHANGE TABLES `mart`.`grp5_oulad_dim_courses__dbt_backup` AND `mart`.`grp5_oulad_dim_courses` 
  
  ...
[0m14:46:49.952577 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.41 seconds
[0m14:46:49.956348 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.41 seconds
[0m14:46:49.965749 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.43 seconds
[0m14:46:49.981085 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_student: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_student"} */
EXCHANGE TABLES `sandbox`.`grp5_oulad_dim_student__dbt_backup` AND `sandbox`.`grp5_oulad_dim_student` 
  
  ...
[0m14:46:50.003955 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_09_oulad.grp5_stg_oulad_student_assessment"
[0m14:46:50.047780 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_module_presentation: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_module_presentation"} */

    drop table if exists `sandbox`.`grp5_oulad_dim_module_presentation__dbt_backup` 
  ...
[0m14:46:50.052732 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_assessment"} */

  
    
    
    
        
         


        insert into `clean`.`grp5_stg_oulad_student_assessment__dbt_backup`
        ("assessment_id", "student_id", "date_submitted", "is_banked", "score") 

-- Standardize names and types for student assessment
select
  cast(id_assessment  as Nullable(Int64)) as assessment_id,
  cast(id_student     as Nullable(Int64)) as student_id,
  cast(date_submitted as Nullable(Int64)) as date_submitted,
  cast(is_banked      as Nullable(Int64)) as is_banked,
  cast(score          as Nullable(Int64)) as score
from `raw`.`grp5_oulad___student_assessment`
  ...
[0m14:46:50.361747 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.66 seconds
[0m14:46:50.373555 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_courses: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_courses"} */

    drop table if exists `mart`.`grp5_oulad_dim_courses__dbt_backup` 
  ...
[0m14:46:50.381120 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.33 seconds
[0m14:46:50.389011 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dd2ba41-397b-45f5-8763-3d8489a77524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a4fcb07c10>]}
[0m14:46:50.390760 [info ] [Thread-4  ]: 4 of 7 OK created sql table model `sandbox`.`grp5_oulad_dim_module_presentation`  [[32mOK[0m in 7.88s]
[0m14:46:50.393184 [debug] [Thread-4  ]: Finished running node model.ex_09_oulad.grp5_oulad_dim_module_presentation
[0m14:46:50.394713 [debug] [Thread-4  ]: Began running node model.ex_09_oulad.grp5_stg_oulad_student_info
[0m14:46:50.396692 [info ] [Thread-4  ]: 7 of 7 START sql table model `clean`.`grp5_stg_oulad_student_info` ............. [RUN]
[0m14:46:50.399450 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.ex_09_oulad.grp5_oulad_dim_module_presentation, now model.ex_09_oulad.grp5_stg_oulad_student_info)
[0m14:46:50.401322 [debug] [Thread-4  ]: Began compiling node model.ex_09_oulad.grp5_stg_oulad_student_info
[0m14:46:50.414635 [debug] [Thread-4  ]: Writing injected SQL for node "model.ex_09_oulad.grp5_stg_oulad_student_info"
[0m14:46:50.416577 [debug] [Thread-4  ]: Began executing node model.ex_09_oulad.grp5_stg_oulad_student_info
[0m14:46:50.433002 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_info: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_info"} */

            

    
        create table `clean`.`grp5_stg_oulad_student_info__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            
select
  cast(code_module            as String)     as code_module,
  cast(code_presentation      as String)     as code_presentation,
  cast(id_student             as Int64)      as id_student,
  cast(
    case
      when gender IN ('M', 'F') then gender
      else 'Unknown'
    end as String) as gender,
  cast(region                 as String)     as region,
  cast(highest_education      as String)     as highest_education,
  cast(
    case
        when imd_band = '?' then null
        when imd_band not like '%\%%' then concat(imd_band, '%')
        else imd_band
    end as Nullable(String)) as imd_band,
  cast(age_band               as String)     as age_band,
  cast(num_of_prev_attempts   as Int64)      as num_of_prev_attempts,
  cast(studied_credits        as Int64)      as studied_credits,
  cast(disability             as String)     as disability,
  cast(final_result           as String)     as final_result
from `raw`.`grp5_oulad___student_info`
          )
        
        ...
[0m14:46:50.665612 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.61 seconds
[0m14:46:50.669599 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.64 seconds
[0m14:46:50.675293 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_assessment"} */
EXCHANGE TABLES `clean`.`grp5_stg_oulad_student_assessment__dbt_backup` AND `clean`.`grp5_stg_oulad_student_assessment` 
  
  ...
[0m14:46:50.715214 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_student: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_student"} */

    drop table if exists `sandbox`.`grp5_oulad_dim_student__dbt_backup` 
  ...
[0m14:46:51.018593 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.64 seconds
[0m14:46:51.023060 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.31 seconds
[0m14:46:51.025724 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.59 seconds
[0m14:46:51.030417 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dd2ba41-397b-45f5-8763-3d8489a77524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a4f8383520>]}
[0m14:46:51.035757 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dd2ba41-397b-45f5-8763-3d8489a77524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a4fad1f5e0>]}
[0m14:46:51.046655 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_info: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_info"} */

    select name, type from system.columns where table = 'grp5_stg_oulad_student_info__dbt_backup'
    
      and database = 'clean'
    
    order by position
  ...
[0m14:46:51.048871 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.34 seconds
[0m14:46:51.051332 [info ] [Thread-3  ]: 3 of 7 OK created sql table model `mart`.`grp5_oulad_dim_courses` .............. [[32mOK[0m in 8.52s]
[0m14:46:51.054245 [info ] [Thread-2  ]: 5 of 7 OK created sql table model `sandbox`.`grp5_oulad_dim_student` ........... [[32mOK[0m in 2.66s]
[0m14:46:51.081318 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_assessment"} */

    drop table if exists `clean`.`grp5_stg_oulad_student_assessment__dbt_backup` 
  ...
[0m14:46:51.084571 [debug] [Thread-3  ]: Finished running node model.ex_09_oulad.grp5_oulad_dim_courses
[0m14:46:51.088375 [debug] [Thread-2  ]: Finished running node model.ex_09_oulad.grp5_oulad_dim_student
[0m14:46:51.575972 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.52 seconds
[0m14:46:51.579408 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.49 seconds
[0m14:46:51.586951 [debug] [Thread-4  ]: Writing runtime sql for node "model.ex_09_oulad.grp5_stg_oulad_student_info"
[0m14:46:51.593597 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dd2ba41-397b-45f5-8763-3d8489a77524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a4f9afb490>]}
[0m14:46:51.597826 [info ] [Thread-1  ]: 6 of 7 OK created sql table model `clean`.`grp5_stg_oulad_student_assessment` .. [[32mOK[0m in 2.50s]
[0m14:46:51.606287 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_info: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_info"} */

  
    
    
    
        
         


        insert into `clean`.`grp5_stg_oulad_student_info__dbt_backup`
        ("code_module", "code_presentation", "id_student", "gender", "region", "highest_education", "imd_band", "age_band", "num_of_prev_attempts", "studied_credits", "disability", "final_result")
select
  cast(code_module            as String)     as code_module,
  cast(code_presentation      as String)     as code_presentation,
  cast(id_student             as Int64)      as id_student,
  cast(
    case
      when gender IN ('M', 'F') then gender
      else 'Unknown'
    end as String) as gender,
  cast(region                 as String)     as region,
  cast(highest_education      as String)     as highest_education,
  cast(
    case
        when imd_band = '?' then null
        when imd_band not like '%\%%' then concat(imd_band, '%')
        else imd_band
    end as Nullable(String)) as imd_band,
  cast(age_band               as String)     as age_band,
  cast(num_of_prev_attempts   as Int64)      as num_of_prev_attempts,
  cast(studied_credits        as Int64)      as studied_credits,
  cast(disability             as String)     as disability,
  cast(final_result           as String)     as final_result
from `raw`.`grp5_oulad___student_info`
  ...
[0m14:46:51.603390 [debug] [Thread-1  ]: Finished running node model.ex_09_oulad.grp5_stg_oulad_student_assessment
[0m14:46:52.321246 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.71 seconds
[0m14:46:52.327001 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_info: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_info"} */
EXCHANGE TABLES `clean`.`grp5_stg_oulad_student_info__dbt_backup` AND `clean`.`grp5_stg_oulad_student_info` 
  
  ...
[0m14:46:52.943397 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.61 seconds
[0m14:46:52.962503 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_info: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_info"} */

    drop table if exists `clean`.`grp5_stg_oulad_student_info__dbt_backup` 
  ...
[0m14:46:53.641723 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.68 seconds
[0m14:46:53.647391 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dd2ba41-397b-45f5-8763-3d8489a77524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a4fa1bd0a0>]}
[0m14:46:53.649312 [info ] [Thread-4  ]: 7 of 7 OK created sql table model `clean`.`grp5_stg_oulad_student_info` ........ [[32mOK[0m in 3.25s]
[0m14:46:53.652085 [debug] [Thread-4  ]: Finished running node model.ex_09_oulad.grp5_stg_oulad_student_info
[0m14:46:53.657696 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:46:53.659332 [debug] [MainThread]: Connection 'list__sandbox' was left open.
[0m14:46:53.660643 [debug] [MainThread]: On list__sandbox: Close
[0m14:46:53.662038 [debug] [MainThread]: Connection 'list__clean' was left open.
[0m14:46:53.663768 [debug] [MainThread]: On list__clean: Close
[0m14:46:53.665147 [debug] [MainThread]: Connection 'list__mart' was left open.
[0m14:46:53.666032 [debug] [MainThread]: On list__mart: Close
[0m14:46:53.666966 [debug] [MainThread]: Connection 'model.ex_09_oulad.grp5_stg_oulad_student_assessment' was left open.
[0m14:46:53.668197 [debug] [MainThread]: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: Close
[0m14:46:53.669412 [debug] [MainThread]: Connection 'model.ex_09_oulad.grp5_oulad_dim_student' was left open.
[0m14:46:53.671302 [debug] [MainThread]: On model.ex_09_oulad.grp5_oulad_dim_student: Close
[0m14:46:53.672744 [debug] [MainThread]: Connection 'model.ex_09_oulad.grp5_oulad_dim_courses' was left open.
[0m14:46:53.673651 [debug] [MainThread]: On model.ex_09_oulad.grp5_oulad_dim_courses: Close
[0m14:46:53.674668 [debug] [MainThread]: Connection 'model.ex_09_oulad.grp5_stg_oulad_student_info' was left open.
[0m14:46:53.676122 [debug] [MainThread]: On model.ex_09_oulad.grp5_stg_oulad_student_info: Close
[0m14:46:53.678973 [info ] [MainThread]: 
[0m14:46:53.681011 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 21.12 seconds (21.12s).
[0m14:46:53.687679 [debug] [MainThread]: Command end result
[0m14:46:53.867640 [info ] [MainThread]: 
[0m14:46:53.869954 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m14:46:53.872085 [info ] [MainThread]: 
[0m14:46:53.874687 [error] [MainThread]:   Database Error in model grp5_dq_oulad_studentVle_anomalies (models/mart/dq/grp5_dq_oulad_studentVle_anomalies.sql)
  HTTPDriver for http://54.87.106.52:8123 received ClickHouse error code 62
   Code: 62. DB::Exception: Syntax error: failed at position 2769 (end of query) (line 77, col 9): ;
            )
          
          . Expected one of: token, DoubleColon, OR, AND, IS NOT DISTINCT FROM, IS NULL, IS NOT NULL, BETWEEN, NOT BETWEEN, LIKE, ILIKE, NOT LIKE, NOT ILIKE, REGEXP, IN, NOT IN, GLOBAL IN, GLOBAL NOT IN, MOD, DIV, alias, AS, Comma, OFFSET, WITH TIES, BY, FETCH, LIMIT, SETTINGS, UNION, EXCEPT, INTERSECT. (SYNTAX_ERROR) (version 23.12.6.19 (official build))
[0m14:46:53.877018 [info ] [MainThread]: 
[0m14:46:53.888404 [error] [MainThread]:   Database Error in model grp5_dq_oulad_studenVle_summary (models/mart/dq/grp5_dq_oulad_studenVle_summary.sql)
  HTTPDriver for http://54.87.106.52:8123 received ClickHouse error code 62
   Code: 62. DB::Exception: Syntax error: failed at position 3529 (end of query) (line 103, col 21): ;
            )
          
          . Expected one of: token, Dot, OpeningRoundBracket, UUID, alias, AS, identifier, FINAL, SAMPLE, table, table function, subquery or list of joined tables, array join, LEFT ARRAY JOIN, INNER, ARRAY JOIN, JOIN, PREWHERE, WHERE, GROUP BY, WITH, HAVING, WINDOW, ORDER BY, LIMIT, OFFSET, FETCH, SETTINGS, UNION, EXCEPT, INTERSECT. (SYNTAX_ERROR) (version 23.12.6.19 (official build))
[0m14:46:53.890933 [info ] [MainThread]: 
[0m14:46:53.893118 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=0 TOTAL=7
[0m14:46:53.901975 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 26.345476, "process_in_blocks": "1224", "process_kernel_time": 2.978385, "process_mem_max_rss": "118428", "process_out_blocks": "10856", "process_user_time": 12.289758}
[0m14:46:53.910203 [debug] [MainThread]: Command `dbt build` failed at 14:46:53.909266 after 26.36 seconds
[0m14:46:53.912865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a4fd5f7e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a4f86567c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a4f85466a0>]}
[0m14:46:53.915137 [debug] [MainThread]: Flushing usage events
[0m14:53:27.597366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7357477bf310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73574441bb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73574441ba30>]}


============================== 14:53:27.614851 | c4a2ae13-d21d-4ff1-81d8-43ae1699225b ==============================
[0m14:53:27.614851 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:53:27.616956 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'debug': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'version_check': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt build --profiles-dir . --target remote', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'empty': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/workdir/transforms/09_oulad/logs', 'static_parser': 'True', 'use_colors': 'True', 'profiles_dir': '.', 'fail_fast': 'False', 'printer_width': '80', 'log_format': 'default', 'write_json': 'True', 'target_path': 'None', 'warn_error': 'None', 'introspect': 'True', 'indirect_selection': 'eager'}
[0m14:53:28.026569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4a2ae13-d21d-4ff1-81d8-43ae1699225b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7357443e1790>]}
[0m14:53:28.162244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c4a2ae13-d21d-4ff1-81d8-43ae1699225b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73574431c970>]}
[0m14:53:28.164390 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m14:53:28.477157 [debug] [MainThread]: checksum: 265ce5244aff672775eaff93c261d21692ed3f5650f4d9e918c76acdb0e9479a, vars: {}, profile: , target: remote, version: 1.8.9
[0m14:53:28.819207 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m14:53:28.822085 [debug] [MainThread]: Partial parsing: updated file: ex_09_oulad://models/mart/dq/schema.yml
[0m14:53:28.823173 [debug] [MainThread]: Partial parsing: updated file: ex_09_oulad://models/mart/dq/grp5_dq_oulad_studentVle_anomalies.sql
[0m14:53:28.823955 [debug] [MainThread]: Partial parsing: updated file: ex_09_oulad://models/mart/dq/grp5_dq_oulad_studenVle_summary.sql
[0m14:53:29.484372 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'grp5_dq_oulad_studentVle_summary' in the 'models' section of file 'models/mart/dq/schema.yml'
[0m14:53:29.702998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4a2ae13-d21d-4ff1-81d8-43ae1699225b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735742777100>]}
[0m14:53:30.048299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4a2ae13-d21d-4ff1-81d8-43ae1699225b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7357427089d0>]}
[0m14:53:30.049600 [info ] [MainThread]: Found 7 models, 6 sources, 471 macros
[0m14:53:30.056202 [info ] [MainThread]: 
[0m14:53:30.058636 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m14:53:30.089265 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m14:53:30.091326 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m14:53:30.106975 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m14:53:30.178746 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:53:30.194084 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:53:30.202333 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:53:36.171505 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m14:53:36.924210 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.75 seconds
[0m14:53:37.373941 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m14:53:37.377637 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m14:53:37.742458 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.36 seconds
[0m14:53:37.745760 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.36 seconds
[0m14:53:37.761089 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__sandbox)
[0m14:53:37.770252 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__clean)
[0m14:53:37.795509 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list__mart'
[0m14:53:37.841463 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list__clean"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'clean'
      

  ...
[0m14:53:37.844335 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:53:37.846469 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__sandbox: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list__sandbox"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'sandbox'
      

  ...
[0m14:53:38.181183 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.33 seconds
[0m14:53:38.187311 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.33 seconds
[0m14:53:42.363140 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list__mart"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'mart'
      

  ...
[0m14:53:42.745596 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.38 seconds
[0m14:53:43.310077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4a2ae13-d21d-4ff1-81d8-43ae1699225b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735744104a30>]}
[0m14:53:43.314049 [info ] [MainThread]: Concurrency: 4 threads (target='remote')
[0m14:53:43.316459 [info ] [MainThread]: 
[0m14:53:43.411471 [debug] [Thread-1  ]: Began running node model.ex_09_oulad.grp5_dq_oulad_studenVle_summary
[0m14:53:43.413387 [debug] [Thread-2  ]: Began running node model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies
[0m14:53:43.418310 [info ] [Thread-1  ]: 1 of 7 START sql view model `mart`.`grp5_dq_oulad_studenVle_summary` ........... [RUN]
[0m14:53:43.421417 [debug] [Thread-3  ]: Began running node model.ex_09_oulad.grp5_oulad_dim_courses
[0m14:53:43.423379 [info ] [Thread-2  ]: 2 of 7 START sql view model `mart`.`grp5_dq_oulad_studentVle_anomalies` ........ [RUN]
[0m14:53:43.425452 [debug] [Thread-4  ]: Began running node model.ex_09_oulad.grp5_oulad_dim_module_presentation
[0m14:53:43.428116 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.ex_09_oulad.grp5_dq_oulad_studenVle_summary'
[0m14:53:43.431535 [info ] [Thread-3  ]: 3 of 7 START sql table model `mart`.`grp5_oulad_dim_courses` ................... [RUN]
[0m14:53:43.435076 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list__mart, now model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies)
[0m14:53:43.437650 [info ] [Thread-4  ]: 4 of 7 START sql table model `sandbox`.`grp5_oulad_dim_module_presentation` .... [RUN]
[0m14:53:43.439796 [debug] [Thread-1  ]: Began compiling node model.ex_09_oulad.grp5_dq_oulad_studenVle_summary
[0m14:53:43.442618 [debug] [Thread-3  ]: Acquiring new clickhouse connection 'model.ex_09_oulad.grp5_oulad_dim_courses'
[0m14:53:43.445066 [debug] [Thread-2  ]: Began compiling node model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies
[0m14:53:43.447582 [debug] [Thread-4  ]: Acquiring new clickhouse connection 'model.ex_09_oulad.grp5_oulad_dim_module_presentation'
[0m14:53:43.467778 [debug] [Thread-3  ]: Began compiling node model.ex_09_oulad.grp5_oulad_dim_courses
[0m14:53:43.486545 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_09_oulad.grp5_dq_oulad_studenVle_summary"
[0m14:53:43.500094 [debug] [Thread-4  ]: Began compiling node model.ex_09_oulad.grp5_oulad_dim_module_presentation
[0m14:53:43.498862 [debug] [Thread-2  ]: Writing injected SQL for node "model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies"
[0m14:53:43.510977 [debug] [Thread-3  ]: Writing injected SQL for node "model.ex_09_oulad.grp5_oulad_dim_courses"
[0m14:53:43.523854 [debug] [Thread-4  ]: Writing injected SQL for node "model.ex_09_oulad.grp5_oulad_dim_module_presentation"
[0m14:53:43.527288 [debug] [Thread-1  ]: Began executing node model.ex_09_oulad.grp5_dq_oulad_studenVle_summary
[0m14:53:43.529361 [debug] [Thread-2  ]: Began executing node model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies
[0m14:53:43.537712 [debug] [Thread-3  ]: Began executing node model.ex_09_oulad.grp5_oulad_dim_courses
[0m14:53:43.550855 [debug] [Thread-4  ]: Began executing node model.ex_09_oulad.grp5_oulad_dim_module_presentation
[0m14:53:43.674866 [debug] [Thread-1  ]: Creating new relation grp5_dq_oulad_studenVle_summary
[0m14:53:43.728857 [debug] [Thread-2  ]: Creating new relation grp5_dq_oulad_studentVle_anomalies
[0m14:53:43.821344 [debug] [Thread-2  ]: Writing runtime sql for node "model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies"
[0m14:53:43.823083 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m14:53:43.856101 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies"} */


  create view `mart`.`grp5_dq_oulad_studentVle_anomalies` 
  
    
    
  as (
    

with cln as (
    select * from `clean`.`grp5_stg_oulad_studentVle`
),

violations as (
    select
        code_module,
        code_presentation,
        id_student,
        id_site,
        date,
        sum_click,

        multiIf(
            id_student is null,                 'null_id_student',
            sum_click is null,                  'null_sum_click',
            NOT (
                (code_module='AAA' AND code_presentation='2013J') OR
                (code_module='AAA' AND code_presentation='2014J') OR
                (code_module='BBB' AND code_presentation='2013J') OR
                (code_module='BBB' AND code_presentation='2014J') OR
                (code_module='BBB' AND code_presentation='2013B') OR
                (code_module='BBB' AND code_presentation='2014B') OR
                (code_module='CCC' AND code_presentation='2014J') OR
                (code_module='CCC' AND code_presentation='2014B') OR
                (code_module='DDD' AND code_presentation='2013J') OR
                (code_module='DDD' AND code_presentation='2014J') OR
                (code_module='DDD' AND code_presentation='2013B') OR
                (code_module='DDD' AND code_presentation='2014B') OR
                (code_module='EEE' AND code_presentation='2013J') OR
                (code_module='EEE' AND code_presentation='2014J') OR
                (code_module='EEE' AND code_presentation='2014B') OR
                (code_module='FFF' AND code_presentation='2013J') OR
                (code_module='FFF' AND code_presentation='2014J') OR
                (code_module='FFF' AND code_presentation='2013B') OR
                (code_module='FFF' AND code_presentation='2014B') OR
                (code_module='GGG' AND code_presentation='2013J') OR
                (code_module='GGG' AND code_presentation='2014J') OR
                (code_module='GGG' AND code_presentation='2014B')
            ), 'invalid_module_presentation',
            'ok'
        ) as dq_issue
    from cln
)

select *
from violations
where dq_issue != 'ok'
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m14:53:43.926822 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m14:53:43.928479 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m14:53:44.412651 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.53 seconds
[0m14:53:44.502823 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4a2ae13-d21d-4ff1-81d8-43ae1699225b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7357441136d0>]}
[0m14:53:44.506144 [info ] [Thread-2  ]: 2 of 7 OK created sql view model `mart`.`grp5_dq_oulad_studentVle_anomalies` ... [[32mOK[0m in 1.06s]
[0m14:53:44.511102 [debug] [Thread-2  ]: Finished running node model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies
[0m14:53:44.513049 [debug] [Thread-2  ]: Began running node model.ex_09_oulad.grp5_oulad_dim_student
[0m14:53:44.518703 [info ] [Thread-2  ]: 5 of 7 START sql table model `sandbox`.`grp5_oulad_dim_student` ................ [RUN]
[0m14:53:44.522181 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies, now model.ex_09_oulad.grp5_oulad_dim_student)
[0m14:53:44.525085 [debug] [Thread-2  ]: Began compiling node model.ex_09_oulad.grp5_oulad_dim_student
[0m14:53:44.546327 [debug] [Thread-2  ]: Writing injected SQL for node "model.ex_09_oulad.grp5_oulad_dim_student"
[0m14:53:44.548833 [debug] [Thread-2  ]: Began executing node model.ex_09_oulad.grp5_oulad_dim_student
[0m14:53:44.567194 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_student: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_student"} */

            

    
        create table `sandbox`.`grp5_oulad_dim_student__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Dimension table for students (no surrogate key)
select
    cast(id_student as Int64)               as id_student,
    cast(gender as Nullable(String))        as gender,
    cast(age_band as Nullable(String))      as age_band,
    cast(region as Nullable(String))        as region,
    cast(highest_education as Nullable(String)) as highest_education,
    cast(imd_band as Nullable(String))      as imd_band,
    cast(disability as Nullable(String))    as disability
from `clean`.`grp5_stg_oulad_student_info`
          )
        
        ...
[0m14:53:44.927361 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.36 seconds
[0m14:53:44.951987 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_student: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_student"} */

    select name, type from system.columns where table = 'grp5_oulad_dim_student__dbt_backup'
    
      and database = 'sandbox'
    
    order by position
  ...
[0m14:53:45.349346 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.40 seconds
[0m14:53:45.361182 [debug] [Thread-2  ]: Writing runtime sql for node "model.ex_09_oulad.grp5_oulad_dim_student"
[0m14:53:45.363355 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_student: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_student"} */

  
    
    
    
        
         


        insert into `sandbox`.`grp5_oulad_dim_student__dbt_backup`
        ("id_student", "gender", "age_band", "region", "highest_education", "imd_band", "disability")

-- Dimension table for students (no surrogate key)
select
    cast(id_student as Int64)               as id_student,
    cast(gender as Nullable(String))        as gender,
    cast(age_band as Nullable(String))      as age_band,
    cast(region as Nullable(String))        as region,
    cast(highest_education as Nullable(String)) as highest_education,
    cast(imd_band as Nullable(String))      as imd_band,
    cast(disability as Nullable(String))    as disability
from `clean`.`grp5_stg_oulad_student_info`
  ...
[0m14:53:45.993750 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.63 seconds
[0m14:53:46.015034 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_student: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_student"} */
EXCHANGE TABLES `sandbox`.`grp5_oulad_dim_student__dbt_backup` AND `sandbox`.`grp5_oulad_dim_student` 
  
  ...
[0m14:53:46.387464 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.37 seconds
[0m14:53:46.413297 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_student: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_student"} */

    drop table if exists `sandbox`.`grp5_oulad_dim_student__dbt_backup` 
  ...
[0m14:53:46.784157 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.37 seconds
[0m14:53:46.789528 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4a2ae13-d21d-4ff1-81d8-43ae1699225b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735743a58d00>]}
[0m14:53:46.792024 [info ] [Thread-2  ]: 5 of 7 OK created sql table model `sandbox`.`grp5_oulad_dim_student` ........... [[32mOK[0m in 2.27s]
[0m14:53:46.794996 [debug] [Thread-2  ]: Finished running node model.ex_09_oulad.grp5_oulad_dim_student
[0m14:53:46.796804 [debug] [Thread-2  ]: Began running node model.ex_09_oulad.grp5_stg_oulad_student_assessment
[0m14:53:46.798946 [info ] [Thread-2  ]: 6 of 7 START sql table model `clean`.`grp5_stg_oulad_student_assessment` ....... [RUN]
[0m14:53:46.800568 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ex_09_oulad.grp5_oulad_dim_student, now model.ex_09_oulad.grp5_stg_oulad_student_assessment)
[0m14:53:46.802551 [debug] [Thread-2  ]: Began compiling node model.ex_09_oulad.grp5_stg_oulad_student_assessment
[0m14:53:46.814676 [debug] [Thread-2  ]: Writing injected SQL for node "model.ex_09_oulad.grp5_stg_oulad_student_assessment"
[0m14:53:46.816949 [debug] [Thread-2  ]: Began executing node model.ex_09_oulad.grp5_stg_oulad_student_assessment
[0m14:53:46.834484 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_assessment"} */

            

    
        create table `clean`.`grp5_stg_oulad_student_assessment__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
             

-- Standardize names and types for student assessment
select
  cast(id_assessment  as Nullable(Int64)) as assessment_id,
  cast(id_student     as Nullable(Int64)) as student_id,
  cast(date_submitted as Nullable(Int64)) as date_submitted,
  cast(is_banked      as Nullable(Int64)) as is_banked,
  cast(score          as Nullable(Int64)) as score
from `raw`.`grp5_oulad___student_assessment`
          )
        
        ...
[0m14:53:47.521565 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.68 seconds
[0m14:53:47.535927 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_assessment"} */

    select name, type from system.columns where table = 'grp5_stg_oulad_student_assessment__dbt_backup'
    
      and database = 'clean'
    
    order by position
  ...
[0m14:53:47.877248 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.34 seconds
[0m14:53:47.885765 [debug] [Thread-2  ]: Writing runtime sql for node "model.ex_09_oulad.grp5_stg_oulad_student_assessment"
[0m14:53:47.891388 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_assessment"} */

  
    
    
    
        
         


        insert into `clean`.`grp5_stg_oulad_student_assessment__dbt_backup`
        ("assessment_id", "student_id", "date_submitted", "is_banked", "score") 

-- Standardize names and types for student assessment
select
  cast(id_assessment  as Nullable(Int64)) as assessment_id,
  cast(id_student     as Nullable(Int64)) as student_id,
  cast(date_submitted as Nullable(Int64)) as date_submitted,
  cast(is_banked      as Nullable(Int64)) as is_banked,
  cast(score          as Nullable(Int64)) as score
from `raw`.`grp5_oulad___student_assessment`
  ...
[0m14:53:48.303420 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.41 seconds
[0m14:53:48.307620 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_assessment"} */
EXCHANGE TABLES `clean`.`grp5_stg_oulad_student_assessment__dbt_backup` AND `clean`.`grp5_stg_oulad_student_assessment` 
  
  ...
[0m14:53:48.598560 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_09_oulad.grp5_dq_oulad_studenVle_summary"
[0m14:53:48.602669 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_dq_oulad_studenVle_summary: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_dq_oulad_studenVle_summary"} */


  create view `mart`.`grp5_dq_oulad_studenVle_summary` 
  
    
    
  as (
    

with src as (
    select * from `raw`.`studentVle`
),
cln as (
    select * from `clean`.`grp5_stg_oulad_studentVle`
),

counts as (
    select
        (select count() from src) as row_count_raw,
        (select count() from cln) as row_count_clean
),

nulls as (
    select
        round(100.0 * countIf(id_student is null) / nullIf(count(),0),2) as pct_null_id_student,
        round(100.0 * countIf(sum_click is null) / nullIf(count(),0),2) as pct_null_sum_click
    from cln
),

domains as (
    select
        countIf(
            NOT (
                (code_module='AAA' AND code_presentation='2013J') OR
                (code_module='AAA' AND code_presentation='2014J') OR
                (code_module='BBB' AND code_presentation='2013J') OR
                (code_module='BBB' AND code_presentation='2014J') OR
                (code_module='BBB' AND code_presentation='2013B') OR
                (code_module='BBB' AND code_presentation='2014B') OR
                (code_module='CCC' AND code_presentation='2014J') OR
                (code_module='CCC' AND code_presentation='2014B') OR
                (code_module='DDD' AND code_presentation='2013J') OR
                (code_module='DDD' AND code_presentation='2014J') OR
                (code_module='DDD' AND code_presentation='2013B') OR
                (code_module='DDD' AND code_presentation='2014B') OR
                (code_module='EEE' AND code_presentation='2013J') OR
                (code_module='EEE' AND code_presentation='2014J') OR
                (code_module='EEE' AND code_presentation='2014B') OR
                (code_module='FFF' AND code_presentation='2013J') OR
                (code_module='FFF' AND code_presentation='2014J') OR
                (code_module='FFF' AND code_presentation='2013B') OR
                (code_module='FFF' AND code_presentation='2014B') OR
                (code_module='GGG' AND code_presentation='2013J') OR
                (code_module='GGG' AND code_presentation='2014J') OR
                (code_module='GGG' AND code_presentation='2014B')
            )
        ) as invalid_module_presentation
    from cln
),

joined as (
    select
        counts.row_count_raw,
        counts.row_count_clean,
        (counts.row_count_raw - counts.row_count_clean) as dropped_rows,
        nulls.pct_null_id_student,
        nulls.pct_null_sum_click,
        domains.invalid_module_presentation
    from counts
    cross join nulls
    cross join domains
)

select * from joined
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m14:53:48.643930 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.33 seconds
[0m14:53:48.657166 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_assessment"} */

    drop table if exists `clean`.`grp5_stg_oulad_student_assessment__dbt_backup` 
  ...
[0m14:53:48.955174 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_module_presentation: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_module_presentation"} */

            

    
        create table `sandbox`.`grp5_oulad_dim_module_presentation__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Dimension table for module + presentation (simple, with Nullable types)
select
    cast(code_module as Nullable(String))                           as code_module,
    cast(code_presentation as Nullable(String))                     as code_presentation,
    cast(module_presentation_length as Nullable(Int32))             as length_days
from `clean`.`grp5_stg_oulad_courses`
          )
        
        ...
[0m14:53:48.959549 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_courses: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_courses"} */

            

    
        create table `mart`.`grp5_oulad_dim_courses__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

select
    concat(cast(code_module as Nullable(String)), cast(code_presentation as Nullable(String))) 
        as id_course,
    cast(code_module as Nullable(String))                           as code_module,
    cast(code_presentation as Nullable(String))                     as code_presentation,
    cast(module_presentation_length as Nullable(Int32))             as module_presentation_length
from `clean`.`grp5_stg_oulad_courses`
          )
        
        ...
[0m14:53:48.963717 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.36 seconds
[0m14:53:48.973027 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4a2ae13-d21d-4ff1-81d8-43ae1699225b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73574430aa90>]}
[0m14:53:48.975769 [info ] [Thread-1  ]: 1 of 7 OK created sql view model `mart`.`grp5_dq_oulad_studenVle_summary` ...... [[32mOK[0m in 5.55s]
[0m14:53:48.978268 [debug] [Thread-1  ]: Finished running node model.ex_09_oulad.grp5_dq_oulad_studenVle_summary
[0m14:53:48.980057 [debug] [Thread-1  ]: Began running node model.ex_09_oulad.grp5_stg_oulad_student_info
[0m14:53:48.982244 [info ] [Thread-1  ]: 7 of 7 START sql table model `clean`.`grp5_stg_oulad_student_info` ............. [RUN]
[0m14:53:48.984569 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ex_09_oulad.grp5_dq_oulad_studenVle_summary, now model.ex_09_oulad.grp5_stg_oulad_student_info)
[0m14:53:48.986182 [debug] [Thread-1  ]: Began compiling node model.ex_09_oulad.grp5_stg_oulad_student_info
[0m14:53:49.002723 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_09_oulad.grp5_stg_oulad_student_info"
[0m14:53:49.006223 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.35 seconds
[0m14:53:49.014136 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4a2ae13-d21d-4ff1-81d8-43ae1699225b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7357441136d0>]}
[0m14:53:49.018004 [info ] [Thread-2  ]: 6 of 7 OK created sql table model `clean`.`grp5_stg_oulad_student_assessment` .. [[32mOK[0m in 2.21s]
[0m14:53:49.020111 [debug] [Thread-1  ]: Began executing node model.ex_09_oulad.grp5_stg_oulad_student_info
[0m14:53:49.022718 [debug] [Thread-2  ]: Finished running node model.ex_09_oulad.grp5_stg_oulad_student_assessment
[0m14:53:49.044475 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_info: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_info"} */

            

    
        create table `clean`.`grp5_stg_oulad_student_info__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            
select
  cast(code_module            as String)     as code_module,
  cast(code_presentation      as String)     as code_presentation,
  cast(id_student             as Int64)      as id_student,
  cast(
    case
      when gender IN ('M', 'F') then gender
      else 'Unknown'
    end as String) as gender,
  cast(region                 as String)     as region,
  cast(highest_education      as String)     as highest_education,
  cast(
    case
        when imd_band = '?' then null
        when imd_band not like '%\%%' then concat(imd_band, '%')
        else imd_band
    end as Nullable(String)) as imd_band,
  cast(age_band               as String)     as age_band,
  cast(num_of_prev_attempts   as Int64)      as num_of_prev_attempts,
  cast(studied_credits        as Int64)      as studied_credits,
  cast(disability             as String)     as disability,
  cast(final_result           as String)     as final_result
from `raw`.`grp5_oulad___student_info`
          )
        
        ...
[0m14:53:49.356054 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.39 seconds
[0m14:53:49.364592 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.40 seconds
[0m14:53:49.368553 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_module_presentation: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_module_presentation"} */

    select name, type from system.columns where table = 'grp5_oulad_dim_module_presentation__dbt_backup'
    
      and database = 'sandbox'
    
    order by position
  ...
[0m14:53:49.378733 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_courses: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_courses"} */

    select name, type from system.columns where table = 'grp5_oulad_dim_courses__dbt_backup'
    
      and database = 'mart'
    
    order by position
  ...
[0m14:53:49.404025 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.36 seconds
[0m14:53:49.413427 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_info: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_info"} */

    select name, type from system.columns where table = 'grp5_stg_oulad_student_info__dbt_backup'
    
      and database = 'clean'
    
    order by position
  ...
[0m14:53:49.726139 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.35 seconds
[0m14:53:49.729081 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.35 seconds
[0m14:53:49.734673 [debug] [Thread-4  ]: Writing runtime sql for node "model.ex_09_oulad.grp5_oulad_dim_module_presentation"
[0m14:53:49.739186 [debug] [Thread-3  ]: Writing runtime sql for node "model.ex_09_oulad.grp5_oulad_dim_courses"
[0m14:53:49.742205 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_module_presentation: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_module_presentation"} */

  
    
    
    
        
         


        insert into `sandbox`.`grp5_oulad_dim_module_presentation__dbt_backup`
        ("code_module", "code_presentation", "length_days")

-- Dimension table for module + presentation (simple, with Nullable types)
select
    cast(code_module as Nullable(String))                           as code_module,
    cast(code_presentation as Nullable(String))                     as code_presentation,
    cast(module_presentation_length as Nullable(Int32))             as length_days
from `clean`.`grp5_stg_oulad_courses`
  ...
[0m14:53:49.743946 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_courses: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_courses"} */

  
    
    
    
        
         


        insert into `mart`.`grp5_oulad_dim_courses__dbt_backup`
        ("id_course", "code_module", "code_presentation", "module_presentation_length")

select
    concat(cast(code_module as Nullable(String)), cast(code_presentation as Nullable(String))) 
        as id_course,
    cast(code_module as Nullable(String))                           as code_module,
    cast(code_presentation as Nullable(String))                     as code_presentation,
    cast(module_presentation_length as Nullable(Int32))             as module_presentation_length
from `clean`.`grp5_stg_oulad_courses`
  ...
[0m14:53:49.759300 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.34 seconds
[0m14:53:49.763595 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_09_oulad.grp5_stg_oulad_student_info"
[0m14:53:49.765514 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_info: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_info"} */

  
    
    
    
        
         


        insert into `clean`.`grp5_stg_oulad_student_info__dbt_backup`
        ("code_module", "code_presentation", "id_student", "gender", "region", "highest_education", "imd_band", "age_band", "num_of_prev_attempts", "studied_credits", "disability", "final_result")
select
  cast(code_module            as String)     as code_module,
  cast(code_presentation      as String)     as code_presentation,
  cast(id_student             as Int64)      as id_student,
  cast(
    case
      when gender IN ('M', 'F') then gender
      else 'Unknown'
    end as String) as gender,
  cast(region                 as String)     as region,
  cast(highest_education      as String)     as highest_education,
  cast(
    case
        when imd_band = '?' then null
        when imd_band not like '%\%%' then concat(imd_band, '%')
        else imd_band
    end as Nullable(String)) as imd_band,
  cast(age_band               as String)     as age_band,
  cast(num_of_prev_attempts   as Int64)      as num_of_prev_attempts,
  cast(studied_credits        as Int64)      as studied_credits,
  cast(disability             as String)     as disability,
  cast(final_result           as String)     as final_result
from `raw`.`grp5_oulad___student_info`
  ...
[0m14:53:50.062082 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.32 seconds
[0m14:53:50.064566 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.32 seconds
[0m14:53:50.068038 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_module_presentation: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_module_presentation"} */
EXCHANGE TABLES `sandbox`.`grp5_oulad_dim_module_presentation__dbt_backup` AND `sandbox`.`grp5_oulad_dim_module_presentation` 
  
  ...
[0m14:53:50.072463 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_courses: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_courses"} */
EXCHANGE TABLES `mart`.`grp5_oulad_dim_courses__dbt_backup` AND `mart`.`grp5_oulad_dim_courses` 
  
  ...
[0m14:53:50.270514 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.50 seconds
[0m14:53:50.274787 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_info: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_info"} */
EXCHANGE TABLES `clean`.`grp5_stg_oulad_student_info__dbt_backup` AND `clean`.`grp5_stg_oulad_student_info` 
  
  ...
[0m14:53:50.599063 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.52 seconds
[0m14:53:50.601254 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.53 seconds
[0m14:53:50.612548 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_module_presentation: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_module_presentation"} */

    drop table if exists `sandbox`.`grp5_oulad_dim_module_presentation__dbt_backup` 
  ...
[0m14:53:50.625124 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_courses: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_courses"} */

    drop table if exists `mart`.`grp5_oulad_dim_courses__dbt_backup` 
  ...
[0m14:53:50.633170 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.36 seconds
[0m14:53:50.645482 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_info: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_info"} */

    drop table if exists `clean`.`grp5_stg_oulad_student_info__dbt_backup` 
  ...
[0m14:53:51.031099 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.40 seconds
[0m14:53:51.034059 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.41 seconds
[0m14:53:51.038451 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4a2ae13-d21d-4ff1-81d8-43ae1699225b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735742727b50>]}
[0m14:53:51.040902 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.39 seconds
[0m14:53:51.045660 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4a2ae13-d21d-4ff1-81d8-43ae1699225b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73574220b490>]}
[0m14:53:51.048041 [info ] [Thread-3  ]: 3 of 7 OK created sql table model `mart`.`grp5_oulad_dim_courses` .............. [[32mOK[0m in 7.60s]
[0m14:53:51.052996 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4a2ae13-d21d-4ff1-81d8-43ae1699225b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7357424371c0>]}
[0m14:53:51.055519 [info ] [Thread-4  ]: 4 of 7 OK created sql table model `sandbox`.`grp5_oulad_dim_module_presentation`  [[32mOK[0m in 7.60s]
[0m14:53:51.060246 [debug] [Thread-3  ]: Finished running node model.ex_09_oulad.grp5_oulad_dim_courses
[0m14:53:51.064394 [info ] [Thread-1  ]: 7 of 7 OK created sql table model `clean`.`grp5_stg_oulad_student_info` ........ [[32mOK[0m in 2.07s]
[0m14:53:51.068818 [debug] [Thread-4  ]: Finished running node model.ex_09_oulad.grp5_oulad_dim_module_presentation
[0m14:53:51.073910 [debug] [Thread-1  ]: Finished running node model.ex_09_oulad.grp5_stg_oulad_student_info
[0m14:53:51.082217 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:53:51.083472 [debug] [MainThread]: Connection 'list__sandbox' was left open.
[0m14:53:51.085463 [debug] [MainThread]: On list__sandbox: Close
[0m14:53:51.086859 [debug] [MainThread]: Connection 'list__clean' was left open.
[0m14:53:51.088071 [debug] [MainThread]: On list__clean: Close
[0m14:53:51.090874 [debug] [MainThread]: Connection 'list_' was left open.
[0m14:53:51.092150 [debug] [MainThread]: On list_: Close
[0m14:53:51.093115 [debug] [MainThread]: Connection 'model.ex_09_oulad.grp5_stg_oulad_student_assessment' was left open.
[0m14:53:51.094076 [debug] [MainThread]: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: Close
[0m14:53:51.094837 [debug] [MainThread]: Connection 'model.ex_09_oulad.grp5_stg_oulad_student_info' was left open.
[0m14:53:51.095929 [debug] [MainThread]: On model.ex_09_oulad.grp5_stg_oulad_student_info: Close
[0m14:53:51.097068 [debug] [MainThread]: Connection 'model.ex_09_oulad.grp5_oulad_dim_courses' was left open.
[0m14:53:51.098239 [debug] [MainThread]: On model.ex_09_oulad.grp5_oulad_dim_courses: Close
[0m14:53:51.099023 [debug] [MainThread]: Connection 'model.ex_09_oulad.grp5_oulad_dim_module_presentation' was left open.
[0m14:53:51.099720 [debug] [MainThread]: On model.ex_09_oulad.grp5_oulad_dim_module_presentation: Close
[0m14:53:51.102784 [info ] [MainThread]: 
[0m14:53:51.105453 [info ] [MainThread]: Finished running 2 view models, 5 table models in 0 hours 0 minutes and 21.04 seconds (21.04s).
[0m14:53:51.111925 [debug] [MainThread]: Command end result
[0m14:53:51.202541 [info ] [MainThread]: 
[0m14:53:51.204226 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:53:51.205658 [info ] [MainThread]: 
[0m14:53:51.207711 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m14:53:51.212111 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 23.743734, "process_in_blocks": "528", "process_kernel_time": 2.503311, "process_mem_max_rss": "117928", "process_out_blocks": "10856", "process_user_time": 10.353754}
[0m14:53:51.214621 [debug] [MainThread]: Command `dbt build` succeeded at 14:53:51.213755 after 23.75 seconds
[0m14:53:51.216619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7357477bf310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7357442ab1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7357422c9ca0>]}
[0m14:53:51.217735 [debug] [MainThread]: Flushing usage events
[0m15:23:30.262637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e5e31ed310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e5dfe50b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e5dfe50a00>]}


============================== 15:23:30.362283 | 357347be-640e-4fbe-907b-35706428a898 ==============================
[0m15:23:30.362283 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:23:30.365976 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'no_print': 'None', 'log_path': '/workdir/transforms/09_oulad/logs', 'cache_selected_only': 'False', 'log_format': 'default', 'profiles_dir': '.', 'debug': 'False', 'log_cache_events': 'False', 'target_path': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'empty': 'False', 'introspect': 'True', 'printer_width': '80', 'write_json': 'True', 'warn_error': 'None', 'quiet': 'False', 'invocation_command': 'dbt build --profiles-dir . --target remote'}
[0m15:23:31.494712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '357347be-640e-4fbe-907b-35706428a898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e5e278eca0>]}
[0m15:23:31.818838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '357347be-640e-4fbe-907b-35706428a898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e5dff60e50>]}
[0m15:23:31.821956 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m15:23:32.305766 [debug] [MainThread]: checksum: 265ce5244aff672775eaff93c261d21692ed3f5650f4d9e918c76acdb0e9479a, vars: {}, profile: , target: remote, version: 1.8.9
[0m15:23:33.221652 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 2 files changed.
[0m15:23:33.223709 [debug] [MainThread]: Partial parsing: added file: ex_09_oulad://models/mart/dq/grp5_dq_oulad_student_registration_anomalies.sql
[0m15:23:33.225730 [debug] [MainThread]: Partial parsing: added file: ex_09_oulad://models/mart/dq/grp5_dq_oulad_student_registration_summary.sql
[0m15:23:33.230599 [debug] [MainThread]: Partial parsing: updated file: ex_09_oulad://models/sources.yml
[0m15:23:33.232549 [debug] [MainThread]: Partial parsing: updated file: ex_09_oulad://models/mart/dq/schema.yml
[0m15:23:36.859171 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ex_09_oulad.grp5_dq_oulad_student_registration_summary' (models/mart/dq/grp5_dq_oulad_student_registration_summary.sql) depends on a node named 'grp5_stg_oulad_student_registration' which was not found
[0m15:23:36.869835 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 7.306723, "process_in_blocks": "1168", "process_kernel_time": 4.567163, "process_mem_max_rss": "103308", "process_out_blocks": "6608", "process_user_time": 13.564588}
[0m15:23:36.881683 [debug] [MainThread]: Command `dbt build` failed at 15:23:36.879835 after 7.32 seconds
[0m15:23:36.884998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e5e31ed310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e5dfccdc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e5e1ecfb20>]}
[0m15:23:36.887674 [debug] [MainThread]: Flushing usage events
[0m15:27:32.558560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71cee7f05e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71cee4b58b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71cee4b58a30>]}


============================== 15:27:32.582720 | 35526b10-95f5-4f50-8034-fa536e7df82f ==============================
[0m15:27:32.582720 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:27:32.586022 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'write_json': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt build --profiles-dir . --target remote', 'partial_parse': 'True', 'profiles_dir': '.', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': '/workdir/transforms/09_oulad/logs', 'no_print': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'debug': 'False', 'warn_error': 'None', 'introspect': 'True', 'printer_width': '80', 'static_parser': 'True', 'cache_selected_only': 'False'}
[0m15:27:33.735160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '35526b10-95f5-4f50-8034-fa536e7df82f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71cee7391910>]}
[0m15:27:34.227621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '35526b10-95f5-4f50-8034-fa536e7df82f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71cee4b483d0>]}
[0m15:27:34.230939 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m15:27:34.655177 [debug] [MainThread]: checksum: 265ce5244aff672775eaff93c261d21692ed3f5650f4d9e918c76acdb0e9479a, vars: {}, profile: , target: remote, version: 1.8.9
[0m15:27:35.280319 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 2 files changed.
[0m15:27:35.282483 [debug] [MainThread]: Partial parsing: added file: ex_09_oulad://models/mart/dq/grp5_dq_oulad_student_registration_summary.sql
[0m15:27:35.284146 [debug] [MainThread]: Partial parsing: added file: ex_09_oulad://models/mart/dq/grp5_dq_oulad_student_registration_anomalies.sql
[0m15:27:35.288168 [debug] [MainThread]: Partial parsing: updated file: ex_09_oulad://models/sources.yml
[0m15:27:35.290326 [debug] [MainThread]: Partial parsing: updated file: ex_09_oulad://models/mart/dq/schema.yml
[0m15:27:37.381718 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ex_09_oulad.grp5_dq_oulad_student_registration_summary' (models/mart/dq/grp5_dq_oulad_student_registration_summary.sql) depends on a node named 'grp5_stg_oulad_student_registration' which was not found
[0m15:27:37.386237 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 4.995791, "process_in_blocks": "1312", "process_kernel_time": 2.531815, "process_mem_max_rss": "103120", "process_out_blocks": "6608", "process_user_time": 9.739473}
[0m15:27:37.388294 [debug] [MainThread]: Command `dbt build` failed at 15:27:37.387776 after 5.00 seconds
[0m15:27:37.391406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71cee7f05e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71cee2f29a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71cee2f298b0>]}
[0m15:27:37.394023 [debug] [MainThread]: Flushing usage events
[0m15:32:30.337294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783dada0d310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783daa656af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783daa6569a0>]}


============================== 15:32:30.356145 | 2bc8a685-0e32-4695-bc9d-4e67441515b5 ==============================
[0m15:32:30.356145 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:32:30.359026 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'no_print': 'None', 'static_parser': 'True', 'log_path': '/workdir/transforms/09_oulad/logs', 'introspect': 'True', 'target_path': 'None', 'printer_width': '80', 'invocation_command': 'dbt build --profiles-dir . --target remote', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'partial_parse': 'True', 'write_json': 'True', 'log_format': 'default', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'empty': 'False'}
[0m15:32:30.908156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2bc8a685-0e32-4695-bc9d-4e67441515b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783daa5644c0>]}
[0m15:32:31.087277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2bc8a685-0e32-4695-bc9d-4e67441515b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783daa750ca0>]}
[0m15:32:31.091619 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m15:32:31.915589 [debug] [MainThread]: checksum: 265ce5244aff672775eaff93c261d21692ed3f5650f4d9e918c76acdb0e9479a, vars: {}, profile: , target: remote, version: 1.8.9
[0m15:32:33.167228 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 2 files changed.
[0m15:32:33.168950 [debug] [MainThread]: Partial parsing: added file: ex_09_oulad://models/mart/dq/grp5_dq_oulad_student_registration_summary.sql
[0m15:32:33.170460 [debug] [MainThread]: Partial parsing: added file: ex_09_oulad://models/mart/dq/grp5_dq_oulad_student_registration_anomalies.sql
[0m15:32:33.172220 [debug] [MainThread]: Partial parsing: updated file: ex_09_oulad://models/mart/dq/schema.yml
[0m15:32:33.176224 [debug] [MainThread]: Partial parsing: updated file: ex_09_oulad://models/sources.yml
[0m15:32:34.987752 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ex_09_oulad.grp5_dq_oulad_student_registration_summary' (models/mart/dq/grp5_dq_oulad_student_registration_summary.sql) depends on a node named 'grp5_stg_oulad_student_registration' which was not found
[0m15:32:34.992690 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 4.837802, "process_in_blocks": "1392", "process_kernel_time": 3.11028, "process_mem_max_rss": "103340", "process_out_blocks": "6608", "process_user_time": 11.154508}
[0m15:32:34.995705 [debug] [MainThread]: Command `dbt build` failed at 15:32:34.994880 after 4.84 seconds
[0m15:32:34.998307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783dada0d310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783da9dafa60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783da9e415e0>]}
[0m15:32:35.005102 [debug] [MainThread]: Flushing usage events
[0m15:35:52.632867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2a17b15310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2a1478ba90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2a1478b940>]}


============================== 15:35:52.657408 | 3eed95ab-cb9a-4ff2-a7b1-8ccec9bb8c6d ==============================
[0m15:35:52.657408 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:35:52.659755 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'warn_error': 'None', 'printer_width': '80', 'quiet': 'False', 'invocation_command': 'dbt build --profiles-dir . --target remote', 'profiles_dir': '.', 'empty': 'False', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'fail_fast': 'False', 'use_colors': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'static_parser': 'True', 'log_format': 'default', 'version_check': 'True', 'log_path': '/workdir/transforms/09_oulad/logs', 'write_json': 'True'}
[0m15:35:53.165252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3eed95ab-cb9a-4ff2-a7b1-8ccec9bb8c6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2a170b2fd0>]}
[0m15:35:53.325427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3eed95ab-cb9a-4ff2-a7b1-8ccec9bb8c6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2a15243430>]}
[0m15:35:53.328758 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m15:35:53.582130 [debug] [MainThread]: checksum: 265ce5244aff672775eaff93c261d21692ed3f5650f4d9e918c76acdb0e9479a, vars: {}, profile: , target: remote, version: 1.8.9
[0m15:35:53.881431 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:35:53.882854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3eed95ab-cb9a-4ff2-a7b1-8ccec9bb8c6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2a15aa1760>]}
[0m15:35:57.809725 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'grp5_dq_oulad_studentVle_summary' in the 'models' section of file 'models/mart/dq/schema.yml'
[0m15:35:57.874188 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ex_09_oulad.grp5_dq_oulad_student_registration_summary' (models/mart/dq/grp5_dq_oulad_student_registration_summary.sql) depends on a node named 'grp5_stg_oulad_student_registration' which was not found
[0m15:35:57.877525 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 5.3968487, "process_in_blocks": "1944", "process_kernel_time": 1.884318, "process_mem_max_rss": "101236", "process_out_blocks": "6616", "process_user_time": 9.724155}
[0m15:35:57.879337 [debug] [MainThread]: Command `dbt build` failed at 15:35:57.878728 after 5.40 seconds
[0m15:35:57.881335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2a17b15310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2a141a5310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2a12cdef40>]}
[0m15:35:57.884118 [debug] [MainThread]: Flushing usage events
[0m15:39:19.806157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734214312e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734210f75b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734210f75a30>]}


============================== 15:39:19.822561 | 49ee5824-c2c7-4cba-80cc-a39a880fb754 ==============================
[0m15:39:19.822561 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:39:19.824261 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'use_colors': 'True', 'quiet': 'False', 'write_json': 'True', 'debug': 'False', 'log_cache_events': 'False', 'log_path': '/workdir/transforms/09_oulad/logs', 'version_check': 'True', 'introspect': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt build --profiles-dir . --target remote', 'empty': 'False', 'no_print': 'None', 'fail_fast': 'False', 'printer_width': '80', 'log_format': 'default', 'cache_selected_only': 'False', 'target_path': 'None', 'indirect_selection': 'eager', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'profiles_dir': '.'}
[0m15:39:20.321370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49ee5824-c2c7-4cba-80cc-a39a880fb754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734210faf580>]}
[0m15:39:20.470678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49ee5824-c2c7-4cba-80cc-a39a880fb754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7342145210d0>]}
[0m15:39:20.473227 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m15:39:20.743899 [debug] [MainThread]: checksum: 265ce5244aff672775eaff93c261d21692ed3f5650f4d9e918c76acdb0e9479a, vars: {}, profile: , target: remote, version: 1.8.9
[0m15:39:21.241222 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:39:21.242711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '49ee5824-c2c7-4cba-80cc-a39a880fb754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73421223db80>]}
[0m15:39:25.234577 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'grp5_dq_oulad_studentVle_summary' in the 'models' section of file 'models/mart/dq/schema.yml'
[0m15:39:25.665617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49ee5824-c2c7-4cba-80cc-a39a880fb754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73420f375130>]}
[0m15:39:26.134358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49ee5824-c2c7-4cba-80cc-a39a880fb754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73420f400700>]}
[0m15:39:26.137273 [info ] [MainThread]: Found 9 models, 8 sources, 471 macros
[0m15:39:26.147269 [info ] [MainThread]: 
[0m15:39:26.150796 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m15:39:26.183466 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m15:39:26.186474 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m15:39:26.196030 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m15:39:26.261958 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:39:26.264116 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:39:26.265821 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:39:31.778885 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m15:39:32.005112 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m15:39:32.007907 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m15:39:32.173600 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.38 seconds
[0m15:39:32.344474 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.33 seconds
[0m15:39:32.378785 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.37 seconds
[0m15:39:32.387124 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__sandbox)
[0m15:39:32.390376 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__mart)
[0m15:39:32.399000 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list__clean'
[0m15:39:32.413044 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__sandbox: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list__sandbox"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'sandbox'
      

  ...
[0m15:39:32.421455 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list__mart"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'mart'
      

  ...
[0m15:39:32.430400 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:39:32.753071 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.32 seconds
[0m15:39:32.792065 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.36 seconds
[0m15:39:36.644788 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list__clean"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'clean'
      

  ...
[0m15:39:37.020110 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.37 seconds
[0m15:39:37.256152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49ee5824-c2c7-4cba-80cc-a39a880fb754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73420eaea490>]}
[0m15:39:37.258018 [info ] [MainThread]: Concurrency: 4 threads (target='remote')
[0m15:39:37.259197 [info ] [MainThread]: 
[0m15:39:37.312301 [debug] [Thread-1  ]: Began running node model.ex_09_oulad.grp5_dq_oulad_studenVle_summary
[0m15:39:37.314616 [info ] [Thread-1  ]: 1 of 9 START sql view model `mart`.`grp5_dq_oulad_studenVle_summary` ........... [RUN]
[0m15:39:37.317728 [debug] [Thread-2  ]: Began running node model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies
[0m15:39:37.320561 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.ex_09_oulad.grp5_dq_oulad_studenVle_summary'
[0m15:39:37.323589 [debug] [Thread-3  ]: Began running node model.ex_09_oulad.grp5_dq_oulad_student_registration_anomalies
[0m15:39:37.325630 [debug] [Thread-4  ]: Began running node model.ex_09_oulad.grp5_dq_oulad_student_registration_summary
[0m15:39:37.329086 [info ] [Thread-2  ]: 2 of 9 START sql view model `mart`.`grp5_dq_oulad_studentVle_anomalies` ........ [RUN]
[0m15:39:37.332837 [debug] [Thread-1  ]: Began compiling node model.ex_09_oulad.grp5_dq_oulad_studenVle_summary
[0m15:39:37.336716 [info ] [Thread-3  ]: 3 of 9 START sql view model `mart`.`grp5_dq_oulad_student_registration_anomalies`  [RUN]
[0m15:39:37.339873 [info ] [Thread-4  ]: 4 of 9 START sql view model `mart`.`grp5_dq_oulad_student_registration_summary`  [RUN]
[0m15:39:37.345645 [debug] [Thread-2  ]: Acquiring new clickhouse connection 'model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies'
[0m15:39:37.364832 [debug] [Thread-3  ]: Acquiring new clickhouse connection 'model.ex_09_oulad.grp5_dq_oulad_student_registration_anomalies'
[0m15:39:37.374710 [debug] [Thread-4  ]: Acquiring new clickhouse connection 'model.ex_09_oulad.grp5_dq_oulad_student_registration_summary'
[0m15:39:37.397065 [debug] [Thread-2  ]: Began compiling node model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies
[0m15:39:37.410148 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_09_oulad.grp5_dq_oulad_studenVle_summary"
[0m15:39:37.413069 [debug] [Thread-3  ]: Began compiling node model.ex_09_oulad.grp5_dq_oulad_student_registration_anomalies
[0m15:39:37.414814 [debug] [Thread-4  ]: Began compiling node model.ex_09_oulad.grp5_dq_oulad_student_registration_summary
[0m15:39:37.430837 [debug] [Thread-2  ]: Writing injected SQL for node "model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies"
[0m15:39:37.444828 [debug] [Thread-3  ]: Writing injected SQL for node "model.ex_09_oulad.grp5_dq_oulad_student_registration_anomalies"
[0m15:39:37.458378 [debug] [Thread-1  ]: Began executing node model.ex_09_oulad.grp5_dq_oulad_studenVle_summary
[0m15:39:37.462317 [debug] [Thread-4  ]: Writing injected SQL for node "model.ex_09_oulad.grp5_dq_oulad_student_registration_summary"
[0m15:39:37.483383 [debug] [Thread-3  ]: Began executing node model.ex_09_oulad.grp5_dq_oulad_student_registration_anomalies
[0m15:39:37.485910 [debug] [Thread-2  ]: Began executing node model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies
[0m15:39:37.500433 [debug] [Thread-4  ]: Began executing node model.ex_09_oulad.grp5_dq_oulad_student_registration_summary
[0m15:39:37.898441 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m15:39:37.900952 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m15:39:37.903582 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m15:39:37.906098 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m15:39:39.746117 [debug] [Thread-2  ]: Writing runtime sql for node "model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies"
[0m15:39:39.755411 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies"} */


  create view `mart`.`grp5_dq_oulad_studentVle_anomalies__dbt_tmp` 
  
    
    
  as (
    

with cln as (
    select * from `clean`.`grp5_stg_oulad_studentVle`
),

violations as (
    select
        code_module,
        code_presentation,
        id_student,
        id_site,
        date,
        sum_click,

        multiIf(
            id_student is null,                 'null_id_student',
            sum_click is null,                  'null_sum_click',
            NOT (
                (code_module='AAA' AND code_presentation='2013J') OR
                (code_module='AAA' AND code_presentation='2014J') OR
                (code_module='BBB' AND code_presentation='2013J') OR
                (code_module='BBB' AND code_presentation='2014J') OR
                (code_module='BBB' AND code_presentation='2013B') OR
                (code_module='BBB' AND code_presentation='2014B') OR
                (code_module='CCC' AND code_presentation='2014J') OR
                (code_module='CCC' AND code_presentation='2014B') OR
                (code_module='DDD' AND code_presentation='2013J') OR
                (code_module='DDD' AND code_presentation='2014J') OR
                (code_module='DDD' AND code_presentation='2013B') OR
                (code_module='DDD' AND code_presentation='2014B') OR
                (code_module='EEE' AND code_presentation='2013J') OR
                (code_module='EEE' AND code_presentation='2014J') OR
                (code_module='EEE' AND code_presentation='2014B') OR
                (code_module='FFF' AND code_presentation='2013J') OR
                (code_module='FFF' AND code_presentation='2014J') OR
                (code_module='FFF' AND code_presentation='2013B') OR
                (code_module='FFF' AND code_presentation='2014B') OR
                (code_module='GGG' AND code_presentation='2013J') OR
                (code_module='GGG' AND code_presentation='2014J') OR
                (code_module='GGG' AND code_presentation='2014B')
            ), 'invalid_module_presentation',
            'ok'
        ) as dq_issue
    from cln
)

select *
from violations
where dq_issue != 'ok'
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m15:39:39.760459 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_09_oulad.grp5_dq_oulad_studenVle_summary"
[0m15:39:39.770198 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_dq_oulad_studenVle_summary: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_dq_oulad_studenVle_summary"} */


  create view `mart`.`grp5_dq_oulad_studenVle_summary__dbt_tmp` 
  
    
    
  as (
    

with src as (
    select * from `raw`.`studentVle`
),
cln as (
    select * from `clean`.`grp5_stg_oulad_studentVle`
),

counts as (
    select
        (select count() from src) as row_count_raw,
        (select count() from cln) as row_count_clean
),

nulls as (
    select
        round(100.0 * countIf(id_student is null) / nullIf(count(),0),2) as pct_null_id_student,
        round(100.0 * countIf(sum_click is null) / nullIf(count(),0),2) as pct_null_sum_click
    from cln
),

domains as (
    select
        countIf(
            NOT (
                (code_module='AAA' AND code_presentation='2013J') OR
                (code_module='AAA' AND code_presentation='2014J') OR
                (code_module='BBB' AND code_presentation='2013J') OR
                (code_module='BBB' AND code_presentation='2014J') OR
                (code_module='BBB' AND code_presentation='2013B') OR
                (code_module='BBB' AND code_presentation='2014B') OR
                (code_module='CCC' AND code_presentation='2014J') OR
                (code_module='CCC' AND code_presentation='2014B') OR
                (code_module='DDD' AND code_presentation='2013J') OR
                (code_module='DDD' AND code_presentation='2014J') OR
                (code_module='DDD' AND code_presentation='2013B') OR
                (code_module='DDD' AND code_presentation='2014B') OR
                (code_module='EEE' AND code_presentation='2013J') OR
                (code_module='EEE' AND code_presentation='2014J') OR
                (code_module='EEE' AND code_presentation='2014B') OR
                (code_module='FFF' AND code_presentation='2013J') OR
                (code_module='FFF' AND code_presentation='2014J') OR
                (code_module='FFF' AND code_presentation='2013B') OR
                (code_module='FFF' AND code_presentation='2014B') OR
                (code_module='GGG' AND code_presentation='2013J') OR
                (code_module='GGG' AND code_presentation='2014J') OR
                (code_module='GGG' AND code_presentation='2014B')
            )
        ) as invalid_module_presentation
    from cln
),

joined as (
    select
        counts.row_count_raw,
        counts.row_count_clean,
        (counts.row_count_raw - counts.row_count_clean) as dropped_rows,
        nulls.pct_null_id_student,
        nulls.pct_null_sum_click,
        domains.invalid_module_presentation
    from counts
    cross join nulls
    cross join domains
)

select * from joined
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m15:39:39.785341 [debug] [Thread-4  ]: Writing runtime sql for node "model.ex_09_oulad.grp5_dq_oulad_student_registration_summary"
[0m15:39:39.789274 [debug] [Thread-3  ]: Writing runtime sql for node "model.ex_09_oulad.grp5_dq_oulad_student_registration_anomalies"
[0m15:39:39.793034 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_dq_oulad_student_registration_summary: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_dq_oulad_student_registration_summary"} */


  create view `mart`.`grp5_dq_oulad_student_registration_summary__dbt_tmp` 
  
    
    
  as (
    

-- Inputs:
--   raw table:   raw.grp5_oulad___student_registration
--   clean table: clean.grp5_stg_oulad_student_registration

with src as (
    select *
    from `raw`.`grp5_oulad___student_registration`
),

cln as (
    select *
    from `clean`.`grp5_stg_oulad_student_registration`
),

counts as (
    select
        (select count() from src) as row_count_raw,
        (select count() from cln) as row_count_clean
),

nulls as (
    select
        round(100.0 * countIf(code_module is null) / nullif(count(),0), 2) as pct_null_code_module,
        round(100.0 * countIf(code_presentation is null) / nullif(count(),0), 2) as pct_null_code_presentation,
        round(100.0 * countIf(id_student is null) / nullif(count(),0), 2) as pct_null_id_student,
        round(100.0 * countIf(date_registration is null) / nullif(count(),0), 2) as pct_null_date_registration,
        round(100.0 * countIf(date_unregistration is null) / nullif(count(),0), 2) as pct_null_date_unregistration
    from cln
),

domains as (
    select
        countIf(code_module not in ('AAA','BBB','CCC','DDD','EEE','FFF','GGG')) as invalid_code_module,
        countIf(code_presentation not in ('2013B','2013J','2014B','2014J')) as invalid_code_presentation
    from cln
),

joined as (
    select
        counts.row_count_raw,
        counts.row_count_clean,
        (counts.row_count_raw - counts.row_count_clean) as dropped_rows,
        nulls.pct_null_code_module,
        nulls.pct_null_code_presentation,
        nulls.pct_null_id_student,
        nulls.pct_null_date_registration,
        nulls.pct_null_date_unregistration,
        domains.invalid_code_module,
        domains.invalid_code_presentation
    from counts
    cross join nulls
    cross join domains
)

select * from joined;
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m15:39:39.800123 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_dq_oulad_student_registration_anomalies: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_dq_oulad_student_registration_anomalies"} */


  create view `mart`.`grp5_dq_oulad_student_registration_anomalies__dbt_tmp` 
  
    
    
  as (
    

-- Row-level drilldown of "obviously wrong" records based on simple rules.
-- LIMIT for demo-friendliness; remove in real pipelines.

with cln as (
  select * from `clean`.`grp5_stg_oulad_student_registration`
),
violations as (
  select
    -- NOTE: this dataset has no native PK; include a synthetic row_number if needed.
    -- ClickHouse: use monotonicallyIncreasingId() isn't stable; we'll show columns directly.
    code_module, code_presentation, id_student, date_registration, date_unregistration,

    multiIf(
      code_module not in ('AAA','BBB','CCC','DDD','EEE','FFF','GGG'),  'invalid_code_module',
      code_presentation not in ('2013B', '2013J', '2014B', '2014J'), 'invalid_code_presentation',
      'ok'
    ) as dq_issue
  from cln
)
select *
from violations
where dq_issue != 'ok'
limit 50
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m15:39:40.156977 [debug] [Thread-4  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_dq_oulad_student_registration_summary"} */


  create view `mart`.`grp5_dq_oulad_student_registration_summary__dbt_tmp` 
  
    
    
  as (
    

-- Inputs:
--   raw table:   raw.grp5_oulad___student_registration
--   clean table: clean.grp5_stg_oulad_student_registration

with src as (
    select *
    from `raw`.`grp5_oulad___student_registration`
),

cln as (
    select *
    from `clean`.`grp5_stg_oulad_student_registration`
),

counts as (
    select
        (select count() from src) as row_count_raw,
        (select count() from cln) as row_count_clean
),

nulls as (
    select
        round(100.0 * countIf(code_module is null) / nullif(count(),0), 2) as pct_null_code_module,
        round(100.0 * countIf(code_presentation is null) / nullif(count(),0), 2) as pct_null_code_presentation,
        round(100.0 * countIf(id_student is null) / nullif(count(),0), 2) as pct_null_id_student,
        round(100.0 * countIf(date_registration is null) / nullif(count(),0), 2) as pct_null_date_registration,
        round(100.0 * countIf(date_unregistration is null) / nullif(count(),0), 2) as pct_null_date_unregistration
    from cln
),

domains as (
    select
        countIf(code_module not in ('AAA','BBB','CCC','DDD','EEE','FFF','GGG')) as invalid_code_module,
        countIf(code_presentation not in ('2013B','2013J','2014B','2014J')) as invalid_code_presentation
    from cln
),

joined as (
    select
        counts.row_count_raw,
        counts.row_count_clean,
        (counts.row_count_raw - counts.row_count_clean) as dropped_rows,
        nulls.pct_null_code_module,
        nulls.pct_null_code_presentation,
        nulls.pct_null_id_student,
        nulls.pct_null_date_registration,
        nulls.pct_null_date_unregistration,
        domains.invalid_code_module,
        domains.invalid_code_presentation
    from counts
    cross join nulls
    cross join domains
)

select * from joined;
    
  )
      
      
                    -- end_of_sql
                    
                    
[0m15:39:40.161992 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.36 seconds
[0m15:39:40.165507 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.40 seconds
[0m15:39:40.180083 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.41 seconds
[0m15:39:40.216926 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_dq_oulad_student_registration_anomalies: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_dq_oulad_student_registration_anomalies"} */

    drop table if exists `mart`.`grp5_dq_oulad_student_registration_anomalies__dbt_backup` 
  
  ...
[0m15:39:40.228414 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies"} */

    drop table if exists `mart`.`grp5_dq_oulad_studentVle_anomalies__dbt_backup` 
  
  ...
[0m15:39:40.235942 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_dq_oulad_studenVle_summary: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_dq_oulad_studenVle_summary"} */

    drop table if exists `mart`.`grp5_dq_oulad_studenVle_summary__dbt_backup` 
  
  ...
[0m15:39:40.260633 [debug] [Thread-4  ]: Database Error in model grp5_dq_oulad_student_registration_summary (models/mart/dq/grp5_dq_oulad_student_registration_summary.sql)
  HTTPDriver for http://54.87.106.52:8123 received ClickHouse error code 62
   Code: 62. DB::Exception: Syntax error: failed at position 2052 (end of query) (line 65, col 21): ;
      
    )
        
        
                      -- end_of_sql
                      
                      . Expected one of: token, Dot, OpeningRoundBracket, UUID, alias, AS, identifier, FINAL, SAMPLE, table, table function, subquery or list of joined tables, array join, LEFT ARRAY JOIN, INNER, ARRAY JOIN, JOIN, PREWHERE, WHERE, GROUP BY, WITH, HAVING, WINDOW, ORDER BY, LIMIT, OFFSET, FETCH, SETTINGS, UNION, EXCEPT, INTERSECT. (SYNTAX_ERROR) (version 23.12.6.19 (official build))
  compiled code at target/run/ex_09_oulad/models/mart/dq/grp5_dq_oulad_student_registration_summary.sql
[0m15:39:40.264965 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49ee5824-c2c7-4cba-80cc-a39a880fb754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73420edcbb20>]}
[0m15:39:40.267660 [error] [Thread-4  ]: 4 of 9 ERROR creating sql view model `mart`.`grp5_dq_oulad_student_registration_summary`  [[31mERROR[0m in 2.89s]
[0m15:39:40.273753 [debug] [Thread-4  ]: Finished running node model.ex_09_oulad.grp5_dq_oulad_student_registration_summary
[0m15:39:40.276882 [debug] [Thread-4  ]: Began running node model.ex_09_oulad.grp5_oulad_dim_courses
[0m15:39:40.280811 [info ] [Thread-4  ]: 5 of 9 START sql table model `mart`.`grp5_oulad_dim_courses` ................... [RUN]
[0m15:39:40.284168 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.ex_09_oulad.grp5_dq_oulad_student_registration_summary, now model.ex_09_oulad.grp5_oulad_dim_courses)
[0m15:39:40.286810 [debug] [Thread-4  ]: Began compiling node model.ex_09_oulad.grp5_oulad_dim_courses
[0m15:39:40.305732 [debug] [Thread-4  ]: Writing injected SQL for node "model.ex_09_oulad.grp5_oulad_dim_courses"
[0m15:39:40.308693 [debug] [Thread-4  ]: Began executing node model.ex_09_oulad.grp5_oulad_dim_courses
[0m15:39:40.569489 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_courses: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_courses"} */

            

    
        create table `mart`.`grp5_oulad_dim_courses__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

select
    concat(cast(code_module as Nullable(String)), cast(code_presentation as Nullable(String))) 
        as id_course,
    cast(code_module as Nullable(String))                           as code_module,
    cast(code_presentation as Nullable(String))                     as code_presentation,
    cast(module_presentation_length as Nullable(Int32))             as module_presentation_length
from `clean`.`grp5_stg_oulad_courses`
          )
        
        ...
[0m15:39:40.601054 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.36 seconds
[0m15:39:40.606158 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_dq_oulad_student_registration_anomalies: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_dq_oulad_student_registration_anomalies"} */

    rename table `mart`.`grp5_dq_oulad_student_registration_anomalies` to `mart`.`grp5_dq_oulad_student_registration_anomalies__dbt_backup` 
  
  ...
[0m15:39:40.609034 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.36 seconds
[0m15:39:40.618294 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies"} */

    rename table `mart`.`grp5_dq_oulad_studentVle_anomalies` to `mart`.`grp5_dq_oulad_studentVle_anomalies__dbt_backup` 
  
  ...
[0m15:39:40.751294 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.50 seconds
[0m15:39:40.755949 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_dq_oulad_studenVle_summary: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_dq_oulad_studenVle_summary"} */

    rename table `mart`.`grp5_dq_oulad_studenVle_summary` to `mart`.`grp5_dq_oulad_studenVle_summary__dbt_backup` 
  
  ...
[0m15:39:40.937582 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.37 seconds
[0m15:39:40.947153 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.34 seconds
[0m15:39:40.979751 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_dq_oulad_student_registration_anomalies: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_dq_oulad_student_registration_anomalies"} */

    drop table if exists `mart`.`grp5_dq_oulad_student_registration_anomalies` 
  
  ...
[0m15:39:40.988547 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_courses: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_courses"} */

    select name, type from system.columns where table = 'grp5_oulad_dim_courses__dbt_backup'
    
      and database = 'mart'
    
    order by position
  ...
[0m15:39:41.130547 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.51 seconds
[0m15:39:41.134285 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.38 seconds
[0m15:39:41.144438 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies"} */

    drop table if exists `mart`.`grp5_dq_oulad_studentVle_anomalies` 
  
  ...
[0m15:39:41.156730 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_dq_oulad_studenVle_summary: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_dq_oulad_studenVle_summary"} */

    drop table if exists `mart`.`grp5_dq_oulad_studenVle_summary` 
  
  ...
[0m15:39:41.375285 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.38 seconds
[0m15:39:41.379120 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.39 seconds
[0m15:39:41.384774 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_dq_oulad_student_registration_anomalies: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_dq_oulad_student_registration_anomalies"} */

    rename table `mart`.`grp5_dq_oulad_student_registration_anomalies__dbt_tmp` to `mart`.`grp5_dq_oulad_student_registration_anomalies` 
  
  ...
[0m15:39:41.407457 [debug] [Thread-4  ]: Writing runtime sql for node "model.ex_09_oulad.grp5_oulad_dim_courses"
[0m15:39:41.412410 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_courses: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_courses"} */

  
    
    
    
        
         


        insert into `mart`.`grp5_oulad_dim_courses__dbt_backup`
        ("id_course", "code_module", "code_presentation", "module_presentation_length")

select
    concat(cast(code_module as Nullable(String)), cast(code_presentation as Nullable(String))) 
        as id_course,
    cast(code_module as Nullable(String))                           as code_module,
    cast(code_presentation as Nullable(String))                     as code_presentation,
    cast(module_presentation_length as Nullable(Int32))             as module_presentation_length
from `clean`.`grp5_stg_oulad_courses`
  ...
[0m15:39:41.596448 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.44 seconds
[0m15:39:41.606851 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies"} */

    rename table `mart`.`grp5_dq_oulad_studentVle_anomalies__dbt_tmp` to `mart`.`grp5_dq_oulad_studentVle_anomalies` 
  
  ...
[0m15:39:41.620773 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.46 seconds
[0m15:39:41.626727 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_dq_oulad_studenVle_summary: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_dq_oulad_studenVle_summary"} */

    rename table `mart`.`grp5_dq_oulad_studenVle_summary__dbt_tmp` to `mart`.`grp5_dq_oulad_studenVle_summary` 
  
  ...
[0m15:39:41.813684 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.40 seconds
[0m15:39:41.829880 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.42 seconds
[0m15:39:41.860430 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_courses: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_courses"} */
EXCHANGE TABLES `mart`.`grp5_oulad_dim_courses__dbt_backup` AND `mart`.`grp5_oulad_dim_courses` 
  
  ...
[0m15:39:41.969640 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_dq_oulad_student_registration_anomalies: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_dq_oulad_student_registration_anomalies"} */

    drop table if exists `mart`.`grp5_dq_oulad_student_registration_anomalies__dbt_backup` 
  ...
[0m15:39:42.053399 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.44 seconds
[0m15:39:42.056340 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.43 seconds
[0m15:39:42.071438 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies"} */

    drop table if exists `mart`.`grp5_dq_oulad_studentVle_anomalies__dbt_backup` 
  ...
[0m15:39:42.091829 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_dq_oulad_studenVle_summary: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_dq_oulad_studenVle_summary"} */

    drop table if exists `mart`.`grp5_dq_oulad_studenVle_summary__dbt_backup` 
  ...
[0m15:39:42.278184 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.41 seconds
[0m15:39:42.281893 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.31 seconds
[0m15:39:42.302339 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_courses: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_courses"} */

    drop table if exists `mart`.`grp5_oulad_dim_courses__dbt_backup` 
  ...
[0m15:39:42.318726 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49ee5824-c2c7-4cba-80cc-a39a880fb754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73420e86f4c0>]}
[0m15:39:42.323208 [info ] [Thread-3  ]: 3 of 9 OK created sql view model `mart`.`grp5_dq_oulad_student_registration_anomalies`  [[32mOK[0m in 4.95s]
[0m15:39:42.328941 [debug] [Thread-3  ]: Finished running node model.ex_09_oulad.grp5_dq_oulad_student_registration_anomalies
[0m15:39:42.333054 [debug] [Thread-3  ]: Began running node model.ex_09_oulad.grp5_oulad_dim_module_presentation
[0m15:39:42.337907 [info ] [Thread-3  ]: 6 of 9 START sql table model `sandbox`.`grp5_oulad_dim_module_presentation` .... [RUN]
[0m15:39:42.342878 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ex_09_oulad.grp5_dq_oulad_student_registration_anomalies, now model.ex_09_oulad.grp5_oulad_dim_module_presentation)
[0m15:39:42.347686 [debug] [Thread-3  ]: Began compiling node model.ex_09_oulad.grp5_oulad_dim_module_presentation
[0m15:39:42.370319 [debug] [Thread-3  ]: Writing injected SQL for node "model.ex_09_oulad.grp5_oulad_dim_module_presentation"
[0m15:39:42.373268 [debug] [Thread-3  ]: Began executing node model.ex_09_oulad.grp5_oulad_dim_module_presentation
[0m15:39:42.391457 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_module_presentation: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_module_presentation"} */

            

    
        create table `sandbox`.`grp5_oulad_dim_module_presentation__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Dimension table for module + presentation (simple, with Nullable types)
select
    cast(code_module as Nullable(String))                           as code_module,
    cast(code_presentation as Nullable(String))                     as code_presentation,
    cast(module_presentation_length as Nullable(Int32))             as length_days
from `clean`.`grp5_stg_oulad_courses`
          )
        
        ...
[0m15:39:42.518328 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.43 seconds
[0m15:39:42.524102 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49ee5824-c2c7-4cba-80cc-a39a880fb754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734210707820>]}
[0m15:39:42.527300 [info ] [Thread-2  ]: 2 of 9 OK created sql view model `mart`.`grp5_dq_oulad_studentVle_anomalies` ... [[32mOK[0m in 5.18s]
[0m15:39:42.532061 [debug] [Thread-2  ]: Finished running node model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies
[0m15:39:42.534610 [debug] [Thread-2  ]: Began running node model.ex_09_oulad.grp5_oulad_dim_student
[0m15:39:42.537934 [info ] [Thread-2  ]: 7 of 9 START sql table model `sandbox`.`grp5_oulad_dim_student` ................ [RUN]
[0m15:39:42.540923 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ex_09_oulad.grp5_dq_oulad_studentVle_anomalies, now model.ex_09_oulad.grp5_oulad_dim_student)
[0m15:39:42.543528 [debug] [Thread-2  ]: Began compiling node model.ex_09_oulad.grp5_oulad_dim_student
[0m15:39:42.560148 [debug] [Thread-2  ]: Writing injected SQL for node "model.ex_09_oulad.grp5_oulad_dim_student"
[0m15:39:42.563428 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.47 seconds
[0m15:39:42.570398 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49ee5824-c2c7-4cba-80cc-a39a880fb754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73420e4951f0>]}
[0m15:39:42.573141 [info ] [Thread-1  ]: 1 of 9 OK created sql view model `mart`.`grp5_dq_oulad_studenVle_summary` ...... [[32mOK[0m in 5.25s]
[0m15:39:42.575441 [debug] [Thread-2  ]: Began executing node model.ex_09_oulad.grp5_oulad_dim_student
[0m15:39:42.578087 [debug] [Thread-1  ]: Finished running node model.ex_09_oulad.grp5_dq_oulad_studenVle_summary
[0m15:39:42.592175 [debug] [Thread-1  ]: Began running node model.ex_09_oulad.grp5_stg_oulad_student_assessment
[0m15:39:42.600650 [info ] [Thread-1  ]: 8 of 9 START sql table model `clean`.`grp5_stg_oulad_student_assessment` ....... [RUN]
[0m15:39:42.605477 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_student: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_student"} */

            

    
        create table `sandbox`.`grp5_oulad_dim_student__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Dimension table for students (no surrogate key)
select
    cast(id_student as Int64)               as id_student,
    cast(gender as Nullable(String))        as gender,
    cast(age_band as Nullable(String))      as age_band,
    cast(region as Nullable(String))        as region,
    cast(highest_education as Nullable(String)) as highest_education,
    cast(imd_band as Nullable(String))      as imd_band,
    cast(disability as Nullable(String))    as disability
from `clean`.`grp5_stg_oulad_student_info`
          )
        
        ...
[0m15:39:42.608342 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ex_09_oulad.grp5_dq_oulad_studenVle_summary, now model.ex_09_oulad.grp5_stg_oulad_student_assessment)
[0m15:39:42.615830 [debug] [Thread-1  ]: Began compiling node model.ex_09_oulad.grp5_stg_oulad_student_assessment
[0m15:39:42.631757 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_09_oulad.grp5_stg_oulad_student_assessment"
[0m15:39:42.634315 [debug] [Thread-1  ]: Began executing node model.ex_09_oulad.grp5_stg_oulad_student_assessment
[0m15:39:42.649009 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_assessment"} */

            

    
        create table `clean`.`grp5_stg_oulad_student_assessment__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
             

-- Standardize names and types for student assessment
select
  cast(id_assessment  as Nullable(Int64)) as assessment_id,
  cast(id_student     as Nullable(Int64)) as student_id,
  cast(date_submitted as Nullable(Int64)) as date_submitted,
  cast(is_banked      as Nullable(Int64)) as is_banked,
  cast(score          as Nullable(Int64)) as score
from `raw`.`grp5_oulad___student_assessment`
          )
        
        ...
[0m15:39:42.801209 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.48 seconds
[0m15:39:42.804018 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.41 seconds
[0m15:39:42.810453 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49ee5824-c2c7-4cba-80cc-a39a880fb754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734210ebc610>]}
[0m15:39:42.830285 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_module_presentation: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_module_presentation"} */

    select name, type from system.columns where table = 'grp5_oulad_dim_module_presentation__dbt_backup'
    
      and database = 'sandbox'
    
    order by position
  ...
[0m15:39:42.826651 [info ] [Thread-4  ]: 5 of 9 OK created sql table model `mart`.`grp5_oulad_dim_courses` .............. [[32mOK[0m in 2.53s]
[0m15:39:42.836660 [debug] [Thread-4  ]: Finished running node model.ex_09_oulad.grp5_oulad_dim_courses
[0m15:39:42.843007 [debug] [Thread-4  ]: Began running node model.ex_09_oulad.grp5_stg_oulad_student_info
[0m15:39:42.846250 [info ] [Thread-4  ]: 9 of 9 START sql table model `clean`.`grp5_stg_oulad_student_info` ............. [RUN]
[0m15:39:42.848418 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.ex_09_oulad.grp5_oulad_dim_courses, now model.ex_09_oulad.grp5_stg_oulad_student_info)
[0m15:39:42.850243 [debug] [Thread-4  ]: Began compiling node model.ex_09_oulad.grp5_stg_oulad_student_info
[0m15:39:42.866480 [debug] [Thread-4  ]: Writing injected SQL for node "model.ex_09_oulad.grp5_stg_oulad_student_info"
[0m15:39:42.868976 [debug] [Thread-4  ]: Began executing node model.ex_09_oulad.grp5_stg_oulad_student_info
[0m15:39:42.884423 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_info: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_info"} */

            

    
        create table `clean`.`grp5_stg_oulad_student_info__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            
select
  cast(code_module            as String)     as code_module,
  cast(code_presentation      as String)     as code_presentation,
  cast(id_student             as Int64)      as id_student,
  cast(
    case
      when gender IN ('M', 'F') then gender
      else 'Unknown'
    end as String) as gender,
  cast(region                 as String)     as region,
  cast(highest_education      as String)     as highest_education,
  cast(
    case
        when imd_band = '?' then null
        when imd_band not like '%\%%' then concat(imd_band, '%')
        else imd_band
    end as Nullable(String)) as imd_band,
  cast(age_band               as String)     as age_band,
  cast(num_of_prev_attempts   as Int64)      as num_of_prev_attempts,
  cast(studied_credits        as Int64)      as studied_credits,
  cast(disability             as String)     as disability,
  cast(final_result           as String)     as final_result
from `raw`.`grp5_oulad___student_info`
          )
        
        ...
[0m15:39:43.026719 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.42 seconds
[0m15:39:43.031605 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.38 seconds
[0m15:39:43.052818 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_student: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_student"} */

    select name, type from system.columns where table = 'grp5_oulad_dim_student__dbt_backup'
    
      and database = 'sandbox'
    
    order by position
  ...
[0m15:39:43.059240 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_assessment"} */

    select name, type from system.columns where table = 'grp5_stg_oulad_student_assessment__dbt_backup'
    
      and database = 'clean'
    
    order by position
  ...
[0m15:39:43.289704 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.46 seconds
[0m15:39:43.298938 [debug] [Thread-3  ]: Writing runtime sql for node "model.ex_09_oulad.grp5_oulad_dim_module_presentation"
[0m15:39:43.303224 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.42 seconds
[0m15:39:43.323463 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_info: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_info"} */

    select name, type from system.columns where table = 'grp5_stg_oulad_student_info__dbt_backup'
    
      and database = 'clean'
    
    order by position
  ...
[0m15:39:43.327449 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_module_presentation: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_module_presentation"} */

  
    
    
    
        
         


        insert into `sandbox`.`grp5_oulad_dim_module_presentation__dbt_backup`
        ("code_module", "code_presentation", "length_days")

-- Dimension table for module + presentation (simple, with Nullable types)
select
    cast(code_module as Nullable(String))                           as code_module,
    cast(code_presentation as Nullable(String))                     as code_presentation,
    cast(module_presentation_length as Nullable(Int32))             as length_days
from `clean`.`grp5_stg_oulad_courses`
  ...
[0m15:39:43.416616 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.35 seconds
[0m15:39:43.428593 [debug] [Thread-2  ]: Writing runtime sql for node "model.ex_09_oulad.grp5_oulad_dim_student"
[0m15:39:43.432325 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_student: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_student"} */

  
    
    
    
        
         


        insert into `sandbox`.`grp5_oulad_dim_student__dbt_backup`
        ("id_student", "gender", "age_band", "region", "highest_education", "imd_band", "disability")

-- Dimension table for students (no surrogate key)
select
    cast(id_student as Int64)               as id_student,
    cast(gender as Nullable(String))        as gender,
    cast(age_band as Nullable(String))      as age_band,
    cast(region as Nullable(String))        as region,
    cast(highest_education as Nullable(String)) as highest_education,
    cast(imd_band as Nullable(String))      as imd_band,
    cast(disability as Nullable(String))    as disability
from `clean`.`grp5_stg_oulad_student_info`
  ...
[0m15:39:43.542434 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.48 seconds
[0m15:39:43.563077 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_09_oulad.grp5_stg_oulad_student_assessment"
[0m15:39:43.568898 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_assessment"} */

  
    
    
    
        
         


        insert into `clean`.`grp5_stg_oulad_student_assessment__dbt_backup`
        ("assessment_id", "student_id", "date_submitted", "is_banked", "score") 

-- Standardize names and types for student assessment
select
  cast(id_assessment  as Nullable(Int64)) as assessment_id,
  cast(id_student     as Nullable(Int64)) as student_id,
  cast(date_submitted as Nullable(Int64)) as date_submitted,
  cast(is_banked      as Nullable(Int64)) as is_banked,
  cast(score          as Nullable(Int64)) as score
from `raw`.`grp5_oulad___student_assessment`
  ...
[0m15:39:43.922098 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.59 seconds
[0m15:39:43.925813 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.49 seconds
[0m15:39:43.929266 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.59 seconds
[0m15:39:43.936691 [debug] [Thread-4  ]: Writing runtime sql for node "model.ex_09_oulad.grp5_stg_oulad_student_info"
[0m15:39:43.942937 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_student: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_student"} */
EXCHANGE TABLES `sandbox`.`grp5_oulad_dim_student__dbt_backup` AND `sandbox`.`grp5_oulad_dim_student` 
  
  ...
[0m15:39:43.947663 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_module_presentation: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_module_presentation"} */
EXCHANGE TABLES `sandbox`.`grp5_oulad_dim_module_presentation__dbt_backup` AND `sandbox`.`grp5_oulad_dim_module_presentation` 
  
  ...
[0m15:39:43.959129 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_info: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_info"} */

  
    
    
    
        
         


        insert into `clean`.`grp5_stg_oulad_student_info__dbt_backup`
        ("code_module", "code_presentation", "id_student", "gender", "region", "highest_education", "imd_band", "age_band", "num_of_prev_attempts", "studied_credits", "disability", "final_result")
select
  cast(code_module            as String)     as code_module,
  cast(code_presentation      as String)     as code_presentation,
  cast(id_student             as Int64)      as id_student,
  cast(
    case
      when gender IN ('M', 'F') then gender
      else 'Unknown'
    end as String) as gender,
  cast(region                 as String)     as region,
  cast(highest_education      as String)     as highest_education,
  cast(
    case
        when imd_band = '?' then null
        when imd_band not like '%\%%' then concat(imd_band, '%')
        else imd_band
    end as Nullable(String)) as imd_band,
  cast(age_band               as String)     as age_band,
  cast(num_of_prev_attempts   as Int64)      as num_of_prev_attempts,
  cast(studied_credits        as Int64)      as studied_credits,
  cast(disability             as String)     as disability,
  cast(final_result           as String)     as final_result
from `raw`.`grp5_oulad___student_info`
  ...
[0m15:39:44.148427 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.58 seconds
[0m15:39:44.157429 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_assessment"} */
EXCHANGE TABLES `clean`.`grp5_stg_oulad_student_assessment__dbt_backup` AND `clean`.`grp5_stg_oulad_student_assessment` 
  
  ...
[0m15:39:44.321882 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.37 seconds
[0m15:39:44.325409 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.37 seconds
[0m15:39:44.362118 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_student: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_student"} */

    drop table if exists `sandbox`.`grp5_oulad_dim_student__dbt_backup` 
  ...
[0m15:39:44.381191 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_oulad_dim_module_presentation: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_oulad_dim_module_presentation"} */

    drop table if exists `sandbox`.`grp5_oulad_dim_module_presentation__dbt_backup` 
  ...
[0m15:39:44.401867 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.44 seconds
[0m15:39:44.408643 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_info: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_info"} */
EXCHANGE TABLES `clean`.`grp5_stg_oulad_student_info__dbt_backup` AND `clean`.`grp5_stg_oulad_student_info` 
  
  ...
[0m15:39:44.669268 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.50 seconds
[0m15:39:44.700861 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_assessment"} */

    drop table if exists `clean`.`grp5_stg_oulad_student_assessment__dbt_backup` 
  ...
[0m15:39:44.818885 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.45 seconds
[0m15:39:44.824497 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.44 seconds
[0m15:39:44.831013 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49ee5824-c2c7-4cba-80cc-a39a880fb754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734210707820>]}
[0m15:39:44.843032 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.43 seconds
[0m15:39:44.849763 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49ee5824-c2c7-4cba-80cc-a39a880fb754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73420e89acd0>]}
[0m15:39:44.852873 [info ] [Thread-2  ]: 7 of 9 OK created sql table model `sandbox`.`grp5_oulad_dim_student` ........... [[32mOK[0m in 2.29s]
[0m15:39:44.868488 [info ] [Thread-3  ]: 6 of 9 OK created sql table model `sandbox`.`grp5_oulad_dim_module_presentation`  [[32mOK[0m in 2.51s]
[0m15:39:44.876889 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_09_oulad.grp5_stg_oulad_student_info: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_09_oulad.grp5_stg_oulad_student_info"} */

    drop table if exists `clean`.`grp5_stg_oulad_student_info__dbt_backup` 
  ...
[0m15:39:44.880116 [debug] [Thread-2  ]: Finished running node model.ex_09_oulad.grp5_oulad_dim_student
[0m15:39:44.885893 [debug] [Thread-3  ]: Finished running node model.ex_09_oulad.grp5_oulad_dim_module_presentation
[0m15:39:45.103628 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.40 seconds
[0m15:39:45.116520 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49ee5824-c2c7-4cba-80cc-a39a880fb754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73420ef98fa0>]}
[0m15:39:45.120895 [info ] [Thread-1  ]: 8 of 9 OK created sql table model `clean`.`grp5_stg_oulad_student_assessment` .. [[32mOK[0m in 2.51s]
[0m15:39:45.128081 [debug] [Thread-1  ]: Finished running node model.ex_09_oulad.grp5_stg_oulad_student_assessment
[0m15:39:45.413606 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.52 seconds
[0m15:39:45.423714 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49ee5824-c2c7-4cba-80cc-a39a880fb754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73420e33ad00>]}
[0m15:39:45.426852 [info ] [Thread-4  ]: 9 of 9 OK created sql table model `clean`.`grp5_stg_oulad_student_info` ........ [[32mOK[0m in 2.58s]
[0m15:39:45.432200 [debug] [Thread-4  ]: Finished running node model.ex_09_oulad.grp5_stg_oulad_student_info
[0m15:39:45.441416 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:39:45.443384 [debug] [MainThread]: Connection 'list__sandbox' was left open.
[0m15:39:45.446994 [debug] [MainThread]: On list__sandbox: Close
[0m15:39:45.448671 [debug] [MainThread]: Connection 'list__mart' was left open.
[0m15:39:45.450015 [debug] [MainThread]: On list__mart: Close
[0m15:39:45.451499 [debug] [MainThread]: Connection 'list_' was left open.
[0m15:39:45.453140 [debug] [MainThread]: On list_: Close
[0m15:39:45.454378 [debug] [MainThread]: Connection 'list__clean' was left open.
[0m15:39:45.455632 [debug] [MainThread]: On list__clean: Close
[0m15:39:45.458281 [debug] [MainThread]: Connection 'model.ex_09_oulad.grp5_stg_oulad_student_assessment' was left open.
[0m15:39:45.459670 [debug] [MainThread]: On model.ex_09_oulad.grp5_stg_oulad_student_assessment: Close
[0m15:39:45.461067 [debug] [MainThread]: Connection 'model.ex_09_oulad.grp5_oulad_dim_student' was left open.
[0m15:39:45.462382 [debug] [MainThread]: On model.ex_09_oulad.grp5_oulad_dim_student: Close
[0m15:39:45.463856 [debug] [MainThread]: Connection 'model.ex_09_oulad.grp5_oulad_dim_module_presentation' was left open.
[0m15:39:45.465769 [debug] [MainThread]: On model.ex_09_oulad.grp5_oulad_dim_module_presentation: Close
[0m15:39:45.467511 [debug] [MainThread]: Connection 'model.ex_09_oulad.grp5_stg_oulad_student_info' was left open.
[0m15:39:45.468887 [debug] [MainThread]: On model.ex_09_oulad.grp5_stg_oulad_student_info: Close
[0m15:39:45.473064 [info ] [MainThread]: 
[0m15:39:45.474662 [info ] [MainThread]: Finished running 4 view models, 5 table models in 0 hours 0 minutes and 19.32 seconds (19.32s).
[0m15:39:45.486745 [debug] [MainThread]: Command end result
[0m15:39:45.594915 [info ] [MainThread]: 
[0m15:39:45.596377 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:39:45.597840 [info ] [MainThread]: 
[0m15:39:45.600178 [error] [MainThread]:   Database Error in model grp5_dq_oulad_student_registration_summary (models/mart/dq/grp5_dq_oulad_student_registration_summary.sql)
  HTTPDriver for http://54.87.106.52:8123 received ClickHouse error code 62
   Code: 62. DB::Exception: Syntax error: failed at position 2052 (end of query) (line 65, col 21): ;
      
    )
        
        
                      -- end_of_sql
                      
                      . Expected one of: token, Dot, OpeningRoundBracket, UUID, alias, AS, identifier, FINAL, SAMPLE, table, table function, subquery or list of joined tables, array join, LEFT ARRAY JOIN, INNER, ARRAY JOIN, JOIN, PREWHERE, WHERE, GROUP BY, WITH, HAVING, WINDOW, ORDER BY, LIMIT, OFFSET, FETCH, SETTINGS, UNION, EXCEPT, INTERSECT. (SYNTAX_ERROR) (version 23.12.6.19 (official build))
  compiled code at target/run/ex_09_oulad/models/mart/dq/grp5_dq_oulad_student_registration_summary.sql
[0m15:39:45.601801 [info ] [MainThread]: 
[0m15:39:45.603542 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m15:39:45.613827 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 28.662546, "process_in_blocks": "2560", "process_kernel_time": 3.351634, "process_mem_max_rss": "119280", "process_out_blocks": "11000", "process_user_time": 14.287963}
[0m15:39:45.616695 [debug] [MainThread]: Command `dbt build` failed at 15:39:45.615731 after 28.67 seconds
[0m15:39:45.618802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734214312e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73420daf9370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73420daf95b0>]}
[0m15:39:45.621344 [debug] [MainThread]: Flushing usage events
